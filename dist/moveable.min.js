/*
Copyright (c) 2019 Daybrush
name: moveable
license: MIT
author: Daybrush
repository: git+https://github.com/daybrush/moveable.git
version: 0.14.0
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Moveable=e()}(this,function(){"use strict";var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function i(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var s=function(){return(s=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function u(t){return void 0===t}var t=function(){var t=function(){function t(){this._eventHandler={},this.options={}}var e=t.prototype;return e.trigger=function(t,e){void 0===e&&(e={});var r=this._eventHandler[t]||[];if(!(0<r.length))return!0;r=r.concat(),e.eventType=t;var n=!1,i=[e],a=0;e.stop=function(){n=!0},e.currentTarget=this;for(var o=arguments.length,s=new Array(2<o?o-2:0),u=2;u<o;u++)s[u-2]=arguments[u];for(1<=s.length&&(i=i.concat(s)),a=0;r[a];a++)r[a].apply(this,i);return!n},e.once=function(i,a){if("object"==typeof i&&u(a)){var t,e=i;for(t in e)this.once(t,e[t]);return this}if("string"==typeof i&&"function"==typeof a){var o=this;this.on(i,function t(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];a.apply(o,r),o.off(i,t)})}return this},e.hasOn=function(t){return!!this._eventHandler[t]},e.on=function(t,e){if("object"==typeof t&&u(e)){var r,n=t;for(r in n)this.on(r,n[r]);return this}if("string"==typeof t&&"function"==typeof e){var i=this._eventHandler[t];u(i)&&(this._eventHandler[t]=[],i=this._eventHandler[t]),i.push(e)}return this},e.off=function(t,e){if(u(t))return this._eventHandler={},this;if(u(e)){if("string"==typeof t)return this._eventHandler[t]=void 0,this;var r,n=t;for(r in n)this.off(r,n[r]);return this}var i,a,o=this._eventHandler[t];if(o)for(i=0;void 0!==(a=o[i]);i++)if(a===e){o=o.splice(i,1);break}return this},t}();return t.VERSION="2.1.2",t}();function c(e,r){return function(t){t&&(e[r]=t)}}function r(r,n){return function(t){var e=t.prototype;r.forEach(function(t){n(e,t)})}}var b=function(){function t(){this.keys=[],this.values=[]}var e=t.prototype;return e.get=function(t){return this.values[this.keys.indexOf(t)]},e.set=function(t,e){var r=this.keys,n=this.values,i=r.indexOf(t),a=-1===i?r.length:i;r[a]=t,n[a]=e},t}(),y=function(){function t(){this.object={}}var e=t.prototype;return e.get=function(t){return this.object[t]},e.set=function(t,e){this.object[t]=e},t}(),E="function"==typeof Map,a=function(){function t(){}var e=t.prototype;return e.connect=function(t,e){this.prev=t,this.next=e,t&&(t.next=this),e&&(e.prev=this)},e.disconnect=function(){var t=this.prev,e=this.next;t&&(t.next=e),e&&(e.prev=t)},e.getIndex=function(){for(var t=this,e=-1;t;)t=t.prev,++e;return e},t}();var x=function(){function t(t,e,r,n,i,a,o,s){this.prevList=t,this.list=e,this.added=r,this.removed=n,this.changed=i,this.maintained=a,this.changedBeforeAdded=o,this.fixed=s}var e=t.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var t=function(t,r){var s=[],u=[];return t.forEach(function(t){var e=t[0],r=t[1],n=new a;s[e]=n,u[r]=n}),s.forEach(function(t,e){t.connect(s[e-1])}),t.filter(function(t,e){return!r[e]}).map(function(t,e){var r=t[0],n=t[1];if(r===n)return[0,0];var i=s[r],a=u[n-1],o=i.getIndex();return i.disconnect(),a?i.connect(a,a.next):i.connect(void 0,s[0]),[o,i.getIndex()]})}(this.changedBeforeAdded,this.fixed),s=this.changed,u=[];this.cacheOrdered=t.filter(function(t,e){var r=t[0],n=t[1],i=s[e],a=i[0],o=i[1];if(r!==n)return u.push([a,o]),!0}),this.cachePureChanged=u},t}();function l(t,e,r){var n=E?Map:r?y:b,i=r||function(t){return t},a=[],o=[],s=[],u=t.map(i),c=e.map(i),l=new n,f=new n,p=[],h=[],d={},v=[],g=0,m=0;return u.forEach(function(t,e){l.set(t,e)}),c.forEach(function(t,e){f.set(t,e)}),u.forEach(function(t,e){var r=f.get(t);void 0===r?(++m,o.push(e)):d[r]=m}),c.forEach(function(t,e){var r=l.get(t);void 0===r?(a.push(e),++g):(s.push([r,e]),m=d[e]||0,p.push([r-m,e-g]),h.push(e===r),r!==e&&v.push([r,e]))}),o.reverse(),new x(t,e,a,o,v,s,p,h)}var e=function(){function t(t,e){void 0===t&&(t=[]),this.findKeyCallback=e,this.list=[].slice.call(t)}return t.prototype.update=function(t){var e=[].slice.call(t),r=l(this.list,e,this.findKeyCallback);return this.list=e,r},t}(),f="function",o="object",p="string",h="undefined";function F(t){return typeof t===h}function L(t){return t&&typeof t===o}function K(t){return Array.isArray(t)}function d(t){return typeof t===p}function w(t){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(t);if(!e)return{prefix:"",unit:"",value:NaN};var r=e[1],n=e[2];return{prefix:r,unit:e[3],value:parseFloat(n)}}function v(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function g(t,e,r,n){t.addEventListener(e,r,n)}function m(t,e,r){t.removeEventListener(e,r)}var S=function(t,e){return(S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function M(t,e){function r(){this.constructor=t}S(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var C=function(){return(C=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function D(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r}function O(t,e){if(t===e)return!1;for(var r in t)if(!(r in e))return!0;for(var r in e)if(t[r]!==e[r])return!0;return!1}function R(i,a){var o=Object.keys(i),r=Object.keys(a),t=l(o,r,function(t){return t}),n={},s={},u={};return t.added.forEach(function(t){var e=r[t];n[e]=a[e]}),t.removed.forEach(function(t){var e=o[t];s[e]=i[e]}),t.maintained.forEach(function(t){var e=t[0],r=o[e],n=[i[r],a[r]];i[r]!==a[r]&&(u[r]=n)}),{added:n,removed:s,changed:u}}function P(t){t.forEach(function(t){t()})}function _(t){var e=0;return t.map(function(t){return null==t?"$compat"+ ++e:""+t})}function z(t,e){return d(t)?new N("text_"+t,e,null,{}):new("string"==typeof t.type?k:t.type.prototype.render?j:X)(t.type,e,t.ref,t.props)}function G(t){var e=t.className,r=D(t,["className"]);return null!=e&&(r.class=e),delete r.style,delete r.children,r}function T(t,e){if(!e)return t;for(var r in e)F(t[r])&&(t[r]=e[r]);return t}function A(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=e||{},a=i.key,o=i.ref,s=D(i,["key","ref"]);return{type:t,key:a,ref:o,props:C(C({},s),{children:function e(t){var r=[];return t.forEach(function(t){r=r.concat(K(t)?e(t):t)}),r}(r).filter(function(t){return null!=t})})}}var B=function(){function t(t,e,r,n){void 0===n&&(n={}),this.type=t,this.key=e,this.ref=r,this.props=n,this._providers=[]}var e=t.prototype;return e._should=function(t,e){return!0},e._update=function(t,e,r,n){if(this.base&&!d(e)&&!n&&!this._should(e.props,r))return!1;this.original=e,this._setState(r);var i=this.props;return d(e)||(this.props=e.props,this.ref=e.ref),this._render(t,this.base?i:{},r),!0},e._mounted=function(){var t=this.ref;t&&t(this.base)},e._setState=function(t){},e._updated=function(){var t=this.ref;t&&t(this.base)},e._destroy=function(){var t=this.ref;t&&t(null)},t}();function I(t){var e={},r={};for(var n in t)0===n.indexOf("on")?r[n.replace("on","").toLowerCase()]=t[n]:e[n]=t[n];return{attributes:e,events:r}}var N=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}M(e,t);var r=e.prototype;return r._render=function(t){var e=this,r=!this.base;return r&&(this.base=document.createTextNode(this.type.replace("text_",""))),t.push(function(){r?e._mounted():e._updated()}),!0},r._unmount=function(){this.base.parentNode.removeChild(this.base)},e}(B),k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.events={},t}M(t,e);var r=t.prototype;return r.addEventListener=function(t,e){var r=this.events;r[t]=function(t){t.nativeEvent=t,e(t)},this.base.addEventListener(t,r[t])},r.removeEventListener=function(t){var e=this.events;this.base.removeEventListener(t,e[t]),delete e[t]},r._should=function(t){return O(this.props,t)},r._render=function(t,e){var r=this,n=!this.base;n&&(this.base=document.createElement(this.type)),U(this.props.children,this._providers,t,null,this.base);var i=this.base,a=I(e),o=a.attributes,s=a.events,u=I(this.props),c=u.attributes,l=u.events;return function(t,e,r){var n=R(t,e),i=n.added,a=n.removed,o=n.changed;for(var s in i)r.setAttribute(s,i[s]);for(var s in o)r.setAttribute(s,o[s][1]);for(var s in a)r.removeAttribute(s)}(G(o),G(c),i),function(t,e,r){var n=R(t,e),i=n.added,a=n.removed,o=n.changed;for(var s in a)r.removeEventListener(s);for(var s in i)r.addEventListener(s,i[s]);for(var s in o)r.removeEventListener(s),r.addEventListener(s,o[s][1]);for(var s in a)r.removeEventListener(s)}(s,l,this),function(t,e,r){var n=r.style,i=R(t,e),a=i.added,o=i.removed,s=i.changed;for(var u in a)n[u]=a[u];for(var u in s)n[u]=s[u][1];for(var u in o)n[u]=""}(e.style||{},this.props.style||{},i),t.push(function(){n?r._mounted():r._updated()}),!0},r._unmount=function(){var t=this.events,e=this.base;for(var r in t)e.removeEventListener(r,t[r]);this._providers.forEach(function(t){t._unmount()}),this.events={},e.parentNode.removeChild(e)},t}(B);function Y(t){if(!t)return null;if(t instanceof Node)return t;var e=t._provider._providers;return e.length?Y(e[0].base):null}var X=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}M(e,t);var r=e.prototype;return r._render=function(t){var e=this.type(this.props);return U(e?[e]:[],this._providers,t),!0},r._unmount=function(){this._providers.forEach(function(t){t._unmount()})},e}(B),j=function(i){function t(t,e,r,n){return void 0===n&&(n={}),i.call(this,t,e,r,T(n,t.defaultProps))||this}M(t,i);var e=t.prototype;return e._should=function(t,e){return this.base.shouldComponentUpdate(T(t,this.type.defaultProps),e||this.base.state)},e._render=function(t,e,r){var n=this;this.props=T(this.props,this.type.defaultProps);var i=!this.base;i?(this.base=new this.type(this.props),this.base._provider=this):this.base.props=this.props;var a=this.base,o=a.state,s=a.render();s&&s.props&&!s.props.children.length&&(s.props.children=this.props.children),U(s?[s]:[],this._providers,t,r,null),t.push(function(){i?(n._mounted(),a.componentDidMount()):(n._updated(),a.componentDidUpdate(e,o))})},e._setState=function(t){t&&(this.base.state=t)},e._unmount=function(){this._providers.forEach(function(t){t._unmount()}),this.base.componentWillUnmount()},t}(B),W=function(){function t(t){void 0===t&&(t={}),this.props=t,this.state={}}var e=t.prototype;return e.shouldComponentUpdate=function(t,e){return!0},e.render=function(){return null},e.setState=function(t,e,r){var n=[],i=this._provider;U([i.original],[i],n,C(C({},this.state),t),null,r)&&(e&&n.push(e),P(n))},e.forceUpdate=function(t){this.setState(this.state,t,!0)},e.componentDidMount=function(){},e.componentDidUpdate=function(t,e){},e.componentWillUnmount=function(){},t}(),H=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype.shouldComponentUpdate=function(t,e){return O(this.props,t)||O(this.state,e)},e}(W),V=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}M(e,t);var r=e.prototype;return r.componentDidMount=function(){var t=this.props,e=t.element,r=t.container;this._portalProvider=q(e,r)},r.componentDidUpdate=function(){var t=this.props,e=t.element,r=t.container;this._portalProvider=q(e,r)},r.componentWillUnmount=function(){var t=this.props.container;q(this._portalProvider=null,t)},e}(H);function U(i,o,n,a,s,u){var c=i.map(function(t){return d(t)?null:t.key}),t=l(_(o.map(function(t){return t.key})),_(c),function(t){return t});t.removed.forEach(function(t){o.splice(t,1)[0]._unmount()}),t.ordered.forEach(function(t){var e=t[0],r=t[1],n=o.splice(e,1)[0];o.splice(r,0,n);var i=Y(n.base),a=Y(o[r+1]&&o[r+1].base);i&&i.parentNode.insertBefore(i,a)}),t.added.forEach(function(t){o.splice(t,0,z(i[t],c[t]))});var e=t.maintained.filter(function(t){t[0];var e=t[1],r=i[e],n=o[e];return(d(r)?"text_"+r:r.type)!==n.type&&(n._unmount(),o.splice(e,1,z(r,c[e])),!0)}),r=o.filter(function(t,e){var r=i[e];return t._update(n,r,a,u)});return s&&function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)n[i]=a[o];return n}(t.added,e.map(function(t){t[0];return t[1]})).forEach(function(t){var e=Y(o[t].base);if(e){var r=o[t+1];if(s!==e&&!e.parentNode){var n=Y(r&&r.base);s.insertBefore(e,n&&n.parentNode?n:null)}}}),0<r.length}function q(t,e,r){void 0===r&&(r=e.__REACT_COMPAT__);var n=r?[r]:[];return function(t,e,r,n){var i=[];U(t,e,i,r,n),P(i)}(t?[t]:[],n,null,e),r=n[0],e.__REACT_COMPAT__=r}function $(t,e,r){var n=e.__REACT_COMPAT__;t&&!n&&(e.innerHTML=""),q(t,e,n),r&&r()}function J(e,r){return function(t){t&&(e[r]=t)}}var Z=("undefined"!=typeof window&&window||{}).navigator,Q={browser:[{criteria:"PhantomJS",identity:"PhantomJS"},{criteria:/Whale/,identity:"Whale",versionSearch:"Whale"},{criteria:/Edge/,identity:"Edge",versionSearch:"Edge"},{criteria:/MSIE|Trident|Windows Phone/,identity:"IE",versionSearch:"IEMobile|MSIE|rv"},{criteria:/MiuiBrowser/,identity:"MIUI Browser",versionSearch:"MiuiBrowser"},{criteria:/SamsungBrowser/,identity:"Samsung Internet",versionSearch:"SamsungBrowser"},{criteria:/SAMSUNG /,identity:"Samsung Internet",versionSearch:"Version"},{criteria:/Chrome|CriOS/,identity:"Chrome"},{criteria:/Android/,identity:"Android Browser",versionSearch:"Version"},{criteria:/iPhone|iPad/,identity:"Safari",versionSearch:"Version"},{criteria:"Apple",identity:"Safari",versionSearch:"Version"},{criteria:"Firefox",identity:"Firefox"}],os:[{criteria:/Windows Phone/,identity:"Windows Phone",versionSearch:"Windows Phone"},{criteria:"Windows 2000",identity:"Window",versionAlias:"5.0"},{criteria:/Windows NT/,identity:"Window",versionSearch:"Windows NT"},{criteria:/iPhone|iPad/,identity:"iOS",versionSearch:"iPhone OS|CPU OS"},{criteria:"Mac",versionSearch:"OS X",identity:"MAC"},{criteria:/Android/,identity:"Android"},{criteria:/Tizen/,identity:"Tizen"},{criteria:/Web0S/,identity:"WebOS"}],webview:[{criteria:/iPhone|iPad/,browserVersionSearch:"Version",webviewBrowserVersion:/-1/},{criteria:/iPhone|iPad|Android/,webviewToken:/NAVER|DAUM|; wv/}],defaultString:{browser:{version:"-1",name:"unknown"},os:{version:"-1",name:"unknown"}}};function tt(t,e){for(var r=[],n=0;n<t.length;n++)e(t[n])&&r.push(t[n]);return r}var et=void 0;function rt(t,e){return e&&e.test?!!e.test(t):-1<t.indexOf(e)}function nt(t,e){var r=tt(t,function(t){return rt(et,t.criteria)})[0];return r&&r.identity||e.name}function it(t,n){return tt(t,function(t){var e=t.criteria,r=new RegExp(t.identity,"i").test(n);return!!(e?r&&rt(et,e):r)})[0]}function at(t,e){var r=Q.defaultString.browser.version,n=new RegExp("("+t+")","i").exec(e);if(!n)return r;var i=n.index,a=n[0];if(-1<i){var o=i+a.length+1;r=e.substring(o).split(" ")[0].replace(/_/g,".").replace(/;|\)/g,"")}return r}function ot(t){if(t)return at(function(t){var e=it(Q.browser,t);return e=e||{criteria:t,versionSearch:t,identity:t}}(t).versionSearch||t,et)}function st(){var t=Q.webview,e=void 0;return function(t,e){for(var r=0;r<t.length;r++)if(e(t[r]))return!0;return!1}(tt(t,function(t){return rt(et,t.criteria)}),function(t){return e=at(t.browserVersionSearch,et),!(!rt(et,t.webviewToken)&&!rt(e,t.webviewBrowserVersion))})}function ut(t){var e=function(t){return it(Q.os,t)}(t)||{},r=Q.defaultString.os.version,n=void 0;if(t){if(e.versionAlias)return e.versionAlias;var i=e.versionSearch||t,a=new RegExp("("+i+")\\s([\\d_\\.]+|\\d_0)","i");return a.exec(et)&&(n=a.exec(et)[2].replace(/_/g,".").replace(/;|\)/g,"")),n||r}}function ct(){var t=nt(Q.os,Q.defaultString.os);return{name:t,version:ut(t)}}function lt(){var t=nt(Q.browser,Q.defaultString.browser);return{name:t,version:ot(t),webview:st()}}function ft(){!function(t){et=t}(0<arguments.length&&void 0!==arguments[0]?arguments[0]:Z.userAgent);var t={os:ct(),browser:lt(),isMobile:-1!==et.indexOf("Mobi")};return t.browser.name=t.browser.name.toLowerCase(),t.os.name=t.os.name.toLowerCase(),t.os.version=t.os.version.toLowerCase(),"ios"===t.os.name&&t.browser.webview&&(t.browser.version="-1"),t}function pt(t,e,r,n,i,a){for(var o=r;o<n;++o)t[o]+=t[i+o-r]*a,e[o]+=e[i+o-r]*a}function ht(t,e,r,n,i){for(var a=r;a<n;++a){var o=t[a],s=e[a];t[a]=t[i+a-r],t[i+a-r]=o,e[a]=e[i+a-r],e[i+a-r]=s}}function dt(t,e,r,n,i){for(var a=r;a<n;++a)t[a]/=i,e[a]/=i}function vt(t,e){void 0===e&&(e=Math.sqrt(t.length));for(var r=t.slice(),n=_t(e),i=0;i<e;++i){var a=e*i,o=e*(i+1),s=a+i;if(0===r[s])for(var u=i+1;u<e;++u)if(r[e*u+i]){ht(r,n,a,o,e*u);break}if(!r[s])return[];dt(r,n,a,o,r[s]);for(u=0;u<e;++u){var c=e*u,l=c+e,f=r[c+i];0!==f&&i!==u&&pt(r,n,c,l,a,-f)}}return n}function gt(t,e){void 0===e&&(e=Math.sqrt(t.length));for(var r=[],n=0;n<e;++n)for(var i=0;i<e;++i)r[i*e+n]=t[e*n+i];return r}function mt(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=Math.atan2(n,r);return 0<=i?i:i+2*Math.PI}function bt(t,e){for(var r=t.slice(),n=t.length;n<e-1;++n)r[n]=0;return r[e-1]=1,r}function yt(t,e,r){if(void 0===e&&(e=Math.sqrt(t.length)),e===r)return t;for(var n=_t(r),i=Math.min(e,r),a=0;a<i-1;++a){for(var o=0;o<i-1;++o)n[a*r+o]=t[a*e+o];n[(a+1)*r-1]=t[(a+1)*e-1],n[(r-1)*r+a]=t[(e-1)*e+a]}return n[r*r-1]=t[e*e-1],n}function Et(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=_t(e);return t.forEach(function(t){n=xt(n,t,e)}),n}function xt(t,e,r){var n=[],i=t.length/r,a=e.length/i;if(!i)return e;if(!a)return t;for(var o=0;o<r;++o)for(var s=0;s<a;++s)for(var u=n[o*a+s]=0;u<i;++u)n[o*a+s]+=t[o*i+u]*e[u*a+s];return n}function wt(t,e,r){void 0===r&&(r=Math.sqrt(t.length));for(var n=[],i=t.length/r,a=e.length/i,o=0;o<r;++o)for(var s=0;s<a;++s)for(var u=n[o+s*a]=0;u<i;++u)n[o+s*a]+=t[o+u*i]*e[u+s*a];return n}function St(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=t.length,n=0,i=r-1;0<=i;--i)n+=t[i];return r?n/r:0}function Mt(t,e){for(var r=Math.min(t.length,e.length),n=t.slice(),i=0;i<r;++i)n[i]=n[i]+e[i];return n}function Ct(t,e){for(var r=Math.min(t.length,e.length),n=t.slice(),i=0;i<r;++i)n[i]=n[i]-e[i];return n}function Dt(t,e,r){void 0===r&&(r=e.length);var n=xt(t,e,r),i=n[r-1];return n.map(function(t){return t/i})}function Ot(t,e){return Dt(Pt(e,3),bt(t,3))}function Rt(t){return 9===t.length?[t[0],t[3],t[1],t[4],t[2],t[5]]:gt(t)}function Pt(t,e){var r=Math.cos(t),n=Math.sin(t),i=_t(e);return i[0]=r,i[1]=-n,i[e]=n,i[e+1]=r,i}function _t(t){for(var e=t*t,r=[],n=0;n<e;++n)r[n]=n%(t+1)?0:1;return r}function zt(t,e){for(var r=_t(e),n=Math.min(t.length,e-1),i=0;i<n;++i)r[(e+1)*i]=t[i];return r}function Gt(t,e){for(var r=_t(e),n=Math.min(t.length,e-1),i=0;i<n;++i)r[e*(i+1)-1]=t[i];return r}function Tt(t,e,r,n,i,a,o,s){var u=t[0],c=t[1],l=e[0],f=e[1],p=r[0],h=r[1],d=n[0],v=n[1],g=i[0],m=i[1],b=a[0],y=a[1],E=o[0],x=o[1],w=s[0],S=s[1],M=vt([u,c,1,0,0,0,-g*u,-g*c,0,0,0,u,c,1,-m*u,-m*c,l,f,1,0,0,0,-b*l,-b*f,0,0,0,l,f,1,-y*l,-y*f,p,h,1,0,0,0,-E*p,-E*h,0,0,0,p,h,1,-x*p,-x*h,d,v,1,0,0,0,-w*d,-w*v,0,0,0,d,v,1,-S*d,-S*v],8);if(!M.length)return[];var C=xt(M,[g,m,b,y,E,x,w,S],8);return C[8]=1,yt(C,3,4)}ft.VERSION="2.1.5";var At=function(t){for(var e=5381,r=t.length;r;)e=33*e^t.charCodeAt(--r);return e>>>0};function Bt(r,t,e){var n=document.createElement("style");return n.setAttribute("type","text/css"),n.innerHTML=t.replace(/([^}{]*){/gm,function(t,e){return function(t){var e=t.match(/("[^"]*"|'[^']*'|[^,\s()]*\((?:[^()]*|\([^()]*\))*\)[^,\s()]*|[^,])+/g);return e?e.map(function(t){return t.trim()}):[]}(e).map(function(t){return-1<t.indexOf(":global")?t.replace(/\:global/g,""):-1<t.indexOf(":host")?""+t.replace(/\:host/g,"."+r):"."+r+" "+t}).join(", ")+"{"}),(e||document.head||document.body).appendChild(n),n}function It(i){var a,o="rCS"+function(t){return At(t).toString(36)}(i),s=0;return{className:o,inject:function(t){var e,r=function(t){if(t.getRootNode){var e=t.getRootNode();if(11===e.nodeType)return e}}(t),n=0===s;return(r||n)&&(e=Bt(o,i,r)),n&&(a=e),r||++s,{destroy:function(){r?(t.removeChild(e),e=null):(0<s&&--s,0===s&&a&&(a.parentNode.removeChild(a),a=null))}}}}}var Nt=function(t,e){return(Nt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};var kt=function(){return(kt=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};var Yt=function(){return(Yt=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function Xt(t,e,r,n){var i=Ut(t),a=Ut(e),o=Ut(n);return Ft(qt(n[0],Kt(i,o)),qt(n[0],Kt(a,o)),r[0])}function jt(t){return t.touches?Ht(t.touches):[Vt(t)]}function Ft(t,e,r){var n=t.clientX,i=t.clientY;return{clientX:n,clientY:i,deltaX:n-e.clientX,deltaY:i-e.clientY,distX:n-r.clientX,distY:i-r.clientY}}function Lt(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function Wt(t,r,n){return t.map(function(t,e){return Ft(t,r[e],n[e])})}function Ht(t){for(var e=Math.min(t.length,2),r=[],n=0;n<e;++n)r.push(Vt(t[n]));return r}function Vt(t){return{clientX:t.clientX,clientY:t.clientY}}function Ut(t){return{clientX:(t[0].clientX+t[1].clientX)/2,clientY:(t[0].clientY+t[1].clientY)/2}}function qt(t,e){return{clientX:t.clientX+e.clientX,clientY:t.clientY+e.clientY}}function Kt(t,e){return{clientX:t.clientX-e.clientX,clientY:t.clientY-e.clientY}}var $t=function(){function t(t,e){var s=this;void 0===e&&(e={}),this.el=t,this.options={},this.flag=!1,this.pinchFlag=!1,this.datas={},this.isDrag=!1,this.isPinch=!1,this.isMouse=!1,this.isTouch=!1,this.prevClients=[],this.startClients=[],this.movement=0,this.startPinchClients=[],this.startDistance=0,this.customDist=[0,0],this.onDragStart=function(t){if(s.flag||!1!==t.cancelable){if(function(t){return t.touches&&2<=t.touches.length}(t)){if(!s.flag&&t.touches.length!==t.changedTouches.length)return;s.pinchFlag||s.onPinchStart(t)}if(!s.flag){var e=s.startClients[0]?s.startClients:jt(t);s.customDist=[0,0],s.flag=!0,s.isDrag=!1,s.startClients=e,s.prevClients=e,s.datas={};var r=Ft(e[s.movement=0],s.prevClients[0],s.startClients[0]),n=s.options,i=n.dragstart,a=n.preventRightClick,o=n.preventDefault;(a&&3===t.which||!1===(i&&i(Yt({datas:s.datas,inputEvent:t},r))))&&(s.startClients=[],s.prevClients=[],s.flag=!1),s.flag&&o&&t.preventDefault()}}},this.onDrag=function(t,e){if(s.flag){var r=jt(t);s.pinchFlag&&s.onPinch(t,r);var n=s.move([0,0],t,r);if(n&&(n.deltaX||n.deltaY)){var i=s.options.drag;i&&i(Yt({},n,{isScroll:!!e,inputEvent:t}))}}},this.onDragEnd=function(t){if(s.flag){s.pinchFlag&&s.onPinchEnd(t),s.flag=!1;var e=s.options.dragend,r=s.prevClients,n=s.startClients,i=s.pinchFlag?Xt(r,r,n,s.startPinchClients):Ft(r[0],r[0],n[0]);s.startClients=[],s.prevClients=[],e&&e(Yt({datas:s.datas,isDrag:s.isDrag,inputEvent:t},i))}},this.options=Yt({container:t,preventRightClick:!0,preventDefault:!0,pinchThreshold:0,events:["touch","mouse"]},e);var r=this.options,n=r.container,i=r.events;if(this.isTouch=-1<i.indexOf("touch"),this.isMouse=-1<i.indexOf("mouse"),this.customDist=[0,0],this.isMouse&&(g(t,"mousedown",this.onDragStart),g(n,"mousemove",this.onDrag),g(n,"mouseup",this.onDragEnd)),this.isTouch){var a={passive:!1};g(t,"touchstart",this.onDragStart,a),g(n,"touchmove",this.onDrag,a),g(n,"touchend",this.onDragEnd,a)}}var e=t.prototype;return e.isDragging=function(){return this.isDrag},e.isFlag=function(){return this.flag},e.isPinching=function(){return this.isPinch},e.scrollBy=function(e,r,t,n){void 0===n&&(n=!0),this.flag&&(this.startClients.forEach(function(t){t.clientX-=e,t.clientY-=r}),this.prevClients.forEach(function(t){t.clientX-=e,t.clientY-=r}),n&&this.onDrag(t,!0))},e.move=function(t,e,r){var n=t[0],i=t[1];void 0===r&&(r=this.prevClients);var a=this.customDist,o=this.prevClients,s=this.startClients,u=this.pinchFlag?Xt(r,o,s,this.startPinchClients):Ft(r[0],o[0],s[0]);a[0]+=n,a[1]+=i,u.deltaX+=n,u.deltaY+=i;var c=u.deltaX,l=u.deltaY;return u.distX+=a[0],u.distY+=a[1],this.movement+=Math.sqrt(c*c+l*l),this.prevClients=r,this.isDrag=!0,Yt({datas:this.datas},u,{isScroll:!1,inputEvent:e})},e.onPinchStart=function(t){var e,r,n=this.options,i=n.pinchstart,a=n.pinchThreshold;if(!(this.isDrag&&this.movement>a)){var o=Ht(t.changedTouches);if(this.pinchFlag=!0,(e=this.startClients).push.apply(e,o),(r=this.prevClients).push.apply(r,o),this.startDistance=Lt(this.prevClients),this.startPinchClients=this.prevClients.slice(),i){var s=this.prevClients,u=Ut(s),c=Ft(u,u,u);i(Yt({datas:this.datas,touches:Wt(s,s,s)},c,{inputEvent:t}))}}},e.onPinch=function(t,e){if(this.flag&&this.pinchFlag){this.isPinch=!0;var r=this.options.pinch;if(r){var n=this.prevClients,i=this.startClients,a=Ft(Ut(e),Ut(n),Ut(i)),o=Lt(e);r(Yt({datas:this.datas,touches:Wt(e,n,i),scale:o/this.startDistance,distance:o},a,{inputEvent:t}))}}},e.onPinchEnd=function(t){if(this.flag&&this.pinchFlag){var e=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var r=this.options.pinchend;if(r){var n=this.prevClients,i=this.startClients,a=Ft(Ut(n),Ut(n),Ut(i));r(Yt({datas:this.datas,isPinch:e,touches:Wt(n,n,i)},a,{inputEvent:t})),this.isPinch=!1,this.pinchFlag=!1}}},e.unset=function(){var t=this.el,e=this.options.container;this.isMouse&&(m(t,"mousedown",this.onDragStart),m(e,"mousemove",this.onDrag),m(e,"mouseup",this.onDragEnd)),this.isTouch&&(m(t,"touchstart",this.onDragStart),m(e,"touchmove",this.onDrag),m(e,"touchend",this.onDragEnd))},t}(),Jt=function(t,e){return(Jt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function Zt(t){var e=t.container;return[e.scrollLeft,e.scrollTop]}var Qt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startRect=null,t.startPos=[],t.prevTime=0,t.timer=0,t}!function(t,e){function r(){this.constructor=t}Jt(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(t,e);var r=t.prototype;return r.dragStart=function(t,e){var r=e.container.getBoundingClientRect(),n=r.top,i=r.left,a=r.width,o=r.height;this.startPos=[t.clientX,t.clientY],this.startRect={top:n,left:i,width:a,height:o}},r.drag=function(t,e){var r=this,n=t.clientX,i=t.clientY,a=e.container,o=e.threshold,s=void 0===o?0:o,u=e.throttleTime,c=void 0===u?0:u,l=e.getScrollPosition,f=void 0===l?Zt:l,p=this.startRect,h=this.startPos,d=Date.now?Date.now():(new Date).getTime(),v=Math.max(c+this.prevTime-d,0),g=[0,0];if(p.top>i-s?(h[1]>p.top||i<h[1])&&(g[1]=-1):p.top+p.height<i+s&&(h[1]<p.top+p.height||i>h[1])&&(g[1]=1),p.left>n-s?(h[0]>p.left||n<h[0])&&(g[0]=-1):p.left+p.width<n+s&&(h[0]<p.left+p.width||n>h[0])&&(g[0]=1),clearTimeout(this.timer),!g[0]&&!g[1])return!1;if(0<v)return this.timer=window.setTimeout(function(){r.drag(t,e)},v),!1;this.prevTime=d;var m=f({container:a,direction:g});this.trigger("scroll",{container:a,direction:g,inputEvent:t});var b=f({container:a,direction:g}),y=b[0]-m[0],E=b[1]-m[1];return!(!y&&!E)&&(this.trigger("move",{offsetX:g[0]?y:0,offsetY:g[1]?E:0,inputEvent:t}),c&&(this.timer=window.setTimeout(function(){r.drag(t,e)},c)),!0)},r.dragEnd=function(){clearTimeout(this.timer)},t}(t),te=function(t,e){return(te=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};var ee,re="function"==typeof Map?void 0:(ee=0,function(t){return t.__DIFF_KEY__||(t.__DIFF_KEY__=++ee)}),ne=function(e){function t(t){return void 0===t&&(t=[]),e.call(this,t,re)||this}return function(t,e){function r(){this.constructor=t}te(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(t,e),t}(e),ie=function(t,e){return(ie=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function ae(t,e){function r(){this.constructor=t}ie(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var oe=function(){return(oe=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function se(t,e){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'+32*t+'px" height="'+32*t+'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate('+e+'deg);transform-origin: 16px 16px"></path></svg>'}var ue,ce=ft(),le=-1<ce.os.name.indexOf("ios")||-1<ce.browser.name.indexOf("safari"),fe="moveable-",pe=(ue=fe,("\n{\n\tposition: fixed;\n\twidth: 0;\n\theight: 0;\n\tleft: 0;\n\ttop: 0;\n\tz-index: 3000;\n}\n.control-box {\n    z-index: 0;\n}\n.line, .control {\n\tleft: 0;\n    top: 0;\n    will-change: transform;\n}\n.control {\n\tposition: absolute;\n\twidth: 14px;\n\theight: 14px;\n\tborder-radius: 50%;\n\tborder: 2px solid #fff;\n\tbox-sizing: border-box;\n\tbackground: #4af;\n\tmargin-top: -7px;\n    margin-left: -7px;\n    z-index: 10;\n}\n.line {\n\tposition: absolute;\n\twidth: 1px;\n\theight: 1px;\n\tbackground: #4af;\n\ttransform-origin: 0px 0.5px;\n}\n.line.dashed {\n    box-sizing: border-box;\n    background: transparent;\n}\n.line.dashed.horizontal {\n    border-top: 1px dashed #4af;\n}\n.line.dashed.vertical {\n    border-left: 1px dashed #4af;\n}\n.line.dashed:before {\n    position: absolute;\n    content: attr(data-size);\n    color: #4af;\n    font-size: 12px;\n    font-weight: bold;\n}\n.line.dashed.horizontal:before {\n    left: 50%;\n    transform: translateX(-50%);\n    bottom: 5px;\n}\n.line.dashed.vertical:before {\n    top: 50%;\n    transform: translateY(-50%);\n    left: 5px;\n}\n.line.rotation-line {\n\theight: 40px;\n\twidth: 1px;\n    transform-origin: 0.5px 39.5px;\n    top: -40px;\n}\n.line.rotation-line .control {\n\tborder-color: #4af;\n\tbackground:#fff;\n\tcursor: alias;\n}\n.line.vertical {\n    transform: translateX(-50%);\n}\n.line.horizontal {\n    transform: translateY(-50%);\n}\n.line.vertical.bold {\n    width: 2px;\n}\n.line.horizontal.bold {\n    height: 2px;\n}\n.control.origin {\n\tborder-color: #f55;\n\tbackground: #fff;\n\twidth: 12px;\n\theight: 12px;\n\tmargin-top: -6px;\n\tmargin-left: -6px;\n\tpointer-events: none;\n}\n"+[0,15,30,45,60,75,90,105,120,135,150,165].map(function(t){return'\n.direction[data-rotation="'+t+'"] {\n\t'+function(t){var e=se(1,t),r=se(2,t),n=45*Math.round(t/45)%180,i=135==n?"nwse-resize":45==n?"nesw-resize":90==n?"ew-resize":"ns-resize";return"cursor:"+i+";cursor: url('"+e+"') 16 16, "+i+";cursor: -webkit-image-set(url('"+e+"') 1x, url('"+r+"') 2x) 16 16, "+i+";"}(t)+"\n}\n"}).join("\n")+"\n.group {\n    z-index: -1;\n}\n.area {\n    position: absolute;\n}\n.area-pieces {\n    position: absolute;\n    top: 0;\n    left: 0;\n    display: none;\n}\n.area.avoid {\n    pointer-events: none;\n}\n.area.avoid+.area-pieces {\n    display: block;\n}\n.area-piece {\n    position: absolute;\n}\n"+(le?':global svg *:before {\n\tcontent:"";\n\ttransform-origin: inherit;\n}':"")+"\n").replace(/([^}{]*){/gm,function(t,e){return e.replace(/\.([^{,\s\d.]+)/g,"."+ue+"$1")+"{"})),he=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],de=1e-7,ve=Math.pow(10,10),ge=-ve,me={n:[0,1],s:[2,3],w:[2,0],e:[1,3],nw:[0],ne:[1],sw:[2],se:[3]},be={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135};function ye(t,e){return[t[0]*e[0],t[1]*e[1]]}function Ee(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.map(function(t){return t.split(" ").map(function(t){return t?""+e+t:""}).join(" ")}).join(" ")}.apply(void 0,[fe].concat(t))}function xe(){return _t(3)}function we(t){return t&&"none"!==t?L(t)?t:function(t){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(t);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}(t).value.split(/s*,\s*/g).map(function(t){return parseFloat(t)}):[1,0,0,1,0,0]}function Se(t,e,r){return Et(e,Gt(r,e),t,Gt(r.map(function(t){return-t}),e))}function Me(a){return Ce(Ze(a,":before")).map(function(t,e){var r=w(t),n=r.value,i=r.unit;return n*function(t,e,r){return"%"!==e?1:t.ownerSVGElement.viewBox.baseVal[r?"width":"height"]/100}(a,i,0===e)})}function Ce(t){var e=t.transformOrigin;return e?e.split(" "):["0","0"]}function De(t,e,r){for(var n=document.body,i=!t||r?t:t.parentElement,a=!1,o="relative";i&&i!==n;){e===i&&(a=!0);var s=Ze(i),u=s.transform;if("static"!==(o=s.position)||u&&"none"!==u)break;i=i.parentElement,o="relative"}return{isStatic:"static"===o,isEnd:a||!i||i===n,offsetParent:i||n}}function Oe(t,e,r,n){var i,a,o,s,u=t,c=[],l="svg"!==u.tagName.toLowerCase()&&"ownerSVGElement"in u,f=e||document.body,p=!1,h=!1,d=3,v=De(e,e,!0).offsetParent;for(r&&(e=t.parentElement);u&&!p;){var g=Ze(u),m=u.tagName.toLowerCase(),b=g.position,y="fixed"===b,E=g.transform,x=6===(s=we(E)).length?[s[0],s[2],s[4],s[1],s[3],s[5],0,0,1]:gt(s);if(!h&&16===x.length){h=!0,d=4;for(var w=c.length,S=0;S<w;++S)c[S]=yt(c[S],3,4)}h&&9===x.length&&(x=yt(x,3,4));var M=u.offsetLeft,C=u.offsetTop;if(y){var D=(e||document.documentElement).getBoundingClientRect();M-=D.left,C-=D.top}var O=F(M),R=O,P=void 0;R&&"svg"!==m?(P=le?Me(u):Ce(g).map(function(t){return parseFloat(t)}),R=!1,"g"===m?C=M=0:(M=(i=Pe(u,P))[0],C=i[1],P[0]=i[2],P[1]=i[3])):P=Ce(g).map(function(t){return parseFloat(t)}),"svg"===m&&o&&c.push(Re(u,d),_t(d));var _=De(u,e),z=_.offsetParent,G=_.isEnd,T=_.isStatic;le&&!R&&!O&&T&&"relative"===b&&(M-=z.offsetLeft,C-=z.offsetTop,p=p||G);var A=0,B=0;if(R||v===z||(A=z.clientLeft,B=z.clientTop),c.push(Se(x,d,P),Gt([R?u:M-u.scrollLeft+A,R?P:C-u.scrollTop+B],d)),o=o||x,a=a||P,p||y)break;u=z,p=G}var I=r?yt(r,n,d):_t(d),N=r?yt(r,n,d):_t(d),k=_t(d),Y=c.length,X=De(f,f,!0).offsetParent;c.reverse(),c.forEach(function(t,e){var r;Y-2===e&&(N=I.slice()),Y-1===e&&(k=I.slice()),L(t[d-1])&&(r=function(t,e,r,n,i,a){var o,s=ke(t),u=s[0],c=s[1],l=e.getBoundingClientRect(),f=t.getBoundingClientRect(),p=f.left-l.left+e.scrollLeft,h=f.top-l.top+e.scrollTop,d=f.width,v=f.height,g=Et(r,i,a),m=Te(g,u,c,r),b=m.left,y=m.top,E=m.width,x=m.height,w=_e(g,n,r),S=Ct(w,[b,y]),M=[p+S[0]*d/E,h+S[1]*v/x],C=[0,0],D=0;for(;++D<10;){var O=vt(i,r);o=Ct(_e(O,M,r),_e(O,w,r)),C[0]=o[0],C[1]=o[1];var R=Te(Et(r,i,Gt(C,r),a),u,c,r),P=R.left,_=R.top,z=P-p,G=_-h;if(Math.abs(z)<2&&Math.abs(G)<2)break;M[0]-=z,M[1]-=G}return C.map(function(t){return Math.round(t)})}(t[d-1],X,d,t[2*d-1],I,c[e+1]),t[d-1]=r[0],t[2*d-1]=r[1]),I=xt(I,t,d)});var j=(!l&&h?"matrix3d":"matrix")+"("+Rt(l&&16===o.length?yt(o,4,3):o)+")";return[N,k,I,o,j,a,h]}function Re(t,e){var r=t.clientWidth,n=t.clientHeight,i=t.viewBox.baseVal,a=i.width||r,o=i.height||n,s=r/a,u=n/o,c=t.preserveAspectRatio.baseVal,l=c.align,f=c.meetOrSlice,p=[0,0],h=[s,u],d=[0,0];if(1!==l){var v=(l-2)%3,g=Math.floor((l-2)/3);p[0]=a*v/2,p[1]=o*g/2;var m=2===f?Math.max(u,s):Math.min(s,u);h[0]=m,h[1]=m,d[0]=(r-a)/2*v,d[1]=(n-o)/2*g}var b=zt(h,e);return b[e-1]=d[0],b[2*e-1]=d[1],Se(b,e,p)}function Pe(t,e){if(!t.getBBox)return[0,0];var r=t.getBBox(),n=t.ownerSVGElement.viewBox.baseVal,i=r.x-n.x,a=r.y-n.y;return[i,a,e[0]-i,e[1]-a]}function _e(t,e,r){return Dt(t,bt(e,r),r)}function ze(t,e,r,n){return[_e(t,[0,0],n),_e(t,[e,0],n),_e(t,[0,r],n),_e(t,[e,r],n)]}function Ge(t){var e=t.map(function(t){return t[0]}),r=t.map(function(t){return t[1]}),n=Math.min.apply(Math,e),i=Math.min.apply(Math,r),a=Math.max.apply(Math,e),o=Math.max.apply(Math,r);return{left:n,top:i,right:a,bottom:o,width:a-n,height:o-i}}function Te(t,e,r,n){return Ge(ze(t,e,r,n))}function Ae(t,e,r,n){var i=16===t.length?4:3,a=ze(t,r,n,i),o=a[0],s=o[0],u=o[1],c=a[1],l=c[0],f=c[1],p=a[2],h=p[0],d=p[1],v=a[3],g=v[0],m=v[1],b=_e(t,e,i),y=b[0],E=b[1],x=Math.min(s,l,h,g),w=Math.min(u,f,d,m),S=Math.max(s,l,h,g),M=Math.max(u,f,d,m);y=y-x||0,E=E-w||0;var C=[((s=s-x||0)+(l=l-x||0)+(h=h-x||0)+(g=g-x||0))/4,((u=u-w||0)+(f=f-w||0)+(d=d-w||0)+(m=m-w||0))/4],D=mt(C,[s,u]),O=mt(C,[l,f]);return[[x,w,S,M],[y,E],[s,u],[l,f],[h,d],[g,m],D<O&&O-D<Math.PI||O<D&&O-D<-Math.PI?1:-1]}function Be(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Ie(t,e,r){void 0===r&&(r=mt(t,e));var n=function(t,e){return Be([e[0]-t[0],e[1]-t[1]])}(t,e);return{transform:"translate("+t[0]+"px, "+t[1]+"px) rotate("+r+"rad)",width:n+"px"}}function Ne(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=e.length;return{transform:"translate("+e.reduce(function(t,e){return t+e[0]},0)/n+"px, "+e.reduce(function(t,e){return t+e[1]},0)/n+"px) rotate("+t+"rad)"}}function ke(t,e,r,n){void 0===e&&(e=window.getComputedStyle(t)),void 0===n&&(n=r||"border-box"===e.boxSizing);var i=t.offsetWidth,a=t.offsetHeight,o=!F(i);if((r||n)&&o)return[i,a];if(i=t.clientWidth,a=t.clientHeight,o||i||a)return r||n?[i+(parseFloat(e.borderLeftWidth)||0)+(parseFloat(e.borderRightWidth)||0),a+(parseFloat(e.borderTopWidth)||0)+(parseFloat(e.borderBottomWidth)||0)]:[i-(parseFloat(e.paddingLeft)||0)-(parseFloat(e.paddingRight)||0),a-(parseFloat(e.paddingTop)||0)-(parseFloat(e.paddingBottom)||0)];var s=t.getBBox();return[s.width,s.height]}function Ye(t,e){return mt(0<e?t[0]:t[1],0<e?t[1]:t[0])}function Xe(t,e,r,n){var i,a,o,s,u,c=0,l=0,f=0,p=0,h=[0,0],d=[0,0],v=[0,0],g=[0,0],m=[0,0],b=xe(),y=xe(),E=xe(),x=xe(),w=0,S=0,M=[0,0],C=1,D=1,O=!1,R="",P=[0,0],_={left:0,right:0,top:0,width:0,height:0,bottom:0},z={left:0,right:0,top:0,width:0,height:0,bottom:0},G=0,T=n?n.beforeMatrix:void 0,A=n?n.is3d?4:3:void 0;if(t){if(n)w=n.width,S=n.height;else{var B=Ze(t);w=t.offsetWidth,S=t.offsetHeight,F(w)&&(w=(i=ke(t,B,!0))[0],S=i[1])}y=(a=Oe(t,e,T,A))[0],b=a[1],E=a[2],x=a[3],R=a[4],M=a[5],O=a[6],c=(s=(o=Ae(E,M,w,S))[0])[0],l=s[1],f=s[2],p=s[3],h=o[1],d=o[2],v=o[3],g=o[4],m=o[5],C=o[6];var I;I=(u=Ae(b,Mt(M,function(t,e){void 0===e&&(e=Math.sqrt(t.length));for(var r=[],n=0;n<e-1;++n)r[n]=t[(n+1)*e-1];return r[e-1]=0,r}(x,O?4:3)),w,S))[0],P=u[1],D=u[6],P=[P[0]+I[0]-c,P[1]+I[1]-l],_=je(t),z=je(De(r,r,!0).offsetParent||document.body),G=Ye([d,v],C)}return{rotation:G,targetClientRect:_,containerClientRect:z,beforeDirection:D,direction:C,target:t,left:c,top:l,right:f,bottom:p,pos1:d,pos2:v,pos3:g,pos4:m,width:w,height:S,beforeMatrix:y,matrix:E,targetTransform:R,offsetMatrix:b,targetMatrix:x,is3d:O,beforeOrigin:P,origin:h,transformOrigin:M}}function je(t){var e=t.getBoundingClientRect(),r=e.left,n=e.width,i=e.top,a=e.bottom;return{left:r,right:e.right,top:i,bottom:a,width:n,height:e.height}}function Fe(t){if(t){var e=t.getAttribute("data-direction");if(e){var r=[0,0];return-1<e.indexOf("w")&&(r[0]=-1),-1<e.indexOf("e")&&(r[0]=1),-1<e.indexOf("n")&&(r[1]=-1),-1<e.indexOf("s")&&(r[1]=1),r}}}function Le(t,e){return[Mt(e,t[0]),Mt(e,t[1]),Mt(e,t[2]),Mt(e,t[3])]}function We(t){var e=t.left,r=t.top;return Le([t.pos1,t.pos2,t.pos3,t.pos4],[e,r])}function He(t){return Math.round(t%1==-.5?t-1:t)}function Ve(t,e){return e?Math.round(t/e)*e:t}function Ue(r,n){return r.forEach(function(t,e){r[e]=Ve(r[e],n)}),r}function qe(t,e){t[e]&&(t[e].unset(),t[e]=null)}function Ke(t,e,r){return(t[0]-e[0])*(r[1]-e[1])-(t[1]-e[1])*(r[0]-e[0])}function $e(t,e,r){var n=e.datas;return n.datas||(n.datas={}),oe({},r,{target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,datas:n.datas})}function Je(t,e,r){return t.triggerEvent(e,r)}function Ze(t,e){return window.getComputedStyle(t,e)}function Qe(t,r){var n={},i={};return t.filter(function(e){var t=e.name;if(n[t]||!r.some(function(t){return e[t]}))return!1;if(e.ableGroup){if(i[e.ableGroup])return!1;i[e.ableGroup]=!0}return n[t]=!0})}function tr(t,e,r){return t*(e?r:1/r)}function er(t,e,r){return t*(e?1/r:r)}function rr(t,e){return t===e||null==t&&null==e}function nr(n,i){var a=[],o={};return n.forEach(function(t,e){var r=i(t,e,n);o[r]||(o[r]=[],a.push(o[r])),o[r].push(t)}),a}function ir(t){return t.reduce(function(t,e){return t.concat(e)},[])}function ar(r,t,e,n,i,a){var o="Start"===i;if(o&&-1<n.indexOf("Control")&&r.areaElement===a.inputEvent.target)return!1;var s=""+e+n+i,u=""+e+n+"Condition",c="End"===i,l=-1<i.indexOf("After");o&&r.updateRect(i,!0,!1);var f=-1<n.indexOf("Group"),p=r[t].filter(function(t){return t[s]}),h=p.filter(function(t){var e=o&&t[u];return!(e&&!e(a.inputEvent.target,r))&&t[s](r,a)}),d=h.length;if(o){if(p.length&&!d)return r.state.dragger=null,r.moveables&&r.moveables.forEach(function(t){t.state.dragger=null}),!1;!function(t,e,r){var n=$e(t,r,{isPinch:!!r.isPinch}),i=e?"Group":"";e&&(n.targets=t.props.targets),Je(t,"onRender"+i+"Start",n)}(r,f,a)}else c?function(t,e,r){var n=$e(t,r,{isPinch:!!r.sPinch,isDrag:r.isDrag}),i=e?"Group":"";e&&(n.targets=t.props.targets),Je(t,"onRender"+i+"End",n)}(r,f,a):d&&function(t,e,r){var n=$e(t,r,{isPinch:!!r.isPinch}),i=e?"Group":"";e&&(n.targets=t.props.targets),Je(t,"onRender"+i,n)}(r,f,a);c&&(r.state.dragger=null),!o&&d&&(h.some(function(t){return t.updateRect})&&!f?r.updateRect(i,!1,!1):r.updateRect(i,!0,!1)),(!o&&d||c&&!d)&&r.forceUpdate(),o||c||l||!d||ar(r,t,e,n,i+"After",a)}function or(n,t,i,a){var o={container:window,pinchThreshold:n.props.pinchThreshold};return["drag","pinch"].forEach(function(r){["Start","","End"].forEach(function(e){o[""+r+e.toLowerCase()]=function(t){return ar(n,i,r,a,e,t)}})}),new $t(t,o)}var sr,ur,cr=(sr="div",ur=It(pe),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return function(t,e){function r(){this.constructor=t}Nt(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e.prototype.render=function(){var t=this.props,e=t.className,r=void 0===e?"":e,n=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r}(t,["className"]);return A(sr,kt({ref:J(this,"element"),className:r+" "+ur.className},n))},e.prototype.componentDidMount=function(){this.injectResult=ur.inject(this.element)},e.prototype.componentWillUnmount=function(){this.injectResult.destroy(),this.injectResult=null},e.prototype.getElement=function(){return this.element},e}(W));function lr(t,e,r,n){var i=mt(e,r),a=t?Ve(i/Math.PI*180,15)%180:-1;return A("div",{key:"line"+n,className:Ee("line","direction",t),"data-rotation":a,"data-direction":t,style:Ie(e,r,i)})}var fr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={conatainer:null,target:null,beforeMatrix:xe(),matrix:xe(),targetMatrix:xe(),targetTransform:"",is3d:!1,left:0,top:0,width:0,height:0,transformOrigin:[0,0],direction:1,beforeDirection:1,beforeOrigin:[0,0],origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],targetClientRect:{left:0,right:0,top:0,width:0,height:0,bottom:0},containerClientRect:{left:0,right:0,top:0,width:0,height:0,bottom:0},rotation:0},t.targetAbles=[],t.controlAbles=[],t}ae(t,e);var r=t.prototype;return r.render=function(){var t=this.props,e=this.props,r=e.edge,n=e.parentPosition,i=e.className,a=e.target;this.checkUpdate();var o=n||{left:0,top:0},s=o.left,u=o.top,c=this.state,l=c.left,f=c.top,p=c.pos1,h=c.pos2,d=c.pos3,v=c.pos4,g=c.target,m=c.direction,b=t.targets,y=(b&&b.length||a)&&g;return A(cr,{ref:J(this,"controlBox"),className:Ee("control-box",-1===m?"reverse":"")+" "+i,style:{position:"absolute",display:y?"block":"none",transform:"translate("+(l-s)+"px, "+(f-u)+"px) translateZ(50px)"}},this.renderAbles(),lr(r?"n":"",p,h,0),lr(r?"e":"",h,v,1),lr(r?"w":"",p,d,2),lr(r?"s":"",d,v,3))},r.componentDidMount=function(){this.controlBox.getElement();var t=this.props,e=t.parentMoveable,r=t.container;this.updateEvent(t),r||e||this.updateRect("End",!1,!0)},r.componentDidUpdate=function(t){this.updateEvent(t)},r.componentWillUnmount=function(){qe(this,"targetDragger"),qe(this,"controlDragger")},r.getContainer=function(){var t=this.props,e=t.parentMoveable;return t.container||e&&e.getContainer()||this.controlBox.getElement().parentElement},r.isMoveableElement=function(t){return t&&-1<(t.getAttribute("class")||"").indexOf(fe)},r.dragStart=function(t){this.targetDragger&&this.targetDragger.onDragStart(t)},r.isInside=function(t,e){var r=this.state,n=r.pos1,i=r.pos2,a=r.pos3,o=r.pos4,s=r.target,u=r.targetClientRect;return!!s&&function(t,e,r,n,i){var a=[Ke(t,e,r),Ke(t,r,i),Ke(t,i,e)],o=[Ke(t,r,i),Ke(t,i,n),Ke(t,n,r)];return!!(a.every(function(t){return 0<=t})||a.every(function(t){return t<=0})||o.every(function(t){return 0<=t})||o.every(function(t){return t<=0}))}([t-u.left,e-u.top],n,i,o,a)},r.updateRect=function(t,e,r){void 0===r&&(r=!0);var n=this.props.parentMoveable,i=this.state,a=i.target||this.props.target,o=this.getContainer();this.updateState(Xe(a,o,o,e?i:void 0),!n&&r)},r.updateEvent=function(t){var e=this.controlBox.getElement(),r=this.targetAbles.length,n=this.controlAbles.length,i=this.props.target,a=t.target,o=this.props.dragArea,s=t.dragArea,u=!o&&a!==i,c=!r&&this.targetDragger||u||s!==o;c&&(qe(this,"targetDragger"),this.updateState({dragger:null})),n||qe(this,"controlDragger"),i&&r&&!this.targetDragger&&(this.targetDragger=or(this,o?this.areaElement:i,"targetAbles","")),!this.controlDragger&&n&&(this.controlDragger=or(this,e,"controlAbles","Control")),c&&this.unsetAbles()},r.updateTarget=function(t){this.updateRect(t,!0)},r.getRect=function(){var t=this.state,e=We(this.state),r=e[0],n=e[1],i=e[2],a=e[3],o=Ge(e),s=t.width,u=t.height;return{width:o.width,height:o.height,left:o.left,top:o.top,pos1:r,pos2:n,pos3:i,pos4:a,offsetWidth:s,offsetHeight:u}},r.checkUpdate=function(){var t=this.props,e=t.target,r=t.container,n=t.parentMoveable,i=this.state,a=i.target,o=i.container;(a||e)&&(this.updateAbles(),rr(a,e)&&rr(o,r)||(this.updateState({target:e,container:r}),n||!r&&!this.controlBox||this.updateRect("End",!1,!1)))},r.triggerEvent=function(t,e){var r=this.props[t];return r&&r(e)},r.unsetAbles=function(){var e=this;this.targetAbles.filter(function(t){return!!t.unset&&(t.unset(e),!0)}).length&&this.forceUpdate()},r.updateAbles=function(t,e){void 0===t&&(t=this.props.ables),void 0===e&&(e="");var r=this.props,n=t.filter(function(t){return t&&r[t.name]}),i="drag"+e+"ControlStart",a=Qe(n,["drag"+e+"Start","pinch"+e+"Start"]),o=Qe(n,[i]);this.targetAbles=a,this.controlAbles=o},r.updateState=function(t,e){if(e)this.setState(t);else{var r=this.state;for(var n in t)r[n]=t[n]}},r.renderAbles=function(){var e=this,r=this.props,t=r.ables.filter(function(t){return t&&r[t.name]}),n={createElement:A};return ir(Qe(t,["render"]).map(function(t){return(0,t.render)(e,n)}))},t.defaultProps={target:null,container:null,origin:!0,edge:!1,parentMoveable:null,parentPosition:null,ables:[],pinchThreshold:20,dragArea:!1,transformOrigin:"",className:""},t}(H);function pr(t){return mt([t[0].clientX,t[0].clientY],[t[1].clientX,t[1].clientY])/Math.PI*180}var hr={name:"pinchable",updateRect:!0,props:{pinchable:Boolean,pinchThreshold:Number},pinchStart:function(r,t){var n=t.datas,i=t.clientX,a=t.clientY,e=t.touches,o=t.inputEvent,s=t.targets,u=r.props,c=u.pinchable,l=u.ables;if(!c)return!1;var f="onPinch"+(s?"Group":"")+"Start",p="drag"+(s?"Group":"")+"ControlStart",h=(!0===c?r.controlAbles:l.filter(function(t){return-1<c.indexOf(t.name)})).filter(function(t){return t.canPinch&&t[p]}),d=$e(r,t,{});s&&(d.targets=s);var v=Je(r,f,d);n.isPinch=!1!==v,n.ables=h;var g=n.isPinch;if(!g)return!1;var m=pr(e);return h.forEach(function(t){n[t.name+"Datas"]={};var e={datas:n[t.name+"Datas"],clientX:i,clientY:a,inputEvent:o,parentRotate:m,pinchFlag:!0};t[p](r,e)}),r.state.snapRenderInfo={direction:[0,0]},g},pinch:function(e,t){var r=t.datas,n=t.clientX,i=t.clientY,a=t.scale,o=t.distance,s=t.touches,u=t.inputEvent,c=t.targets;if(r.isPinch){var l=pr(s),f=o*(1-1/a),p=$e(e,t,{});c&&(p.targets=c),Je(e,"onPinch"+(c?"Group":""),p);var h=r.ables,d="drag"+(c?"Group":"")+"Control";return h.forEach(function(t){t[d](e,{clientX:n,clientY:i,datas:r[t.name+"Datas"],inputEvent:u,parentDistance:f,parentRotate:l,pinchFlag:!0})}),p}},pinchEnd:function(e,t){var r=t.datas,n=t.clientX,i=t.clientY,a=t.isPinch,o=t.inputEvent,s=t.targets;if(r.isPinch){var u="onPinch"+(s?"Group":"")+"End",c=$e(e,t,{isDrag:a});s&&(c.targets=s),Je(e,u,c);var l=r.ables,f="drag"+(s?"Group":"")+"ControlEnd";return l.forEach(function(t){t[f](e,{clientX:n,clientY:i,isDrag:a,datas:r[t.name+"Datas"],inputEvent:o,pinchFlag:!0})}),a}},pinchGroupStart:function(t,e){return this.pinchStart(t,oe({},e,{targets:t.props.targets}))},pinchGroup:function(t,e){return this.pinch(t,oe({},e,{targets:t.props.targets}))},pinchGroupEnd:function(t,e){return this.pinchEnd(t,oe({},e,{targets:t.props.targets}))}};function dr(t,a,o,e,s,u){var r=a.name,c=e[r]||(e[r]=[]),l=!!o.match(/End$/g);return t.moveables.map(function(t,e){var r=c[e]||(c[e]={}),n=function(t){return typeof t===f}(s)?s(t,r):s,i=a[o](t,oe({},n,{datas:r,parentFlag:!0}));return i&&u&&u(t,r,i,e),l&&(t.state.dragger=null),i})}function vr(t){return v(t,Ee("direction"))}function gr(t,e){var r=e.datas,n=t.state,i=n.matrix,a=n.beforeMatrix,o=n.is3d,s=n.left,u=n.top,c=n.origin,l=n.offsetMatrix,f=n.targetMatrix,p=n.transformOrigin,h=o?4:3;r.is3d=o,r.matrix=i,r.targetMatrix=f,r.beforeMatrix=a,r.offsetMatrix=l,r.transformOrigin=p,r.inverseMatrix=vt(i,h),r.inverseBeforeMatrix=vt(a,h),r.absoluteOrigin=bt(Mt([s,u],c),h),r.startDragBeforeDist=Dt(r.inverseBeforeMatrix,r.absoluteOrigin,h),r.startDragDist=Dt(r.inverseMatrix,r.absoluteOrigin,h)}function mr(t,e){var r=t.datas,n=t.distX,i=t.distY,a=r.inverseBeforeMatrix,o=r.inverseMatrix,s=r.is3d,u=r.startDragBeforeDist,c=r.startDragDist,l=s?4:3;return Ct(Dt(e?a:o,Mt(r.absoluteOrigin,[n,i]),l),e?u:c)}function br(t){var e=[];return 0<=t[1]&&(0<=t[0]&&e.push(3),t[0]<=0&&e.push(2)),t[1]<=0&&(0<=t[0]&&e.push(1),t[0]<=0&&e.push(0)),e}function yr(e,t){return br(t).map(function(t){return e[t]})}function Er(t,e){var r=yr(t,e);return[St.apply(void 0,r.map(function(t){return t[0]})),St.apply(void 0,r.map(function(t){return t[1]}))]}function xr(t,e){var r=t[0],n=t[1],i=t[2];return Er([t[3],i,n,r],e)}function wr(t,e){return xr([t[0],t[1],t[2],t[3]],e)}function Sr(t,e,r,n,i,a){var o=xr(ze(e,r,n,i),a);return[t[0]-o[0],t[1]-o[1]]}function Mr(t,e,r,n){return xt(t,Se(e,n,r),n)}function Cr(t,e){var r=t.transformOrigin,n=t.offsetMatrix,i=t.is3d?4:3;return Mr(n,xt(t.targetMatrix,zt(e,i),i),r,i)}function Dr(t,e,r,n,i,a){var o=t.props.groupable,s=t.state,u=s.transformOrigin,c=s.targetMatrix,l=s.offsetMatrix,f=s.is3d,p=s.width,h=s.height,d=s.left,v=s.top,g=f?4:3,m=o?d:0,b=o?v:0;return Ct(Sr(i,Mr(l,c,function(t,s,u,c,l,f){return void 0===c&&(c=s),void 0===l&&(l=u),void 0===f&&(f=[0,0]),t?t.map(function(t,e){var r=w(t),n=r.value,i=r.unit,a=e?l:c,o=e?u:s;return"%"===t||isNaN(n)?o*(a?f[e]/a:0):"%"!==i?n:o*n/100}):f}(a,e,r,p,h,u),g),e,r,g,n),[m,b])}function Or(t,e){return wr(We(t.state),e)}function Rr(t){var e=t.state;if(!e.guidelines||!e.guidelines.length){var r=t.props,n=r.horizontalGuidelines,i=void 0===n?[]:n,a=r.verticalGuidelines,o=void 0===a?[]:a,s=r.elementGuidelines,u=void 0===s?[]:s,c=r.bounds,l=r.snapCenter;if(c||i.length||o.length||u.length){var f=e.containerClientRect,p=f.top,h=f.left,d=e.targetClientRect,v=d.top,g=d.left,m=We(e),b=Math.min.apply(Math,m.map(function(t){return t[0]})),y=Math.min.apply(Math,m.map(function(t){return t[1]})),E=He(b-(g-h)),x=He(y-(v-p)),w=[];u.forEach(function(t){var e=t.getBoundingClientRect(),r=e.top,n=e.left,i=e.width,a=e.height,o=r-p,s=o+a,u=n-h,c=u+i;w.push({type:"vertical",element:t,pos:[Ve(u+E,.1),o],size:a}),w.push({type:"vertical",element:t,pos:[Ve(c+E,.1),o],size:a}),w.push({type:"horizontal",element:t,pos:[u,Ve(o+x,.1)],size:i}),w.push({type:"horizontal",element:t,pos:[u,Ve(s+x,.1)],size:i}),l&&(w.push({type:"vertical",element:t,pos:[Ve((u+c)/2+E,.1),o],size:a,center:!0}),w.push({type:"horizontal",element:t,pos:[u,Ve((o+s)/2+x,.1)],size:i,center:!0}))}),e.guidelines=w,e.enableSnap=!0}}}function Pr(t,e,r,n){return{vertical:_r(t,e,!0,n),horizontal:_r(t,r,!1,n)}}function _r(t,e,r,n){void 0===n&&(n=0);var i=t.props.bounds;if(i){var a=i[r?"left":"top"],o=i[r?"right":"bottom"],s=Math.min.apply(Math,e),u=Math.max.apply(Math,e);if(!F(a)&&s<a+n)return{isBound:!0,offset:s-a,pos:a};if(!F(o)&&o-n<u)return{isBound:!0,offset:u-o,pos:o}}return{isBound:!1,offset:0,pos:0}}function zr(e,o,t,s,u,c){if(!e||!e.length)return{isSnap:!1,posInfos:[]};var i="vertical"===o?0:1,r=t.map(function(n){var t=e.map(function(t){var e=t.pos,r=n-e[i];return{offset:r,dist:Math.abs(r),guideline:t}}).filter(function(t){var e=t.guideline,r=t.dist,n=e.type,i=e.center,a=e.element;return!(!c&&a||!u&&i||n!==o||s<r)}).sort(function(t,e){return t.dist-e.dist});return{pos:n,guidelineInfos:t}}).filter(function(t){return 0<t.guidelineInfos.length}).sort(function(t,e){return t.guidelineInfos[0].dist-e.guidelineInfos[0].dist});return{isSnap:0<r.length,posInfos:r}}function Gr(t,e){var r=t.props,n=r.snappable,i=r.bounds,a=r.verticalGuidelines,o=r.horizontalGuidelines,s=t.state,u=s.guidelines,c=s.enableSnap;return!(!n||!c||e&&!0!==n&&n.indexOf(e)<0)&&!!(i||u&&u.length||a&&a.length||o&&o.length)}function Tr(t,e,r,n,i){var a=t.state,o=a.guidelines,s=a.containerClientRect,u=s.height,c=s.width,l=t.props,f=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=t.length-1,n=0;n<r;++n){var i=t[n];if(!F(i))return i}return t[r]}(i,l.snapThreshold,5),p=l.snapElement,h=void 0===p||p,d=l.snapHorizontal,v=void 0===d||d,g=l.snapVertical,m=void 0===g||g,b=l.verticalGuidelines,y=l.horizontalGuidelines,E=o.slice();return v&&y&&y.forEach(function(t){E.push({type:"horizontal",pos:[0,Ve(t,.1)],size:c})}),m&&b&&b.forEach(function(t){E.push({type:"vertical",pos:[Ve(t,.1),0],size:u})}),{vertical:zr(E,"vertical",e,f,n,h),horizontal:zr(E,"horizontal",r,f,n,h)}}function Ar(t,e,r,n){var i=t.props.snapCenter&&r,a=["left","right"],o=["top","bottom"];return i&&(a.push("center"),o.push("middle")),a=a.filter(function(t){return t in e}),o=o.filter(function(t){return t in e}),Tr(t,a.map(function(t){return e[t]}),o.map(function(t){return e[t]}),i,n)}function Br(t,e){var r=Pr(t,[e[0]],[e[1]]),n=r.horizontal,i=n.isBound,a=n.offset,o=r.vertical,s=o.isBound,u=o.offset;if(i||s){var c=void 0,l=(c=i&&s?Math.abs(a)<Math.abs(u):s)?u:a;return{isVertical:c,offset:l,dist:Math.abs(l)}}}function Ir(t,e,r,n,i,a){var o=function(t,e,r,n){var i=e[0]-t[0],a=e[1]-t[1];Math.abs(i)<de&&(i=0);Math.abs(a)<de&&(a=0);if(!i)return n?void 0:[0,r];if(!a)return n?[r,0]:void 0;var o=a/i,s=t[1]-o*t[0];{if(n){var u=o*(e[0]+r)+s;return[r,u-e[1]]}return[(e[1]+r-s)/o-e[0],r]}}(t,e,-r,n);if(!o)return NaN;var s=mr({datas:a,distX:o[0],distY:o[1]}),u=s[0],c=s[1];return i?c:u}function Nr(t,e,r,n,i,a){var o=ze(t,e,r,a?4:3);return Le(o,Ct(n,xr(o,i)))}function kr(t){var e=t.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var r=t.posInfos[0],n=r.guidelineInfos[0],i=n.offset,a=n.dist,o=n.guideline;return{isSnap:e,offset:i,dist:a,pos:r.pos,guideline:o}}function Yr(n,t,i,a,o){var r,s=0,u=-1;if(t.map(function(t){return Br(n,t)}).forEach(function(t,e){t&&(!r||r.dist<t.dist)&&(r=t,u=e)}),r){var e=Ir(i[u],t[u],r.offset,r.isVertical,a,o);isNaN(e)||(s=e)}else t.some(function(t,e){var r=function(t,e,r,n,i){var a,o=Tr(t,[e[0]],[e[1]]),s=o.horizontal,u=o.vertical,c=Math.abs(r[1]-e[1])<de,l=Math.abs(r[0]-e[0])<de,f=kr(s),p=f.isSnap,h=f.dist,d=f.offset,v=kr(u),g=v.isSnap,m=v.dist,b=v.offset;return p||g?Ir(r,e,(a=p&&g?0===h&&c||(0!==b||!l)&&m<h:g)?b:d,a,n,i):NaN}(n,t,i[e],a,o);return!isNaN(r)&&(s=r,!0)});return s}function Xr(t,e,r,n,i,a,o,s){var u=xr(We(t.state),a),c=Nr(e,r,n,u,i,s);return i[0]&&i[1]?function(t,e,r,n,i,a,o,s,u){var c,l=yr(e,r),f=[r[0],-1*r[1]],p=[-1*r[0],r[1]],h=Er(e,f),d=Er(e,p),v=Pr(t,[l[0][0]],[l[0][1]]),g=v.horizontal,m=g.isBound,b=g.offset,y=v.vertical,E=y.isBound,x=y.offset,w=0,S=0,M=Br(t,h),C=Br(t,d),D=M&&M.dist>Math.abs(x),O=C&&C.dist>Math.abs(b);if(D||O)if(D){var R=Ir(Er(e,[-1*f[0],f[1]]),h,M.offset,M.isVertical,!1,n);isNaN(R)||(w=R),S=Yr(t,[Er(P=Nr(i,a+r[0]*w,o+r[1]*S,s,r,u),r)],[Er(P,f)],!0,n)}else{var P;R=Ir(Er(e,[-1*p[0],p[1]]),h,C.offset,C.isVertical,!0,n);isNaN(R)||(S=R),w=Yr(t,[Er(P=Nr(i,a+r[0]*w,o+r[1]*S,s,r,u),r)],[Er(P,p)],!1,n)}else{var _=Tr(t,[l[0][0]],[l[0][1]]),z=_.horizontal,G=_.vertical,T=kr(z).offset,A=kr(G).offset;w=(c=mr({datas:n,distX:-(E?x:A),distY:-(m?b:T)}))[0],S=c[1]}return[r[0]*w,r[1]*S]}(t,c,i,o,e,r,n,u,s):function(t,e,r,n){var i,a,o=0!==r[0]?0:1,s=0<o,u=e.slice().reverse();t.props.keepRatio?(i=[Er(e,r)],a=[Er(u,r)]):(i=yr(e,r),a=yr(u,r),i.push([(i[0][0]+i[1][0])/2,(i[0][1]+i[1][1])/2]),a.reverse(),a.push([(a[0][0]+a[1][0])/2,(a[0][1]+a[1][1])/2]));var c=Yr(t,i,a,s,n),l=[0,0];return l[o]=r[o]*c,l}(t,c,i,o)}function jr(t,e,r){var n=t[0],i=t[1],a=t[2],o=t[3];return[Ot(n,r),Ot(i,r),Ot(a,r),Ot(o,r)].some(function(t){return t[0]<e.left&&Math.abs(t[0]-e.left)>de||t[0]>e.right&&Math.abs(t[0]-e.right)>de||t[1]<e.top&&Math.abs(t[1]-e.top)>de||t[1]>e.bottom&&Math.abs(t[1]-e.bottom)>de})}function Fr(t,e,r,n){var i=t.props.bounds;if(!i||!Gr(t,"resizable"))return n;var a=i.left,o=void 0===a?-1/0:a,s=i.top,u=void 0===s?-1/0:s,c=i.right,l=void 0===c?1/0:c,f=i.bottom,p=void 0===f?1/0:f,h=e.pos1,d=e.pos2,v=e.pos3,g=e.pos4,m=n*Math.PI/180,b=o-r[0],y=l-r[0],E=u-r[1],x=p-r[1],w={left:b,top:E,right:y,bottom:x},S=Ct(h,r),M=Ct(d,r),C=Ct(v,r),D=Ct(g,r),O=[S,M,C,D],R=[Ot(S,m),Ot(M,m),Ot(C,m),Ot(D,m)];if(!jr(R,w,0))return n;var P=[];R.forEach(function(t){t[0]<b&&P.push([t,b,0]),t[0]>y&&P.push([t,y,0]),t[1]<E&&P.push([t,E,1]),t[1]>x&&P.push([t,x,1])});for(var _=P.length,z=function(t){var e=P[t],r=e[0],n=e[1],i=e[2],a=mt([0,0],r),o=function(r,e,n){var t=Be(r),i=Math.sqrt(t*t-e*e);return[i,-i].sort(function(t,e){return Math.abs(t-r[n?0:1])-Math.abs(e-r[n?0:1])}).map(function(t){return mt([0,0],n?[t,e]:[e,t])})}(r,n,i).filter(function(t){return!jr(O,w,m+t-a)});if(o.length)return{value:Ve(180*(m+o[0]-a)/Math.PI,de)}},G=0;G<_;++G){var T=z(G);if("object"==typeof T)return T.value}return n}function Lr(t){var r=[];return t.forEach(function(t){t.guidelineInfos.forEach(function(t){var e=t.guideline;-1<r.indexOf(e)||r.push(e)})}),r}function Wr(t,e,r,n){var i=t-r,a=i<0?i+e:n;return{size:(i<0?0:i)-a,pos:a}}var Hr={name:"snappable",props:{snappable:[Boolean,Array],snapCenter:Boolean,snapHorizontal:Boolean,snapVertical:Boolean,snapElement:Boolean,snapThreshold:Number,horizontalGuidelines:Array,verticalGuidelines:Array,elementGuidelines:Array,bounds:Object},render:function(t,u){var e=t.state,c=e.top,l=e.left,r=e.pos1,n=e.pos2,i=e.pos3,a=e.pos4,o=e.snapRenderInfo,s=e.targetClientRect,f=e.containerClientRect,p=s.left-f.left,h=s.top-f.top,d=Math.min(r[0],n[0],i[0],a[0]),v=Math.min(r[1],n[1],i[1],a[1]);if(!o||!Gr(t,""))return[];var g=t.props.snapThreshold,m=void 0===g?5:g,b=We(t.state),y=Ge(b),E=y.width,x=y.height,w=y.top,S=y.left,M=y.bottom,C=y.right,D=[],O=[],R=[],P=[],_=[];if(o.direction&&_.push(function(t,e,r){if(r[0]||r[1]){i=void 0;return t.props.keepRatio?i=[Er(e,r)]:1<(i=yr(e,r)).length&&i.push([(i[0][0]+i[1][0])/2,(i[0][1]+i[1][1])/2]),Tr(t,i.map(function(t){return t[0]}),i.map(function(t){return t[1]}),!0,1)}for(var n=[e[0],e[1],e[3],e[2],e[0]],i=[],a=0;a<4;++a)i.push(n[a]),e.push([(n[a][0]+n[a+1][0])/2,(n[a][1]+n[a+1][1])/2]);return Tr(t,i.map(function(t){return t[0]}),i.map(function(t){return t[1]}),!0,1)}(t,b,o.direction)),o.snap){var z=Ge(b);o.center&&(z.middle=(z.top+z.bottom)/2,z.center=(z.left+z.right)/2),_.push(Ar(t,z,!0,1))}_.forEach(function(t){var e=t.vertical.posInfos,r=t.horizontal.posInfos;D.push.apply(D,e.map(function(t){return t.pos})),O.push.apply(O,r.map(function(t){return t.pos})),R.push.apply(R,Lr(e)),P.push.apply(P,Lr(r))});var G=Pr(t,[S,C],[w,M],1),T=G.vertical,A=T.isBound,B=T.pos,I=G.horizontal,N=I.isBound,k=I.pos;A&&D.indexOf(B)<0&&D.push(B),N&&O.indexOf(k)<0&&O.push(k);var Y=nr(R.filter(function(t){return t.element}),function(t){var e=t.pos;return Math.min(0,e[1]-h)<0?-e[0]:e[0]}),X=nr(P.filter(function(t){return t.element}),function(t){var e=t.pos;return Math.min(0,e[0]-p)<0?-e[1]:e[1]});return X.forEach(function(t){t.sort(function(t,e){return Wr(t.pos[0],t.size,p,E).size-Wr(e.pos[0],t.size,p,E).size})}),Y.forEach(function(t){t.sort(function(t,e){return Wr(t.pos[1],t.size,h,x).size-Wr(e.pos[1],t.size,h,x).size})}),ir(X.map(function(t,s){return t.map(function(t,e){var r=t.pos,n=t.size,i=Wr(r[0],n,p,E),a=i.pos,o=i.size;return o<m?null:u.createElement("div",{className:Ee("line","horizontal","guideline","dashed"),"data-size":e?"":parseFloat(o.toFixed(4)),key:"horizontalLinkGuidline"+s+"-"+e,style:{left:d+a+"px",top:-c+r[1]+"px",width:o+"px"}})})})).concat(ir(Y.map(function(t,s){return t.map(function(t,e){var r=t.pos,n=t.size,i=Wr(r[1],n,h,x),a=i.pos,o=i.size;return o<m?null:u.createElement("div",{className:Ee("line","vertical","guideline","dashed"),"data-size":e?"":parseFloat(o.toFixed(4)),key:"verticalLinkGuidline"+s+"-"+e,style:{top:a+"px",left:-l+r[0]+"px",height:o+"px"}})})})),D.map(function(t,e){return u.createElement("div",{className:Ee("line","vertical","guideline","target","bold"),key:"verticalTargetGuidline"+e,style:{top:v+"px",left:-l+t+"px",height:x+"px"}})}),O.map(function(t,e){return u.createElement("div",{className:Ee("line","horizontal","guideline","target","bold"),key:"horizontalTargetGuidline"+e,style:{top:-c+t+"px",left:d+"px",width:E+"px"}})}),R.map(function(t,e){var r=t.pos,n=t.size,i=t.element;return u.createElement("div",{className:Ee("line","vertical","guideline",i?"bold":""),key:"verticalGuidline"+e,style:{top:v-h+r[1]+"px",left:-l+r[0]+"px",height:n+"px"}})}),P.map(function(t,e){var r=t.pos,n=t.size,i=t.element;return u.createElement("div",{className:Ee("line","horizontal","guideline",i?"bold":""),key:"horizontalGuidline"+e,style:{top:-c+r[1]+"px",left:d-p+r[0]+"px",width:n+"px"}})}))},dragStart:function(t,e){t.state.snapRenderInfo={snap:!0,center:!0},Rr(t)},pinchStart:function(t){this.unset(t)},dragEnd:function(t){this.unset(t)},dragControlCondition:function(t){return vr(t)||Zr(t)},dragControlStart:function(t,e){t.state.snapRenderInfo=null,Rr(t)},dragControlEnd:function(t){this.unset(t)},dragGroupStart:function(t,e){this.dragStart(t,e)},dragGroupEnd:function(t){this.unset(t)},dragGroupControlStart:function(t,e){t.state.snapRenderInfo=null,Rr(t)},dragGroupControlEnd:function(t){this.unset(t)},unset:function(t){var e=t.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null}},Vr={name:"draggable",props:{draggable:Boolean,throttleDrag:Number,throttleDragRotate:Number},render:function(t,e){var r=t.props.throttleDragRotate,n=t.state,i=n.dragInfo,a=n.beforeOrigin;if(r&&i){var o=i.dist;if(o[0]||o[1]){var s=Be(o),u=mt(o,[0,0]);return e.createElement("div",{className:Ee("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:s+"px",transform:"translate("+a[0]+"px, "+a[1]+"px) rotate("+u+"rad)"}})}}},dragStart:function(t,e){var r=e.datas,n=e.parentEvent,i=e.parentDragger,a=t.state,o=a.targetTransform,s=a.target;if(a.dragger)return!1;a.dragger=i||t.targetDragger;var u=window.getComputedStyle(s);r.datas={},r.left=parseFloat(u.left||"")||0,r.top=parseFloat(u.top||"")||0,r.bottom=parseFloat(u.bottom||"")||0,r.right=parseFloat(u.right||"")||0,r.transform=o,r.startTranslate=[0,0],gr(t,{datas:r}),r.prevDist=[0,0],r.prevBeforeDist=[0,0],r.isDrag=!1,function(t,e){e.absolutePoses=We(t.state)}(t,r);var c=$e(t,e,{set:function(t){r.startTranslate=t}});return!1!==(n||Je(t,"onDragStart",c))?(r.isDrag=!0,t.state.dragInfo={startRect:t.getRect(),dist:[0,0]}):(a.dragger=null,r.isPinch=!1),!!r.isDrag&&c},drag:function(t,e){var r=e.datas,n=e.parentEvent,i=e.parentFlag,a=e.distX,o=e.distY,s=r.isPinch,u=r.isDrag,c=r.prevDist,l=r.prevBeforeDist,f=r.transform,p=r.startTranslate;if(u){var h=t.props,d=h.parentMoveable,v=n?0:h.throttleDrag||0,g=n?0:h.throttleDragRotate||0,m=!1,b=0;if(0<g&&a&&o){var y=Ve(180*mt([0,0],[a,o])/Math.PI,g),E=Be([a,o]);b=y*Math.PI/180,a=E*Math.cos(b),o=E*Math.sin(b)}if(!s&&!n&&!i&&a&&o){var x=function(t,e,r,n){var i={isSnap:!1,isBound:!1,offset:0},a={isSnap:!1,isBound:!1,offset:0};if(!Gr(t,"draggable"))return[i,a];var o=Ge(Le(n.absolutePoses,[e,r])),s=o.left,u=o.right,c=o.top,l=o.bottom,f=Ar(t,{left:s,right:u,top:c,bottom:l,center:(s+u)/2,middle:(c+l)/2},!0),p=Pr(t,[s,u],[c,l]);return p.vertical.isBound?(i.offset=p.vertical.offset,i.isSnap=!0,i.isBound=!0):f.vertical.isSnap&&(i.offset=f.vertical.posInfos[0].guidelineInfos[0].offset,i.isSnap=!0),p.horizontal.isBound?(a.offset=p.horizontal.offset,a.isSnap=!0,a.isBound=!0):f.horizontal.isSnap&&(a.offset=f.horizontal.posInfos[0].guidelineInfos[0].offset,a.isSnap=!0),[i,a]}(t,a,o,r),w=x[0],S=x[1],M=w.isSnap,C=w.isBound,D=w.offset,O=S.isSnap,R=S.isBound,P=S.offset;if(m=M||O,g){var _=[];if(C&&R?_.push([0,P],[D,0]):C?_.push([D,0]):R?_.push([0,P]):M&&O?_.push([0,P],[D,0]):M?_.push([D,0]):O&&_.push([0,P]),_.length){_.sort(function(t,e){return Be(Ct([a,o],t))-Be(Ct([a,o],e))});var z=_[0];if(z[0]&&Math.abs(a)>de){var G=a;a-=z[0],o=o*Math.abs(a)/Math.abs(G)}else if(z[1]&&Math.abs(o)>de){var T=o;o-=z[1],a=a*Math.abs(o)/Math.abs(T)}}}else a-=D,o-=P}r.passDistX=a,r.passDistY=o;var A=Mt(mr({datas:r,distX:a,distY:o},!0),p),B=Mt(mr({datas:r,distX:a,distY:o},!1),p);g||m||(Ue(B,v),Ue(A,v));var I=Ct(A,p),N=Ct(B,p),k=Ct(N,c),Y=Ct(I,l);r.prevDist=N,r.prevBeforeDist=I;var X=r.left+I[0],j=r.top+I[1],F=r.right-I[0],L=r.bottom-I[1],W=f+" translate("+N[0]+"px, "+N[1]+"px)";if(t.state.dragInfo.dist=N,n||d||!k.every(function(t){return!t})||!Y.some(function(t){return!t})){var H=$e(t,e,{transform:W,dist:N,delta:k,translate:B,beforeDist:I,beforeDelta:Y,beforeTranslate:A,left:X,top:j,right:F,bottom:L,isPinch:s});return n||Je(t,"onDrag",H),H}}},dragEnd:function(t,e){var r=e.parentEvent,n=e.datas,i=e.isDrag;if(t.state.dragger=null,t.state.dragInfo=null,n.isDrag)return n.isDrag=!1,r||Je(t,"onDragEnd",$e(t,e,{isDrag:i})),i},dragGroupStart:function(t,e){var r=e.datas,n=this.dragStart(t,e);if(!n)return!1;var i=dr(t,this,"dragStart",r,e),a=Je(t,"onDragGroupStart",oe({},n,{targets:t.props.targets,events:i}));return r.isDrag=!1!==a,!!r.isDrag&&n},dragGroup:function(t,e){var r=e.datas;if(r.isDrag){var n=this.drag(t,e),i=e.datas,a=i.passDistX,o=i.passDistY,s=dr(t,this,"drag",r,oe({},e,{distX:a,distY:o}));if(n){var u=oe({targets:t.props.targets,events:s},n);return Je(t,"onDragGroup",u),u}}},dragGroupEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isDrag)return this.dragEnd(t,e),dr(t,this,"dragEnd",n,e),Je(t,"onDragGroupEnd",$e(t,e,{targets:t.props.targets,isDrag:r})),r},unset:function(t){t.state.dragInfo=null}};function Ur(t,e,r){return oe({},t.dragger.move(e,r),{parentEvent:!0})}var qr=function(){function t(){this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={}}var e=t.prototype;return e.dragStart=function(t,e){return this.isDrag=!1,this.isFlag=!1,this.datas={},this.move(t,e)},e.drag=function(t,e){return this.move([t[0]-this.prevX,t[1]-this.prevY],e)},e.move=function(t,e){var r,n;return this.isFlag?(r=this.prevX+t[0],n=this.prevY+t[1],this.isDrag=!0):(this.prevX=t[0],this.prevY=t[1],this.startX=t[0],this.startY=t[1],r=t[0],n=t[1],this.isFlag=!0),{clientX:this.prevX=r,clientY:this.prevY=n,inputEvent:e,isDrag:this.isDrag,distX:r-this.startX,distY:n-this.startY,deltaX:t[0],deltaY:t[1],datas:this.datas,parentEvent:!0,parentDragger:this}},t}();function Kr(t,e,r,n,i){t.startAbsoluteOrigin=[i.left+n[0],i.top+n[1]],t.prevDeg=mt(t.startAbsoluteOrigin,[e,r])/Math.PI*180,t.startDeg=t.prevDeg,t.loop=0}function $r(t,e,r,n,i,a,o,s){var u=r.prevDeg,c=r.startDeg,l=r.loop;n<u&&270<u&&n<90?++r.loop:u<n&&u<90&&270<n&&--r.loop;var f=r.loop,p=360*l+u-c+a,h=360*f+n-c+a,d=i*((h=Ve(h,o))-a);s&&(h=(d=Fr(t,e,r.origin,d))/i+a);var v=i*(h-p);return r.prevDeg=h-360*f+c-a,[v,d,h]}function Jr(t,e,r,n,i,a,o,s){return $r(t,e,r,mt(r.startAbsoluteOrigin,[i,a])/Math.PI*180,n,o,s,!0)}function Zr(t){return v(t,Ee("rotation"))}var Qr={name:"rotatable",canPinch:!0,props:{rotatable:Boolean,rotationPosition:String,throttleRotate:Number},render:function(t,e){var r=t.props,n=r.rotatable,i=r.rotationPosition;if(!n)return null;var a=t.state,o=a.pos1,s=a.pos2,u=a.pos3,c=a.pos4,l=a.direction,f=function(t,e,r,n,i){return"left"===t?[n,e]:"right"===t?[r,i]:"bottom"===t?[i,n]:[e,r]}(i,o,s,u,c),p=Ye(f,l);return e.createElement("div",{key:"rotation",className:Ee("line rotation-line"),style:{transform:"translate("+(f[0][0]+f[1][0])/2+"px, "+(f[0][1]+f[1][1])/2+"px) rotate("+p+"rad)"}},e.createElement("div",{className:Ee("control","rotation")}))},dragControlCondition:Zr,dragControlStart:function(t,e){var r=e.datas,n=e.clientX,i=e.clientY,a=e.parentRotate,o=e.parentFlag,s=e.pinchFlag,u=t.state,c=u.target,l=u.left,f=u.top,p=u.origin,h=u.beforeOrigin,d=u.direction,v=u.beforeDirection,g=u.targetTransform;if(!c)return!1;if(r.rect=t.getRect(),r.transform=g,r.left=l,r.top=f,s||o)r.beforeInfo={prevDeg:a,startDeg:a,loop:0},r.afterInfo={prevDeg:a,startDeg:a,loop:0};else{r.beforeInfo={origin:Mt([l,f],h)},r.afterInfo={origin:Mt([l,f],p)};var m=je(t.controlBox.getElement());Kr(r.afterInfo,n,i,p,m),Kr(r.beforeInfo,n,i,h,m)}r.direction=d,r.beforeDirection=v,r.startRotate=0,r.datas={};var b=$e(t,e,{set:function(t){r.startRotate=t}}),y=Je(t,"onRotateStart",b);return r.isRotate=!1!==y,t.state.snapRenderInfo={},!!r.isRotate&&b},dragControl:function(t,e){var r,n,i,a,o=e.datas,s=e.clientX,u=e.clientY,c=e.parentRotate,l=e.parentFlag,f=e.pinchFlag,p=o.direction,h=o.beforeDirection,d=o.beforeInfo,v=o.afterInfo,g=o.isRotate,m=o.startRotate,b=o.rect;if(g){var y,E,x,w,S,M,C=t.props,D=C.throttleRotate,O=void 0===D?0:D,R=C.parentMoveable;if(M=f||l?(y=(r=$r(t,b,v,c,p,m,O))[0],E=r[1],x=r[2],w=(n=$r(t,b,d,c,p,m,O))[0],S=n[1],n[2]):(y=(i=Jr(t,b,v,p,s,u,m,O))[0],E=i[1],x=i[2],w=(a=Jr(t,b,d,h,s,u,m,O))[0],S=a[1],a[2]),y||w||R){var P=$e(t,e,{delta:y,dist:E,rotate:x,beforeDist:S,beforeDelta:w,beforeRotate:M,transform:o.transform+" rotate("+E+"deg)",isPinch:!!f});return Je(t,"onRotate",P),P}}},dragControlEnd:function(t,e){var r=e.datas,n=e.isDrag;return!!r.isRotate&&(r.isRotate=!1,Je(t,"onRotateEnd",$e(t,e,{isDrag:n})),n)},dragGroupControlCondition:Zr,dragGroupControlStart:function(t,e){var r=e.datas,u=e.inputEvent,n=t.state,c=n.left,l=n.top,f=n.beforeOrigin,i=this.dragControlStart(t,e);if(!i)return!1;i.set(t.rotation);var a=dr(t,this,"dragControlStart",r,oe({},e,{parentRotate:0}),function(t,e,r){var n=t.state,i=n.left,a=n.top,o=n.beforeOrigin,s=Mt(Ct([i,a],[c,l]),Ct(o,f));e.prevClient=s,r.dragStart=Vr.dragStart(t,(new qr).dragStart(s,u))}),o=Je(t,"onRotateGroupStart",oe({},i,{targets:t.props.targets,events:a}));return r.isRotate=!1!==o,!!r.isRotate&&i},dragGroupControl:function(e,t){var p=t.inputEvent,r=t.datas;if(r.isRotate){var n=this.dragControl(e,t);if(n){var i=n.beforeDist,h=n.beforeDelta/180*Math.PI,a=dr(e,this,"dragControl",r,oe({},t,{parentRotate:i}),function(t,e,r,n){var i=e.prevClient,a=i[0],o=i[1],s=Ot([a,o],h),u=s[0],c=s[1],l=[u-a,c-o];e.prevClient=[u,c];var f=Vr.drag(t,Ur(t.state,l,p));r.drag=f});e.rotation=n.beforeRotate;var o=oe({targets:e.props.targets,events:a,set:function(t){e.rotation=t}},n);return Je(e,"onRotateGroup",o),o}}},dragGroupControlEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isRotate)return this.dragControlEnd(t,e),dr(t,this,"dragControlEnd",n,e),Je(t,"onRotateGroupEnd",$e(t,e,{targets:t.props.targets,isDrag:r})),r}};function tn(t,e,n){var r=t.state,i=r.pos1,a=r.pos2,o=r.pos3,s=r.pos4,u=r.rotation,c=t.props.renderDirections,l=void 0===c?e:c,f=[i,a,o,s],p={};return l.forEach(function(t){p[t]=!0}),l.map(function(t){var e=me[t];if(!e||!p[t])return null;var r=(Ve(u/Math.PI*180,15)+be[t])%180;return n.createElement("div",{className:Ee("control","direction",t),"data-rotation":r,"data-direction":t,key:"direction-"+t,style:Ne.apply(void 0,[u].concat(e.map(function(t){return f[t]})))})})}function en(t,e){return tn(t,["nw","ne","sw","se","n","w","s","e"],e)}function rn(t,e){return tn(t,["nw","ne","sw","se"],e)}var nn={name:"resizable",ableGroup:"size",updateRect:!0,canPinch:!0,props:{resizable:Boolean,throttleResize:Number,renderDirections:Array,baseDirection:Array,keepRatio:Boolean},render:function(t,e){var r=t.props,n=r.resizable,i=r.edge;if(n)return i?rn(t,e):en(t,e)},dragControlCondition:vr,dragControlStart:function(t,e){var r,n=e.inputEvent,i=e.pinchFlag,a=e.datas,o=n.target,s=i?[1,1]:Fe(o),u=t.state,c=u.target,l=u.width,f=u.height;if(!s||!c)return!1;i||gr(t,{datas:a}),a.datas={},a.direction=s,a.startOffsetWidth=l,a.startOffsetHeight=f,a.prevWidth=0,a.prevHeight=0,r=function(t){var e=window.getComputedStyle(t);return[parseFloat(e.width),parseFloat(e.height)]}(c),a.startWidth=r[0],a.startHeight=r[1],a.transformOrigin=t.props.transformOrigin,a.startDirection=function(t,e){var r=t.props.baseDirection,n=void 0===r?[-1,-1]:r;return[e[0]?e[0]:-1*n[0],e[1]?e[1]:-1*n[1]]}(t,s),a.fixedPosition=Or(t,a.startDirection),a.fixedOriginalPosition=Or(t,s);var p=$e(t,e,{direction:s,set:function(t){var e=t[0],r=t[1];a.startWidth=e,a.startHeight=r},setOrigin:function(t){a.transformOrigin=t},dragStart:Vr.dragStart(t,(new qr).dragStart([0,0],n))});return!1!==Je(t,"onResizeStart",p)&&(a.isResize=!0,t.state.snapRenderInfo={direction:s}),!!a.isResize&&p},dragControl:function(t,e){var r=e.datas,n=e.distX,i=e.distY,a=e.parentFlag,o=e.pinchFlag,s=e.parentDistance,u=e.parentScale,c=e.inputEvent,l=e.parentKeepRatio,f=e.dragClient,p=r.direction,h=r.isResize,d=r.transformOrigin;if(h){var v=r.startWidth,g=r.startHeight,m=r.startOffsetWidth,b=r.startOffsetHeight,y=r.prevWidth,E=r.prevHeight,x=t.props,w=x.throttleResize,S=void 0===w?0:w,M=x.parentMoveable,C=t.props.keepRatio||l,D=p[0]||!p[1],O=D?b/m:m/b,R=0,P=0;if(u)R=(u[0]-1)*m,P=(u[1]-1)*b;else if(o)s&&(P=(R=s)*b/m);else{var _=mr({datas:r,distX:n,distY:i});if(R=p[0]*_[0],P=p[1]*_[1],C&&m&&b){var z=mt([0,0],_),G=mt([0,0],p),T=mt([0,0],[m,b]),A=Be([R,P]),B=Math.cos(z-G)*A;p[0]?P=p[1]?(R=Math.cos(T)*B,Math.sin(T)*B):tr(R=B,D,O):R=er(P=B,D,O)}}var I=p[0]||C?Math.max(m+R,0):m,N=p[1]||C?Math.max(b+P,0):b,k=[0,0];if(o||(k=function(t,e,r,n,i){if(!Gr(t,"resizable"))return[0,0];var a=t.state;return Xr(t,a.matrix,e,r,n,n,i,a.is3d)}(t,I,N,p,r)),C){p[0]&&p[1]&&k[0]&&k[1]&&(Math.abs(k[0])>Math.abs(k[1])?k[1]=0:k[0]=0);var Y=!k[0]&&!k[1];Y&&(D?I=Ve(I,S):N=Ve(N,S)),p[0]&&!p[1]||k[0]&&!k[1]||Y&&D?N=tr(I+=k[0],D,O):(!p[0]&&p[1]||!k[0]&&k[1]||Y&&!D)&&(I=er(N+=k[1],D,O))}else I+=k[0],N+=k[1],k[0]||(I=Ve(I,S)),k[1]||(N=Ve(N,S));var X=[(R=(I=Math.round(I))-m)-y,(P=(N=Math.round(N))-b)-E];if(r.prevWidth=R,r.prevHeight=P,M||!X.every(function(t){return!t})){var j=C||a?p:r.startDirection,F=f||(C?r.fixedOriginalPosition:r.fixedPosition),L=!a&&o?[0,0]:Dr(t,I,N,j,F,d),W=$e(t,e,{width:v+R,height:g+P,offsetWidth:I,offsetHeight:N,direction:p,dist:[R,P],delta:X,isPinch:!!o,drag:Vr.drag(t,Ur(t.state,L,c))});return Je(t,"onResize",W),W}}},dragControlAfter:function(t,e){var r=e.datas,n=r.isResize,i=r.startOffsetWidth,a=r.startOffsetHeight,o=r.prevWidth,s=r.prevHeight;if(n){var u=t.state,c=u.width-(i+o),l=u.height-(a+s),f=3<Math.abs(c),p=3<Math.abs(l);return f&&(r.startWidth+=c,r.startOffsetWidth+=c,r.prevWidth+=c),p&&(r.startHeight+=l,r.startOffsetHeight+=l,r.prevHeight+=l),f||p?(this.dragControl(t,e),!0):void 0}},dragControlEnd:function(t,e){var r=e.datas,n=e.isDrag;return!!r.isResize&&(r.isResize=!1,Je(t,"onResizeEnd",$e(t,e,{isDrag:n})),n)},dragGroupControlCondition:vr,dragGroupControlStart:function(o,s){var t=s.datas,e=this.dragControlStart(o,s);if(!e)return!1;var u=e.direction,c=xr(We(o.state),u),r=dr(o,this,"dragControlStart",t,function(t,e){var r=xr(We(t.state),u),n=Dt(Pt(-o.rotation/180*Math.PI,3),[r[0]-c[0],r[1]-c[1],1],3),i=n[0],a=n[1];return e.originalX=i,e.originalY=a,s}),n=oe({},e,{targets:o.props.targets,events:r}),i=Je(o,"onResizeGroupStart",n);return t.isResize=!1!==i,!!t.isResize&&e},dragGroupControl:function(a,o){var t=o.datas;if(t.isResize){var e=this.dragControl(a,o);if(e){var r=e.offsetWidth,n=e.offsetHeight,i=e.dist,s=a.props.keepRatio,u=[r/(r-i[0]),n/(n-i[1])],c=t.fixedOriginalPosition,l=dr(a,this,"dragControl",t,function(t,e){var r=Dt(Pt(a.rotation/180*Math.PI,3),[e.originalX*u[0],e.originalY*u[1],1],3),n=r[0],i=r[1];return oe({},o,{parentScale:u,dragClient:Mt(c,[n,i]),parentKeepRatio:s})}),f=oe({targets:a.props.targets,events:l},e);return Je(a,"onResizeGroup",f),f}}},dragGroupControlEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isResize)return this.dragControlEnd(t,e),dr(t,this,"dragControlEnd",n,e),Je(t,"onResizeGroupEnd",$e(t,e,{targets:t.props.targets,isDrag:r})),r}},an={name:"scalable",ableGroup:"size",canPinch:!0,props:{scalable:Boolean,throttleScale:Number,renderDirections:String,keepRatio:Boolean},render:function(t,e){var r=t.props,n=r.resizable,i=r.scalable,a=r.edge;if(!n&&i)return a?rn(t,e):en(t,e)},dragControlCondition:vr,dragControlStart:function(t,e){var r=e.datas,n=e.pinchFlag,i=e.inputEvent,a=i.target,o=n?[1,1]:Fe(a),s=t.state,u=s.width,c=s.height,l=s.targetTransform,f=s.target;if(!o||!f)return!1;n||gr(t,{datas:r}),r.datas={},r.transform=l,r.prevDist=[1,1],r.direction=o,r.width=u,r.height=c,r.startScale=[1,1];var p=$e(t,e,{direction:o,set:function(t){r.startScale=t},dragStart:Vr.dragStart(t,(new qr).dragStart([0,0],i))});return!1!==Je(t,"onScaleStart",p)&&(r.isScale=!0,t.state.snapRenderInfo={direction:o}),!!r.isScale&&p},dragControl:function(t,e){var r=e.datas,n=e.distX,i=e.distY,a=e.parentScale,o=e.parentDistance,s=e.parentKeepRatio,u=e.parentFlag,c=e.pinchFlag,l=e.inputEvent,f=e.dragClient,p=r.prevDist,h=r.direction,d=r.width,v=r.height,g=r.transform,m=r.isScale,b=r.startScale;if(!m)return!1;var y=t.props,E=y.throttleScale,x=y.parentMoveable,w=t.props.keepRatio||s,S=t.state,M=h[0]||!h[1],C=1,D=1,O=d*b[0],R=v*b[1],P=M?R/O:O/R;if(a)C=a[0],D=a[1];else if(c)o&&(C=(d+o)/d,D=(v+o*v/d)/v);else{var _=mr({datas:r,distX:n,distY:i}),z=h[0]*_[0],G=h[1]*_[1];if(w&&d&&v){var T=mt([0,0],_),A=mt([0,0],h),B=mt([0,0],[O,R]),I=Be([z,G]),N=Math.cos(T-A)*I;h[0]?G=h[1]?(z=Math.cos(B)*N,Math.sin(B)*N):tr(z=N,M,P):z=er(G=N,M,P)}C=(d+z)/d,D=(v+G)/v}C=h[0]?C*b[0]:b[0],D=h[1]?D*b[1]:b[1],0===C&&(C=1e-9*(0<p[0]?1:-1)),0===D&&(D=1e-9*(0<p[1]?1:-1));var k,Y=[C/b[0],D/b[1]],X=h;if(t.props.groupable){X=[(0<=Y[0]?1:-1)*h[0],(0<=Y[1]?1:-1)*h[1]];var j=(S.snapRenderInfo||{}).direction;K(j)&&(j[0]||j[1])&&(S.snapRenderInfo={direction:h})}var F=[0,0];if(c||(F=function(t,e,r,n,i){var a=i.width,o=i.height;if(!Gr(t,"scalable"))return[0,0];var s=Xr(t,Cr(i,e),a,o,r,n,i,i.is3d);return[s[0]/a,s[1]/o]}(t,Y,h,X,r)),w){h[0]&&h[1]&&F[0]&&F[1]&&(Math.abs(F[0])>Math.abs(F[1])?F[1]=0:F[0]=0);var L=!F[0]&&!F[1];if(L&&(M?Y[0]=Ve(Y[0]*b[0],E)/b[0]:Y[1]=Ve(Y[1]*b[1],E)/b[1]),h[0]&&!h[1]||F[0]&&!F[1]||L&&M){Y[0]+=F[0];var W=tr(d*Y[0]*b[0],M,P);Y[1]=W/v/b[1]}else if(!h[0]&&h[1]||!F[0]&&F[1]||L&&!M){Y[1]+=F[1];var H=er(v*Y[1]*b[1],M,P);Y[0]=H/d/b[0]}}else Y[0]+=F[0],Y[1]+=F[1],F[0]||(Y[0]=Ve(Y[0]*b[0],E)/b[0]),F[1]||(Y[1]=Ve(Y[1]*b[1],E)/b[1]);0===Y[0]&&(Y[0]=1e-9*(0<p[0]?1:-1)),0===Y[1]&&(Y[1]=1e-9*(0<p[1]?1:-1));var V=[Y[0]/p[0],Y[1]/p[1]];if(k=ye(Y,b),r.prevDist=Y,C===p[0]&&D===p[1]&&!x)return!1;var U=!u&&c?[0,0]:function(t,e,r,n){var i=t.state,a=i.is3d,o=i.left,s=i.top,u=i.width,c=i.height,l=a?4:3,f=t.props.groupable,p=Cr(t.state,e),h=f?o:0,d=f?s:0;return Ct(Sr(n||wr(We(t.state),r),p,u,c,l,r),[h,d])}(t,V,h,f),q=$e(t,e,{scale:k,direction:h,dist:Y,delta:V,transform:g+" scale("+C+", "+D+")",isPinch:!!c,drag:Vr.drag(t,Ur(t.state,U,l))});return Je(t,"onScale",q),q},dragControlEnd:function(t,e){var r=e.datas,n=e.isDrag;return!!r.isScale&&(r.isScale=!1,Je(t,"onScaleEnd",$e(t,e,{isDrag:n})),n)},dragGroupControlCondition:vr,dragGroupControlStart:function(o,s){var t=s.datas,e=this.dragControlStart(o,s);if(!e)return!1;var u=e.direction,c=xr(We(o.state),u),r=dr(o,this,"dragControlStart",t,function(t,e){var r=xr(We(t.state),u),n=Dt(Pt(-o.rotation/180*Math.PI,3),[r[0]-c[0],r[1]-c[1],1],3),i=n[0],a=n[1];return e.originalX=i,e.originalY=a,s}),n=oe({},e,{targets:o.props.targets,events:r}),i=Je(o,"onScaleGroupStart",n);return t.isScale=!1!==i,!!t.isScale&&n},dragGroupControl:function(a,o){var t=o.datas;if(t.isScale){var e=this.dragControl(a,o);if(e){var s=a.props.keepRatio,u=e.scale,r=e.direction,n=e.dist,c=xr(We(a.state),ye(r,n)),i=dr(a,this,"dragControl",t,function(t,e){var r=Dt(Pt(a.rotation/180*Math.PI,3),[e.originalX*u[0],e.originalY*u[1],1],3),n=r[0],i=r[1];return oe({},o,{parentScale:u,parentKeepRatio:s,dragClient:Mt(c,[n,i])})}),l=oe({targets:a.props.targets,events:i},e);return Je(a,"onScaleGroup",l),l}}},dragGroupControlEnd:function(t,e){var r=e.isDrag,n=e.datas;if(n.isScale)return this.dragControlEnd(t,e),dr(t,this,"dragControlEnd",n,e),Je(t,"onScaleGroupEnd",$e(t,e,{targets:t.props.targets,isDrag:r})),r}};function on(t,r){return t.map(function(t,e){return function(t,e,r,n){return(t*n+e*r)/(r+n)}(t,r[e],1,2)})}function sn(t,e,r){var n=mt(t,e),i=mt(t,r)-n;return 0<=i?i:i+2*Math.PI}var un={name:"warpable",ableGroup:"size",props:{warpable:Boolean,renderDirections:Array},render:function(t,e){var r=t.props,n=r.resizable,i=r.scalable,a=r.warpable;if(!n&&!i&&a){var o=t.state,s=o.pos1,u=o.pos2,c=o.pos3,l=o.pos4,f=on(s,u),p=on(u,s),h=on(s,c),d=on(c,s),v=on(c,l),g=on(l,c),m=on(u,l),b=on(l,u);return[e.createElement("div",{className:Ee("line"),key:"middeLine1",style:Ie(f,v)}),e.createElement("div",{className:Ee("line"),key:"middeLine2",style:Ie(p,g)}),e.createElement("div",{className:Ee("line"),key:"middeLine3",style:Ie(h,m)}),e.createElement("div",{className:Ee("line"),key:"middeLine4",style:Ie(d,b)})].concat(en(t,e))}},dragControlCondition:function(t){return v(t,Ee("direction"))},dragControlStart:function(t,e){var n=e.datas,r=e.inputEvent,i=t.props.target,a=Fe(r.target);if(!a||!i)return!1;var o=t.state,s=o.transformOrigin,u=o.is3d,c=o.targetTransform,l=o.targetMatrix,f=o.width,p=o.height,h=o.left,d=o.top;return n.datas={},n.targetTransform=c,n.warpTargetMatrix=u?l:yt(l,3,4),n.targetInverseMatrix=function(t,e,r){void 0===r&&(r=Math.sqrt(t.length));for(var n=t.slice(),i=0;i<r;++i)n[i*r+e-1]=0,n[(e-1)*r+i]=0;return n[(e-1)*(r+1)]=1,n}(vt(n.warpTargetMatrix,4),3,4),n.direction=a,n.left=h,n.top=d,gr(t,{datas:n}),n.poses=[[0,0],[f,0],[0,p],[f,p]].map(function(t,e){return Ct(t,s)}),n.nextPoses=n.poses.map(function(t){var e=t[0],r=t[1];return Dt(n.warpTargetMatrix,[e,r,0,1],4)}),n.startMatrix=_t(4),n.prevMatrix=_t(4),n.absolutePoses=We(o),n.posIndexes=br(a),!(o.snapRenderInfo={direction:a})!==Je(t,"onWarpStart",$e(t,e,{set:function(t){n.startMatrix=t}}))&&(n.isWarp=!0),n.isWarp},dragControl:function(t,e){var r=e.datas,n=e.distX,i=e.distY,a=r.targetInverseMatrix,o=r.prevMatrix,s=r.isWarp,u=r.startMatrix,c=r.poses,l=r.posIndexes,f=r.absolutePoses;if(!s)return!1;if(Gr(t,"warpable")){var p=l.map(function(t){return f[t]});1<p.length&&p.push([(p[0][0]+p[1][0])/2,(p[0][1]+p[1][1])/2]);var h=Tr(t,p.map(function(t){return t[0]+n}),p.map(function(t){return t[1]+i})),d=h.horizontal,v=h.vertical;i-=kr(d).offset,n-=kr(v).offset}var g=mr({datas:r,distX:n,distY:i},!0),m=r.nextPoses.slice();if(l.forEach(function(t){m[t]=Mt(m[t],g)}),!he.every(function(t){return function(t,e){var r=sn(t[0],t[1],t[2]),n=sn(e[0],e[1],e[2]),i=Math.PI;return!(i<=r&&n<=i||r<=i&&i<=n)}(t.map(function(t){return c[t]}),t.map(function(t){return m[t]}))}))return!1;var b=Tt(c[0],c[1],c[2],c[3],m[0],m[1],m[2],m[3]);if(!b.length)return!1;var y=Rt(xt(a,b,4)),E=r.targetTransform+" matrix3d("+y.join(",")+")";return Je(t,"onWarp",$e(t,e,{delta:wt(vt(o,4),y,4),matrix:wt(u,r.prevMatrix=y,4),multiply:wt,dist:y,transform:E})),!0},dragControlEnd:function(t,e){var r=e.datas,n=e.isDrag;return!!r.isWarp&&(r.isWarp=!1,Je(t,"onWarpEnd",$e(t,e,{isDrag:n})),n)}},cn=Ee("area"),ln=Ee("area-pieces"),fn=Ee("area-piece"),pn=Ee("avoid");function hn(t){var e=t.areaElement,r=t.state,n=r.width,i=r.height;!function(t,e){if(t.classList)t.classList.remove(e);else{var r=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(r," ")}}(e,pn),e.style.cssText+="left: 0px; top: 0px; width: "+n+"px; height: "+i+"px"}function dn(t){return t.createElement("div",{key:"area_pieces",className:ln},t.createElement("div",{className:fn}),t.createElement("div",{className:fn}),t.createElement("div",{className:fn}),t.createElement("div",{className:fn}))}var vn={name:"dragArea",props:{dragArea:Boolean},render:function(t,e){var r=t.props,n=r.target,i=r.dragArea,a=r.groupable,o=t.state,s=o.width,u=o.height,c=o.pos1,l=o.pos2,f=o.pos3,p=o.pos4;if(a)return[e.createElement("div",{key:"area",ref:J(t,"areaElement"),className:cn}),dn(e)];if(!n||!i)return[];var h=Tt([0,0],[s,0],[0,u],[s,u],c,l,f,p),d=h.length?"matrix3d("+Rt(h).join(",")+")":"none";return[e.createElement("div",{key:"area",ref:J(t,"areaElement"),className:cn,style:{top:"0px",left:"0px",width:s+"px",height:u+"px",transformOrigin:"0 0",transform:d}}),dn(e)]},dragStart:function(t,e){var r=e.datas,n=e.clientX,i=e.clientY,a=e.inputEvent;r.isDragArea=!1,r.inputTarget=a.target;var o=t.areaElement,s=t.state,u=s.targetClientRect,c=s.pos1,l=s.pos2,f=s.pos3,p=s.pos4,h=u.left,d=u.top,v=u.width,g=u.height,m=Ge([c,l,f,p]),b=m.left,y=m.top,E=n-h,x=i-d,w=[{left:b,top:y,width:v,height:x-10},{left:b,top:y,width:E-10,height:g},{left:b,top:y+x+10,width:v,height:g-x-10},{left:b+E+10,top:y,width:v-E-10,height:g}],S=[].slice.call(o.nextElementSibling.children);w.forEach(function(t,e){S[e].style.cssText="left: "+t.left+"px;top: "+t.top+"px; width: "+t.width+"px; height: "+t.height+"px;"}),function(t,e){t.classList?t.classList.add(e):t.className+=" "+e}(o,pn)},drag:function(t,e){var r=e.datas;r.isDragArea||(r.isDragArea=!0,hn(t))},dragEnd:function(t,e){var r=e.inputEvent,n=e.isDragArea;e.datas.isDragArea||hn(t);var i=t.state.target,a=r.target;if(!n&&!t.isMoveableElement(a)){var o=i.contains(a);Je(t,"onClick",$e(t,e,{inputTarget:a,isTarget:i===a,containsTarget:o}))}},dragGroupStart:function(t,e){this.dragStart(t,e)},dragGroup:function(t,e){this.drag(t,e)},dragGroupEnd:function(t,e){var r=e.inputEvent,n=e.isDragArea,i=e.datas;n||hn(t);var a=i.inputTarget,o=r.target;if(!n&&!t.isMoveableElement(o)&&a!==o){var s=t.props.targets,u=s.indexOf(o),c=-1<u,l=!1;-1===u&&(l=-1<(u=function(t,e,r){void 0===r&&(r=-1);for(var n=t.length,i=0;i<n;++i)if(e(t[i],i,t))return i;return r}(s,function(t){return t.contains(o)}))),Je(t,"onClickGroup",$e(t,e,{targets:s,inputTarget:o,targetIndex:u,isTarget:c,containsTarget:l}))}}},gn={name:"origin",props:{origin:Boolean},render:function(t,e){if(!t.props.origin)return null;var r=t.state,n=r.beforeOrigin,i=r.rotation;return[e.createElement("div",{className:Ee("control","origin"),style:Ne(i,n),key:"beforeOrigin"})]}};function mn(t){var e=t.scrollContainer;return[e.scrollLeft,e.scrollTop]}var bn={name:"scrollable",canPinch:!0,props:{scrollable:Boolean,scrollContainer:Object,scrollThreshold:Number},dragStart:function(a,o){var t=a.props.scrollContainer,e=void 0===t?a.getContainer():t,r=new Qt;o.datas.dragScroll=r;var s=o.targets;r.on("scroll",function(t){var e=t.container,r=t.direction,n=$e(a,o,{scrollContainer:e,direction:r}),i=s?"onScrollGroup":"onScroll";s&&(n.targets=s),Je(a,i,n)}).on("move",function(t){var e=t.offsetX,r=t.offsetY;a.targetDragger.scrollBy(e,r,o.inputEvent,!1)}),r.dragStart(o,{container:e})},checkScroll:function(t,e){var r=e.datas.dragScroll;if(r){var n=t.props,i=n.scrollContainer,a=void 0===i?t.getContainer():i,o=n.scrollThreshold,s=void 0===o?0:o,u=n.getScrollPosition,c=void 0===u?mn:u;return r.drag(e,{container:a,threshold:s,getScrollPosition:function(t){return c({scrollContainer:t.container,direction:t.direction})}}),!0}},drag:function(t,e){return this.checkScroll(t,e)},dragEnd:function(t,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragGroupStart:function(t,e){this.dragStart(t,e)},dragGroup:function(t,e){return this.drag(t,oe({},e,{targets:t.props.targets}))},dragGroupEnd:function(t,e){this.dragEnd(t,e)}},yn=[{name:"",props:{target:Object,container:Object,dragArea:Boolean,origin:Boolean,transformOrigin:Array,edge:Boolean,ables:Array,className:String,pinchThreshold:Number}},Hr,hr,Vr,Qr,nn,an,un,bn,vn,gn],En={name:"groupable",props:{defaultGroupRotate:Number,groupable:Boolean},render:function(r,n){var t=r.props.targets||[];r.moveables=[];var e=r.state,i={left:e.left,top:e.top};return t.map(function(t,e){return n.createElement(fr,{key:"moveable"+e,ref:function(e,r,n){return function(t){t&&(e[r][n]=t)}}(r,"moveables",e),target:t,origin:!1,parentMoveable:r,parentPosition:i})})}};function xn(t,a){return Math.max.apply(Math,t.map(function(t){var e=t[0],r=t[1],n=t[2],i=t[3];return Math.max(e[a],r[a],n[a],i[a])}))}function wn(t,a){return Math.min.apply(Math,t.map(function(t){var e=t[0],r=t[1],n=t[2],i=t[3];return Math.min(e[a],r[a],n[a],i[a])}))}var Sn=function(r){function t(){var t=null!==r&&r.apply(this,arguments)||this;return t.differ=new ne,t.moveables=[],t.rotation=0,t}ae(t,r);var e=t.prototype;return e.updateEvent=function(t){var e=this.state,r=this.props;e.target||(e.target=this.areaElement,this.controlBox.getElement().style.display="block",this.targetDragger=or(this,e.target,"targetAbles","Group"),this.controlDragger=or(this,this.controlBox.getElement(),"controlAbles","GroupControl"));var n=!rr(t.container,r.container);n&&(e.container=r.container);var i=this.differ.update(r.targets),a=i.added,o=i.changed,s=i.removed;(n||a.length||o.length||s.length)&&this.updateRect()},e.checkUpdate=function(){this.updateAbles()},e.updateRect=function(e,t,r){var n;if(void 0===r&&(r=!0),this.controlBox){this.moveables.forEach(function(t){t.updateRect(e,!1,!1)});var i=this.state,a=this.props,o=i.target||a.target;(!t||""!==e&&a.updateGroup)&&(this.rotation=a.defaultGroupRotate);var s=this.rotation,u=function(t,e){if(!t.length)return[0,0,0,0];var r=t.map(function(t){return We(t.state)}),i=ve,a=ve,n=0,o=0,s=Ve(e,de);if(s%90){var u=e/180*Math.PI,c=Math.tan(u),l=-1/c,f=[ge,ve],p=[ge,ve];r.forEach(function(t){t.forEach(function(t){var e=t[1]-c*t[0],r=t[1]-l*t[0];f[0]=Math.max(f[0],e),f[1]=Math.min(f[1],e),p[0]=Math.max(p[0],r),p[1]=Math.min(p[1],r)})}),f.forEach(function(n){p.forEach(function(t){var e=(t-n)/(c-l),r=c*e+n;i=Math.min(i,e),a=Math.min(a,r)})});var h=r.map(function(t){var e=t[0],r=t[1],n=t[2],i=t[3];return[Ot(e,-u),Ot(r,-u),Ot(n,-u),Ot(i,-u)]});n=xn(h,0)-wn(h,0),o=xn(h,1)-wn(h,1)}else if(i=wn(r,0),a=wn(r,1),n=xn(r,0)-i,o=xn(r,1)-a,s%180){var d=n;n=o,o=d}return[i,a,n,o]}(this.moveables,s),c=u[0],l=u[1],f=u[2],p=u[3];o.style.cssText+="left:0px;top:0px;width:"+f+"px; height:"+p+"px;transform:rotate("+s+"deg)",i.width=f,i.height=p;var h=Xe(o,this.controlBox.getElement(),this.getContainer(),i),d=[h.left,h.top];n=We(h),h.pos1=n[0],h.pos2=n[1],h.pos3=n[2],h.pos4=n[3],h.origin=Mt(d,h.origin),h.beforeOrigin=Mt(d,h.beforeOrigin);var v=h.targetClientRect;v.top+=l-h.top-i.top,v.left+=c-h.left-i.left,this.updateState(oe({},h,{left:c-h.left,top:l-h.top}),r)}},e.triggerEvent=function(t,e){if(-1<t.indexOf("Group"))return r.prototype.triggerEvent.call(this,t,e)},e.updateAbles=function(){r.prototype.updateAbles.call(this,this.props.ables.concat([En]),"Group")},t.defaultProps=oe({},fr.defaultProps,{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0}),t}(fr),Mn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}ae(e,t);var r=e.prototype;return r.render=function(){var t=this.props.ables||[],e=this.props.target||this.props.targets,r=K(e);if(r&&1<e.length){var n=oe({},this.props,{target:null,targets:e,ables:yn.concat([En],t)});return A(Sn,oe({key:"group",ref:J(this,"moveable")},n))}var i=r?e[0]:e;return A(fr,oe({key:"single",ref:J(this,"moveable")},oe({},this.props,{target:i,ables:yn.concat(t)})))},r.isMoveableElement=function(t){return this.moveable.isMoveableElement(t)},r.dragStart=function(t){this.moveable.dragStart(t)},r.isInside=function(t,e){return this.moveable.isInside(t,e)},r.updateRect=function(){this.moveable.updateRect()},r.updateTarget=function(){this.moveable.updateTarget()},r.getRect=function(){return this.moveable.getRect()},r.destroy=function(){this.moveable.componentWillUnmount()},e}(H),Cn=function(r){function t(t){var e=r.call(this,t)||this;return e.state={},e.state=e.props,e}return i(t,r),t.prototype.render=function(){return function(t,e){return A(V,{element:t,container:e})}(A(Mn,s({ref:c(this,"moveable")},this.state)),this.state.parentElement)},t}(W),Dn=["draggable","resizable","scalable","rotatable","warpable","pinchable","snappable","origin","target","edge","throttleDrag","throttleDragRotate","throttleResize","throttleScale","throttleRotate","keepRatio","dragArea","pinchThreshold","snapCenter","snapThreshold","horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","className","renderDirections","scrollable","getScrollPosition","scrollContainer","scrollThreshold","baseDirection","snapElement","snapVertical","snapHorizontal"],On=["dragStart","drag","dragEnd","resizeStart","resize","resizeEnd","scaleStart","scale","scaleEnd","rotateStart","rotate","rotateEnd","warpStart","warp","warpEnd","pinchStart","pinch","pinchEnd","dragGroupStart","dragGroup","dragGroupEnd","resizeGroupStart","resizeGroup","resizeGroupEnd","scaleGroupStart","scaleGroup","scaleGroupEnd","rotateGroupStart","rotateGroup","rotateGroupEnd","pinchGroupStart","pinchGroup","pinchGroupEnd","clickGroup","scroll","scrollGroup","renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],Rn=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","setState"],Pn=function(o){function t(t,e){void 0===e&&(e={});var r=o.call(this)||this;r.tempElement=document.createElement("div");var n=s({container:t},e),i={};On.forEach(function(e){i[function(t){return t.replace(/[\s-_]([a-z])/g,function(t,e){return e.toUpperCase()})}("on "+e)]=function(t){return r.trigger(e,t)}}),$(A(Cn,s({ref:c(r,"innerMoveable"),parentElement:t},n,i)),r.tempElement);var a=n.target;return K(a)&&1<a.length&&r.updateRect(),r}i(t,o);var e=t.prototype;return e.setState=function(t,e){this.innerMoveable.setState(t,e)},e.destroy=function(){$(null,this.tempElement),this.off(),this.tempElement=null,this.innerMoveable=null},e.getMoveable=function(){return this.innerMoveable.moveable},t=function(t,e,r,n){var i,a=arguments.length,o=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;0<=s;s--)(i=t[s])&&(o=(a<3?i(o):3<a?i(e,r,o):i(e,r))||o);return 3<a&&o&&Object.defineProperty(e,r,o),o}([r(Rn,function(t,n){t[n]||(t[n]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=this.getMoveable();if(r&&r[n])return r[n].apply(r,t)})}),r(Dn,function(t,r){Object.defineProperty(t,r,{get:function(){return this.getMoveable().props[r]},set:function(t){var e;this.setState(((e={})[r]=t,e))},enumerable:!0,configurable:!0})})],t)}(t),_n={__proto__:null,default:Pn,PROPERTIES:Dn,EVENTS:On,METHODS:Rn};for(var zn in _n)Pn[zn]=_n[zn];return Pn});
//# sourceMappingURL=moveable.min.js.map
