/*
Copyright (c) 2019 Daybrush
name: moveable
license: MIT
author: Daybrush
repository: git+https://github.com/daybrush/moveable.git
version: 0.16.3
*/
!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(t=t||self).Moveable=r()}(this,function(){"use strict";var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])})(t,r)};function i(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var s=function(){return(s=Object.assign||function(t){for(var r,n=1,e=arguments.length;n<e;n++)for(var i in r=arguments[n])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}).apply(this,arguments)};function u(t){return void 0===t}var t=function(){var t=function(){function t(){this._eventHandler={},this.options={}}var r=t.prototype;return r.trigger=function(t,r){void 0===r&&(r={});var n=this._eventHandler[t]||[];if(!(0<n.length))return!0;n=n.concat(),r.eventType=t;var e=!1,i=[r],o=0;r.stop=function(){e=!0},r.currentTarget=this;for(var a=arguments.length,s=new Array(2<a?a-2:0),u=2;u<a;u++)s[u-2]=arguments[u];for(1<=s.length&&(i=i.concat(s)),o=0;n[o];o++)n[o].apply(this,i);return!e},r.once=function(i,o){if("object"==typeof i&&u(o)){var t,r=i;for(t in r)this.once(t,r[t]);return this}if("string"==typeof i&&"function"==typeof o){var a=this;this.on(i,function t(){for(var r=arguments.length,n=new Array(r),e=0;e<r;e++)n[e]=arguments[e];o.apply(a,n),a.off(i,t)})}return this},r.hasOn=function(t){return!!this._eventHandler[t]},r.on=function(t,r){if("object"==typeof t&&u(r)){var n,e=t;for(n in e)this.on(n,e[n]);return this}if("string"==typeof t&&"function"==typeof r){var i=this._eventHandler[t];u(i)&&(this._eventHandler[t]=[],i=this._eventHandler[t]),i.push(r)}return this},r.off=function(t,r){if(u(t))return this._eventHandler={},this;if(u(r)){if("string"==typeof t)return this._eventHandler[t]=void 0,this;var n,e=t;for(n in e)this.off(n,e[n]);return this}var i,o,a=this._eventHandler[t];if(a)for(i=0;void 0!==(o=a[i]);i++)if(o===r){a=a.splice(i,1);break}return this},t}();return t.VERSION="2.1.2",t}();function c(r,n){return function(t){t&&(r[n]=t)}}function n(n,e){return function(t){var r=t.prototype;n.forEach(function(t){e(r,t)})}}var b=function(){function t(){this.keys=[],this.values=[]}var r=t.prototype;return r.get=function(t){return this.values[this.keys.indexOf(t)]},r.set=function(t,r){var n=this.keys,e=this.values,i=n.indexOf(t),o=-1===i?n.length:i;n[o]=t,e[o]=r},t}(),y=function(){function t(){this.object={}}var r=t.prototype;return r.get=function(t){return this.object[t]},r.set=function(t,r){this.object[t]=r},t}(),E="function"==typeof Map,o=function(){function t(){}var r=t.prototype;return r.connect=function(t,r){this.prev=t,this.next=r,t&&(t.next=this),r&&(r.prev=this)},r.disconnect=function(){var t=this.prev,r=this.next;t&&(t.next=r),r&&(r.prev=t)},r.getIndex=function(){for(var t=this,r=-1;t;)t=t.prev,++r;return r},t}();var x=function(){function t(t,r,n,e,i,o,a,s){this.prevList=t,this.list=r,this.added=n,this.removed=e,this.changed=i,this.maintained=o,this.changedBeforeAdded=a,this.fixed=s}var r=t.prototype;return Object.defineProperty(r,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(r,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),r.caculateOrdered=function(){var t=function(t,n){var s=[],u=[];return t.forEach(function(t){var r=t[0],n=t[1],e=new o;s[r]=e,u[n]=e}),s.forEach(function(t,r){t.connect(s[r-1])}),t.filter(function(t,r){return!n[r]}).map(function(t,r){var n=t[0],e=t[1];if(n===e)return[0,0];var i=s[n],o=u[e-1],a=i.getIndex();return i.disconnect(),o?i.connect(o,o.next):i.connect(void 0,s[0]),[a,i.getIndex()]})}(this.changedBeforeAdded,this.fixed),s=this.changed,u=[];this.cacheOrdered=t.filter(function(t,r){var n=t[0],e=t[1],i=s[r],o=i[0],a=i[1];if(n!==e)return u.push([o,a]),!0}),this.cachePureChanged=u},t}();function f(t,r,n){var e=E?Map:n?y:b,i=n||function(t){return t},o=[],a=[],s=[],u=t.map(i),c=r.map(i),f=new e,l=new e,p=[],h=[],d={},v=[],g=0,m=0;return u.forEach(function(t,r){f.set(t,r)}),c.forEach(function(t,r){l.set(t,r)}),u.forEach(function(t,r){var n=l.get(t);void 0===n?(++m,a.push(r)):d[n]=m}),c.forEach(function(t,r){var n=f.get(t);void 0===n?(o.push(r),++g):(s.push([n,r]),m=d[r]||0,p.push([n-m,r-g]),h.push(r===n),n!==r&&v.push([n,r]))}),a.reverse(),new x(t,r,o,a,v,s,p,h)}var r=function(){function t(t,r){void 0===t&&(t=[]),this.findKeyCallback=r,this.list=[].slice.call(t)}return t.prototype.update=function(t){var r=[].slice.call(t),n=f(this.list,r,this.findKeyCallback);return this.list=r,n},t}(),l="function",a="object",p="string",h="undefined";function k(t){return typeof t===h}function C(t){return t&&typeof t===a}function J(t){return Array.isArray(t)}function d(t){return typeof t===p}function S(t){var r=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(t);if(!r)return{prefix:"",unit:"",value:NaN};var n=r[1],e=r[2];return{prefix:n,unit:r[3],value:parseFloat(e)}}function v(t,r,n){void 0===n&&(n=-1);for(var e=t.length,i=0;i<e;++i)if(r(t[i],i,t))return i;return n}function g(t,r){return t.classList?t.classList.contains(r):!!t.className.match(new RegExp("(\\s|^)"+r+"(\\s|$)"))}function m(t,r,n,e){t.addEventListener(r,n,e)}function M(t,r,n){t.removeEventListener(r,n)}var D=function(t,r){return(D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])})(t,r)};function w(t,r){function n(){this.constructor=t}D(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var P=function(){return(P=Object.assign||function(t){for(var r,n=1,e=arguments.length;n<e;n++)for(var i in r=arguments[n])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}).apply(this,arguments)};function O(t,r){var n={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&r.indexOf(e)<0&&(n[e]=t[e]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(e=Object.getOwnPropertySymbols(t);i<e.length;i++)r.indexOf(e[i])<0&&Object.prototype.propertyIsEnumerable.call(t,e[i])&&(n[e[i]]=t[e[i]])}return n}function z(t,r){if(t===r)return!1;for(var n in t)if(!(n in r))return!0;for(var n in r)if(t[n]!==r[n])return!0;return!1}function R(i,o){var a=Object.keys(i),n=Object.keys(o),t=f(a,n,function(t){return t}),e={},s={},u={};return t.added.forEach(function(t){var r=n[t];e[r]=o[r]}),t.removed.forEach(function(t){var r=a[t];s[r]=i[r]}),t.maintained.forEach(function(t){var r=t[0],n=a[r],e=[i[n],o[n]];i[n]!==o[n]&&(u[n]=e)}),{added:e,removed:s,changed:u}}function B(t){t.forEach(function(t){t()})}function _(t){var r=0;return t.map(function(t){return null==t?"$compat"+ ++r:""+t})}function G(t,r,n,e){return d(t)?new N("text_"+t,r,n,e,null,{}):new("string"==typeof t.type?W:t.type.prototype.render?F:j)(t.type,r,n,e,t.ref,t.props)}function T(t){var r=t.className,n=O(t,["className"]);return null!=r&&(n.class=r),delete n.style,delete n.children,n}function A(t,r){if(!r)return t;for(var n in r)k(t[n])&&(t[n]=r[n]);return t}function I(t,r){for(var n=[],e=2;e<arguments.length;e++)n[e-2]=arguments[e];var i=r||{},o=i.key,a=i.ref,s=O(i,["key","ref"]);return{type:t,key:o,ref:a,props:P(P({},s),{children:function r(t){var n=[];return t.forEach(function(t){n=n.concat(J(t)?r(t):t)}),n}(n).filter(function(t){return null!=t})})}}var Y=function(){function t(t,r,n,e,i,o){void 0===o&&(o={}),this.type=t,this.key=r,this.index=n,this.container=e,this.ref=i,this.props=o,this._providers=[]}var r=t.prototype;return r._should=function(t,r){return!0},r._update=function(t,r,n,e){if(this.base&&!d(r)&&!e&&!this._should(r.props,n))return!1;this.original=r,this._setState(n);var i=this.props;return d(r)||(this.props=r.props,this.ref=r.ref),this._render(t,this.base?i:{},n),!0},r._mounted=function(){var t=this.ref;t&&t(this.base)},r._setState=function(t){},r._updated=function(){var t=this.ref;t&&t(this.base)},r._destroy=function(){var t=this.ref;t&&t(null)},t}();function X(t){var r={},n={};for(var e in t)0===e.indexOf("on")?n[e.replace("on","").toLowerCase()]=t[e]:r[e]=t[e];return{attributes:r,events:n}}var N=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}w(r,t);var n=r.prototype;return n._render=function(t){var r=this,n=!this.base;return n&&(this.base=document.createTextNode(this.type.replace("text_",""))),t.push(function(){n?r._mounted():r._updated()}),!0},n._unmount=function(){this.base.parentNode.removeChild(this.base)},r}(Y),W=function(r){function t(){var t=null!==r&&r.apply(this,arguments)||this;return t.events={},t}w(t,r);var n=t.prototype;return n.addEventListener=function(t,r){var n=this.events;n[t]=function(t){t.nativeEvent=t,r(t)},this.base.addEventListener(t,n[t])},n.removeEventListener=function(t){var r=this.events;this.base.removeEventListener(t,r[t]),delete r[t]},n._should=function(t){return z(this.props,t)},n._render=function(t,r){var n=this,e=!this.base;e&&(this.base=document.createElement(this.type)),$(this,this._providers,this.props.children,t,null);var i=this.base,o=X(r),a=o.attributes,s=o.events,u=X(this.props),c=u.attributes,f=u.events;return function(t,r,n){var e=R(t,r),i=e.added,o=e.removed,a=e.changed;for(var s in i)n.setAttribute(s,i[s]);for(var s in a)n.setAttribute(s,a[s][1]);for(var s in o)n.removeAttribute(s)}(T(a),T(c),i),function(t,r,n){var e=R(t,r),i=e.added,o=e.removed,a=e.changed;for(var s in o)n.removeEventListener(s);for(var s in i)n.addEventListener(s,i[s]);for(var s in a)n.removeEventListener(s),n.addEventListener(s,a[s][1]);for(var s in o)n.removeEventListener(s)}(s,f,this),function(t,r,n){var e=n.style,i=R(t,r),o=i.added,a=i.removed,s=i.changed;for(var u in o)e[u]=o[u];for(var u in s)e[u]=s[u][1];for(var u in a)e[u]=""}(r.style||{},this.props.style||{},i),t.push(function(){e?n._mounted():n._updated()}),!0},n._unmount=function(){var t=this.events,r=this.base;for(var n in t)r.removeEventListener(n,t[n]);this._providers.forEach(function(t){t._unmount()}),this.events={},r.parentNode.removeChild(r)},t}(Y);function H(t){if(!t)return null;if(t instanceof Node)return t;var r=t._provider._providers;return r.length?H(r[0].base):null}var j=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}w(r,t);var n=r.prototype;return n._render=function(t){var r=this.type(this.props);return $(this,this._providers,r?[r]:[],t),!0},n._unmount=function(){this._providers.forEach(function(t){t._unmount()})},r}(Y),L=function(n){function t(t){var r=n.call(this,"container","container",0,null)||this;return r.base=t,r}w(t,n);var r=t.prototype;return r._render=function(){return!0},r._unmount=function(){},t}(Y),F=function(a){function t(t,r,n,e,i,o){return void 0===o&&(o={}),a.call(this,t,r,n,e,i,A(o,t.defaultProps))||this}w(t,a);var r=t.prototype;return r._should=function(t,r){return this.base.shouldComponentUpdate(A(t,this.type.defaultProps),r||this.base.state)},r._render=function(t,r,n){var e=this;this.props=A(this.props,this.type.defaultProps);var i=!this.base;i?(this.base=new this.type(this.props),this.base._provider=this):this.base.props=this.props;var o=this.base,a=o.state,s=o.render();s&&s.props&&!s.props.children.length&&(s.props.children=this.props.children),$(this,this._providers,s?[s]:[],t,n,null),t.push(function(){i?(e._mounted(),o.componentDidMount()):(e._updated(),o.componentDidUpdate(r,a))})},r._setState=function(t){t&&(this.base.state=t)},r._unmount=function(){this._providers.forEach(function(t){t._unmount()}),this.base.componentWillUnmount()},t}(Y),q=function(){function t(t){void 0===t&&(t={}),this.props=t,this.state={}}var r=t.prototype;return r.shouldComponentUpdate=function(t,r){return!0},r.render=function(){return null},r.setState=function(t,r,n){var e=[],i=this._provider;$(i.container,[i],[i.original],e,P(P({},this.state),t),n)&&(r&&e.push(r),B(e))},r.forceUpdate=function(t){this.setState(this.state,t,!0)},r.componentDidMount=function(){},r.componentDidUpdate=function(t,r){},r.componentWillUnmount=function(){},t}(),V=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),r.prototype.shouldComponentUpdate=function(t,r){return z(this.props,t)||z(this.state,r)},r}(q),U=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}w(r,t);var n=r.prototype;return n.componentDidMount=function(){var t=this.props,r=t.element,n=t.container;this._portalProvider=new L(n),Z(r,n,this._portalProvider)},n.componentDidUpdate=function(){var t=this.props;Z(t.element,t.container,this._portalProvider)},n.componentWillUnmount=function(){Z(null,this.props.container,this._portalProvider),this._portalProvider=null},r}(V);function K(i,a,o){var s=o.map(function(t){return d(t)?null:t.key}),t=f(_(a.map(function(t){return t.key})),_(s),function(t){return t});t.removed.forEach(function(t){a.splice(t,1)[0]._unmount()}),t.ordered.forEach(function(t){var r=t[0],n=t[1],e=a.splice(r,1)[0];a.splice(n,0,e);var i=H(e.base),o=H(a[n+1]&&a[n+1].base);i&&i.parentNode.insertBefore(i,o)}),t.added.forEach(function(t){a.splice(t,0,G(o[t],s[t],t,i))});var r=t.maintained.filter(function(t){t[0];var r=t[1],n=o[r],e=a[r];return(d(n)?"text_"+n:n.type)!==e.type?(e._unmount(),a.splice(r,1,G(n,s[r],r,i)),!0):(e.index=r,!1)});return function(){for(var t=0,r=0,n=arguments.length;r<n;r++)t+=arguments[r].length;var e=Array(t),i=0;for(r=0;r<n;r++)for(var o=arguments[r],a=0,s=o.length;a<s;a++,i++)e[i]=o[a];return e}(t.added,r.map(function(t){t[0];return t[1]}))}function $(i,o,n,e,a,s){var t=K(i,o,n),r=o.filter(function(t,r){return t._update(e,n[r],a,s)}),u=function t(r){if(!r)return null;var n=r.base;return n instanceof Node?n:t(r.container)}(i);return u&&t.reverse().forEach(function(t){var r=o[t],n=H(r.base);if(n&&u!==n&&!n.parentNode){var e=function(t,r){for(var n=t._providers,e=n.length,i=r.index+1;i<e;++i){var o=H(n[i].base);if(o)return o}return null}(i,r);u.insertBefore(n,e)}}),0<r.length}function Z(t,r,n){void 0===n&&(n=r.__REACT_COMPAT__);var e=!!n;return function(t,r,n){var e=[];$(t,t._providers,r,e,n),B(e)}(n=n||new L(r),t?[t]:[]),e||(r.__REACT_COMPAT__=n),n}function Q(t,r,n){var e=r.__REACT_COMPAT__;t&&!e&&(r.innerHTML=""),Z(t,r,e),n&&n()}function tt(r,n){return function(t){t&&(r[n]=t)}}var rt=("undefined"!=typeof window&&window||{}).navigator,nt={browser:[{criteria:"PhantomJS",identity:"PhantomJS"},{criteria:/Whale/,identity:"Whale",versionSearch:"Whale"},{criteria:/Edge/,identity:"Edge",versionSearch:"Edge"},{criteria:/MSIE|Trident|Windows Phone/,identity:"IE",versionSearch:"IEMobile|MSIE|rv"},{criteria:/MiuiBrowser/,identity:"MIUI Browser",versionSearch:"MiuiBrowser"},{criteria:/SamsungBrowser/,identity:"Samsung Internet",versionSearch:"SamsungBrowser"},{criteria:/SAMSUNG /,identity:"Samsung Internet",versionSearch:"Version"},{criteria:/Chrome|CriOS/,identity:"Chrome"},{criteria:/Android/,identity:"Android Browser",versionSearch:"Version"},{criteria:/iPhone|iPad/,identity:"Safari",versionSearch:"Version"},{criteria:"Apple",identity:"Safari",versionSearch:"Version"},{criteria:"Firefox",identity:"Firefox"}],os:[{criteria:/Windows Phone/,identity:"Windows Phone",versionSearch:"Windows Phone"},{criteria:"Windows 2000",identity:"Window",versionAlias:"5.0"},{criteria:/Windows NT/,identity:"Window",versionSearch:"Windows NT"},{criteria:/iPhone|iPad/,identity:"iOS",versionSearch:"iPhone OS|CPU OS"},{criteria:"Mac",versionSearch:"OS X",identity:"MAC"},{criteria:/Android/,identity:"Android"},{criteria:/Tizen/,identity:"Tizen"},{criteria:/Web0S/,identity:"WebOS"}],webview:[{criteria:/iPhone|iPad/,browserVersionSearch:"Version",webviewBrowserVersion:/-1/},{criteria:/iPhone|iPad|Android/,webviewToken:/NAVER|DAUM|; wv/}],defaultString:{browser:{version:"-1",name:"unknown"},os:{version:"-1",name:"unknown"}}};function et(t,r){for(var n=[],e=0;e<t.length;e++)r(t[e])&&n.push(t[e]);return n}var it=void 0;function ot(t,r){return r&&r.test?!!r.test(t):-1<t.indexOf(r)}function at(t,r){var n=et(t,function(t){return ot(it,t.criteria)})[0];return n&&n.identity||r.name}function st(t,e){return et(t,function(t){var r=t.criteria,n=new RegExp(t.identity,"i").test(e);return!!(r?n&&ot(it,r):n)})[0]}function ut(t,r){var n=nt.defaultString.browser.version,e=new RegExp("("+t+")","i").exec(r);if(!e)return n;var i=e.index,o=e[0];if(-1<i){var a=i+o.length+1;n=r.substring(a).split(" ")[0].replace(/_/g,".").replace(/;|\)/g,"")}return n}function ct(t){if(t)return ut(function(t){var r=st(nt.browser,t);return r=r||{criteria:t,versionSearch:t,identity:t}}(t).versionSearch||t,it)}function ft(){var t=nt.webview,r=void 0;return function(t,r){for(var n=0;n<t.length;n++)if(r(t[n]))return!0;return!1}(et(t,function(t){return ot(it,t.criteria)}),function(t){return r=ut(t.browserVersionSearch,it),!(!ot(it,t.webviewToken)&&!ot(r,t.webviewBrowserVersion))})}function lt(t){var r=function(t){return st(nt.os,t)}(t)||{},n=nt.defaultString.os.version,e=void 0;if(t){if(r.versionAlias)return r.versionAlias;var i=r.versionSearch||t,o=new RegExp("("+i+")\\s([\\d_\\.]+|\\d_0)","i");return o.exec(it)&&(e=o.exec(it)[2].replace(/_/g,".").replace(/;|\)/g,"")),e||n}}function pt(){var t=at(nt.os,nt.defaultString.os);return{name:t,version:lt(t)}}function ht(){var t=at(nt.browser,nt.defaultString.browser);return{name:t,version:ct(t),webview:ft()}}function dt(){!function(t){it=t}(0<arguments.length&&void 0!==arguments[0]?arguments[0]:rt.userAgent);var t={os:pt(),browser:ht(),isMobile:-1!==it.indexOf("Mobi")};return t.browser.name=t.browser.name.toLowerCase(),t.os.name=t.os.name.toLowerCase(),t.os.version=t.os.version.toLowerCase(),"ios"===t.os.name&&t.browser.webview&&(t.browser.version="-1"),t}function vt(t,r,n,e,i,o){for(var a=n;a<e;++a)t[a]+=t[i+a-n]*o,r[a]+=r[i+a-n]*o}function gt(t,r,n,e,i){for(var o=n;o<e;++o){var a=t[o],s=r[o];t[o]=t[i+o-n],t[i+o-n]=a,r[o]=r[i+o-n],r[i+o-n]=s}}function mt(t,r,n,e,i){for(var o=n;o<e;++o)t[o]/=i,r[o]/=i}function bt(t,r,n){void 0===n&&(n=Math.sqrt(t.length));for(var e=t.slice(),i=0;i<n;++i)e[i*n+r-1]=0,e[(r-1)*n+i]=0;return e[(r-1)*(n+1)]=1,e}function yt(t,r){void 0===r&&(r=Math.sqrt(t.length));for(var n=t.slice(),e=Tt(r),i=0;i<r;++i){var o=r*i,a=r*(i+1),s=o+i;if(0===n[s])for(var u=i+1;u<r;++u)if(n[r*u+i]){gt(n,e,o,a,r*u);break}if(!n[s])return[];mt(n,e,o,a,n[s]);for(u=0;u<r;++u){var c=r*u,f=c+r,l=n[c+i];0!==l&&i!==u&&vt(n,e,c,f,o,-l)}}return e}function Et(t,r){void 0===r&&(r=Math.sqrt(t.length));for(var n=[],e=0;e<r;++e)for(var i=0;i<r;++i)n[i*r+e]=t[r*e+i];return n}function xt(t,r){var n=r[0]-t[0],e=r[1]-t[1],i=Math.atan2(e,n);return 0<=i?i:i+2*Math.PI}function St(t,r){for(var n=t.slice(),e=t.length;e<r-1;++e)n[e]=0;return n[r-1]=1,n}function Mt(t,r,n){if(void 0===r&&(r=Math.sqrt(t.length)),r===n)return t;for(var e=Tt(n),i=Math.min(r,n),o=0;o<i-1;++o){for(var a=0;a<i-1;++a)e[o*n+a]=t[o*r+a];e[(o+1)*n-1]=t[(o+1)*r-1],e[(n-1)*n+o]=t[(r-1)*r+o]}return e[n*n-1]=t[r*r-1],e}function Dt(r){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var e=Tt(r);return t.forEach(function(t){e=wt(e,t,r)}),e}function wt(t,r,n){var e=[],i=t.length/n,o=r.length/i;if(!i)return r;if(!o)return t;for(var a=0;a<n;++a)for(var s=0;s<o;++s)for(var u=e[a*o+s]=0;u<i;++u)e[a*o+s]+=t[a*i+u]*r[u*o+s];return e}function Ct(t,r,n){void 0===n&&(n=Math.sqrt(t.length));for(var e=[],i=t.length/n,o=r.length/i,a=0;a<n;++a)for(var s=0;s<o;++s)for(var u=e[a+s*o]=0;u<i;++u)e[a+s*o]+=t[a+u*i]*r[u+s*o];return e}function Pt(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var n=t.length,e=0,i=n-1;0<=i;--i)e+=t[i];return n?e/n:0}function Ot(t,r){for(var n=Math.min(t.length,r.length),e=t.slice(),i=0;i<n;++i)e[i]=e[i]+r[i];return e}function zt(t,r){for(var n=Math.min(t.length,r.length),e=t.slice(),i=0;i<n;++i)e[i]=e[i]-r[i];return e}function Rt(t,r,n){void 0===n&&(n=r.length);var e=wt(t,r,n),i=e[n-1];return e.map(function(t){return t/i})}function Bt(t,r){return Rt(Gt(r,3),St(t,3))}function _t(t){return 9===t.length?[t[0],t[3],t[1],t[4],t[2],t[5]]:Et(t)}function Gt(t,r){var n=Math.cos(t),e=Math.sin(t),i=Tt(r);return i[0]=n,i[1]=-e,i[r]=e,i[r+1]=n,i}function Tt(t){for(var r=t*t,n=[],e=0;e<r;++e)n[e]=e%(t+1)?0:1;return n}function At(t,r){for(var n=Tt(r),e=Math.min(t.length,r-1),i=0;i<e;++i)n[(r+1)*i]=t[i];return n}function It(t,r){for(var n=Tt(r),e=Math.min(t.length,r-1),i=0;i<e;++i)n[r*(i+1)-1]=t[i];return n}function Yt(t,r,n,e,i,o,a,s){var u=t[0],c=t[1],f=r[0],l=r[1],p=n[0],h=n[1],d=e[0],v=e[1],g=i[0],m=i[1],b=o[0],y=o[1],E=a[0],x=a[1],S=s[0],M=s[1],D=yt([u,c,1,0,0,0,-g*u,-g*c,0,0,0,u,c,1,-m*u,-m*c,f,l,1,0,0,0,-b*f,-b*l,0,0,0,f,l,1,-y*f,-y*l,p,h,1,0,0,0,-E*p,-E*h,0,0,0,p,h,1,-x*p,-x*h,d,v,1,0,0,0,-S*d,-S*v,0,0,0,d,v,1,-M*d,-M*v],8);if(!D.length)return[];var w=wt(D,[g,m,b,y,E,x,S,M],8);return w[8]=1,Mt(w,3,4)}dt.VERSION="2.1.5";var Xt=function(t){for(var r=5381,n=t.length;n;)r=33*r^t.charCodeAt(--n);return r>>>0};function Nt(n,t,r){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=t.replace(/([^}{]*){/gm,function(t,r){return function(t){var r=t.match(/("[^"]*"|'[^']*'|[^,\s()]*\((?:[^()]*|\([^()]*\))*\)[^,\s()]*|[^,])+/g);return r?r.map(function(t){return t.trim()}):[]}(r).map(function(t){return-1<t.indexOf(":global")?t.replace(/\:global/g,""):-1<t.indexOf(":host")?""+t.replace(/\:host/g,"."+n):"."+n+" "+t}).join(", ")+"{"}),(r||document.head||document.body).appendChild(e),e}function kt(i){var o,a="rCS"+function(t){return Xt(t).toString(36)}(i),s=0;return{className:a,inject:function(t){var r,n=function(t){if(t.getRootNode){var r=t.getRootNode();if(11===r.nodeType)return r}}(t),e=0===s;return(n||e)&&(r=Nt(a,i,n)),e&&(o=r),n||++s,{destroy:function(){n?(t.removeChild(r),r=null):(0<s&&--s,0===s&&o&&(o.parentNode.removeChild(o),o=null))}}}}}var Wt=function(t,r){return(Wt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])})(t,r)};var Ht=function(){return(Ht=Object.assign||function(t){for(var r,n=1,e=arguments.length;n<e;n++)for(var i in r=arguments[n])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}).apply(this,arguments)};var jt=function(){return(jt=Object.assign||function(t){for(var r,n=1,e=arguments.length;n<e;n++)for(var i in r=arguments[n])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}).apply(this,arguments)};function Lt(t,r,n,e){var i=Jt(t),o=Jt(r),a=Jt(e);return qt(Zt(e[0],Qt(i,a)),Zt(e[0],Qt(o,a)),n[0])}function Ft(t){return t.touches?Kt(t.touches):[$t(t)]}function qt(t,r,n){var e=t.clientX,i=t.clientY;return{clientX:e,clientY:i,deltaX:e-r.clientX,deltaY:i-r.clientY,distX:e-n.clientX,distY:i-n.clientY}}function Vt(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function Ut(t,n,e){return t.map(function(t,r){return qt(t,n[r],e[r])})}function Kt(t){for(var r=Math.min(t.length,2),n=[],e=0;e<r;++e)n.push($t(t[e]));return n}function $t(t){return{clientX:t.clientX,clientY:t.clientY}}function Jt(t){return 1===t.length?t[0]:{clientX:(t[0].clientX+t[1].clientX)/2,clientY:(t[0].clientY+t[1].clientY)/2}}function Zt(t,r){return{clientX:t.clientX+r.clientX,clientY:t.clientY+r.clientY}}function Qt(t,r){return{clientX:t.clientX-r.clientX,clientY:t.clientY-r.clientY}}var tr=function(){function t(t,r){var s=this;void 0===r&&(r={}),this.el=t,this.options={},this.flag=!1,this.pinchFlag=!1,this.datas={},this.isDrag=!1,this.isPinch=!1,this.isMouse=!1,this.isTouch=!1,this.prevClients=[],this.startClients=[],this.movement=0,this.startPinchClients=[],this.startDistance=0,this.customDist=[0,0],this.onDragStart=function(t){if(s.flag||!1!==t.cancelable){if(function(t){return t.touches&&2<=t.touches.length}(t)){if(!s.flag&&t.touches.length!==t.changedTouches.length)return;s.pinchFlag||s.onPinchStart(t)}if(!s.flag){var r=s.startClients[0]?s.startClients:Ft(t);s.customDist=[0,0],s.flag=!0,s.isDrag=!1,s.startClients=r,s.prevClients=r,s.datas={};var n=qt(r[s.movement=0],s.prevClients[0],s.startClients[0]),e=s.options,i=e.dragstart,o=e.preventRightClick,a=e.preventDefault;(o&&3===t.which||!1===(i&&i(jt({datas:s.datas,inputEvent:t},n))))&&(s.startClients=[],s.prevClients=[],s.flag=!1),s.flag&&a&&t.preventDefault()}}},this.onDrag=function(t,r){if(s.flag){var n=Ft(t);s.pinchFlag&&s.onPinch(t,n);var e=s.move([0,0],t,n);if(e&&(e.deltaX||e.deltaY)){var i=s.options.drag;i&&i(jt({},e,{isScroll:!!r,inputEvent:t}))}}},this.onDragEnd=function(t){if(s.flag){s.pinchFlag&&s.onPinchEnd(t),s.flag=!1;var r=s.options.dragend,n=s.prevClients,e=s.startClients,i=s.pinchFlag?Lt(n,n,e,s.startPinchClients):qt(n[0],n[0],e[0]);s.startClients=[],s.prevClients=[],r&&r(jt({datas:s.datas,isDrag:s.isDrag,inputEvent:t},i))}},this.options=jt({container:t,preventRightClick:!0,preventDefault:!0,pinchThreshold:0,events:["touch","mouse"]},r);var n=this.options,e=n.container,i=n.events;if(this.isTouch=-1<i.indexOf("touch"),this.isMouse=-1<i.indexOf("mouse"),this.customDist=[0,0],this.isMouse&&(m(t,"mousedown",this.onDragStart),m(e,"mousemove",this.onDrag),m(e,"mouseup",this.onDragEnd)),this.isTouch){var o={passive:!1};m(t,"touchstart",this.onDragStart,o),m(e,"touchmove",this.onDrag,o),m(e,"touchend",this.onDragEnd,o),m(e,"touchcancel",this.onDragEnd,o)}}var r=t.prototype;return r.isDragging=function(){return this.isDrag},r.isFlag=function(){return this.flag},r.isPinching=function(){return this.isPinch},r.scrollBy=function(r,n,t,e){void 0===e&&(e=!0),this.flag&&(this.startClients.forEach(function(t){t.clientX-=r,t.clientY-=n}),this.prevClients.forEach(function(t){t.clientX-=r,t.clientY-=n}),e&&this.onDrag(t,!0))},r.move=function(t,r,n){var e=t[0],i=t[1];void 0===n&&(n=this.prevClients);var o=this.customDist,a=this.prevClients,s=this.startClients,u=this.pinchFlag?Lt(n,a,s,this.startPinchClients):qt(n[0],a[0],s[0]);o[0]+=e,o[1]+=i,u.deltaX+=e,u.deltaY+=i;var c=u.deltaX,f=u.deltaY;return u.distX+=o[0],u.distY+=o[1],this.movement+=Math.sqrt(c*c+f*f),this.prevClients=n,this.isDrag=!0,jt({datas:this.datas},u,{isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:r})},r.onPinchStart=function(t){var r,n,e=this.options,i=e.pinchstart,o=e.pinchThreshold;if(!(this.isDrag&&this.movement>o)){var a=Kt(t.changedTouches);if(this.pinchFlag=!0,(r=this.startClients).push.apply(r,a),(n=this.prevClients).push.apply(n,a),this.startDistance=Vt(this.prevClients),this.startPinchClients=this.prevClients.slice(),i){var s=this.prevClients,u=Jt(s),c=qt(u,u,u);i(jt({datas:this.datas,touches:Ut(s,s,s)},c,{inputEvent:t}))}}},r.onPinch=function(t,r){if(this.flag&&this.pinchFlag&&!(r.length<2)){this.isPinch=!0;var n=this.options.pinch;if(n){var e=this.prevClients,i=this.startClients,o=qt(Jt(r),Jt(e),Jt(i)),a=Vt(r);n(jt({datas:this.datas,touches:Ut(r,e,i),scale:a/this.startDistance,distance:a},o,{inputEvent:t}))}}},r.onPinchEnd=function(t){if(this.flag&&this.pinchFlag){var r=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var n=this.options.pinchend;if(n){var e=this.prevClients,i=this.startClients,o=qt(Jt(e),Jt(e),Jt(i));n(jt({datas:this.datas,isPinch:r,touches:Ut(e,e,i)},o,{inputEvent:t})),this.isPinch=!1,this.pinchFlag=!1}}},r.unset=function(){var t=this.el,r=this.options.container;this.isMouse&&(M(t,"mousedown",this.onDragStart),M(r,"mousemove",this.onDrag),M(r,"mouseup",this.onDragEnd)),this.isTouch&&(M(t,"touchstart",this.onDragStart),M(r,"touchmove",this.onDrag),M(r,"touchend",this.onDragEnd),M(r,"touchcancel",this.onDragEnd))},t}(),rr=function(t,r){return(rr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])})(t,r)};function nr(t){var r=t.container;return[r.scrollLeft,r.scrollTop]}var er=function(r){function t(){var t=null!==r&&r.apply(this,arguments)||this;return t.startRect=null,t.startPos=[],t.prevTime=0,t.timer=0,t}!function(t,r){function n(){this.constructor=t}rr(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}(t,r);var n=t.prototype;return n.dragStart=function(t,r){var n=r.container.getBoundingClientRect(),e=n.top,i=n.left,o=n.width,a=n.height;this.startPos=[t.clientX,t.clientY],this.startRect={top:e,left:i,width:o,height:a}},n.drag=function(t,r){var n=this,e=t.clientX,i=t.clientY,o=r.container,a=r.threshold,s=void 0===a?0:a,u=r.throttleTime,c=void 0===u?0:u,f=r.getScrollPosition,l=void 0===f?nr:f,p=this.startRect,h=this.startPos,d=Date.now?Date.now():(new Date).getTime(),v=Math.max(c+this.prevTime-d,0),g=[0,0];if(p.top>i-s?(h[1]>p.top||i<h[1])&&(g[1]=-1):p.top+p.height<i+s&&(h[1]<p.top+p.height||i>h[1])&&(g[1]=1),p.left>e-s?(h[0]>p.left||e<h[0])&&(g[0]=-1):p.left+p.width<e+s&&(h[0]<p.left+p.width||e>h[0])&&(g[0]=1),clearTimeout(this.timer),!g[0]&&!g[1])return!1;if(0<v)return this.timer=window.setTimeout(function(){n.drag(t,r)},v),!1;this.prevTime=d;var m=l({container:o,direction:g});this.trigger("scroll",{container:o,direction:g,inputEvent:t});var b=l({container:o,direction:g}),y=b[0]-m[0],E=b[1]-m[1];return!(!y&&!E)&&(this.trigger("move",{offsetX:g[0]?y:0,offsetY:g[1]?E:0,inputEvent:t}),c&&(this.timer=window.setTimeout(function(){n.drag(t,r)},c)),!0)},n.dragEnd=function(){clearTimeout(this.timer)},t}(t),ir=function(t,r){return(ir=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])})(t,r)};var or,ar="function"==typeof Map?void 0:(or=0,function(t){return t.__DIFF_KEY__||(t.__DIFF_KEY__=++or)}),sr=function(r){function t(t){return void 0===t&&(t=[]),r.call(this,t,ar)||this}return function(t,r){function n(){this.constructor=t}ir(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}(t,r),t}(r),ur=function(t,r){return(ur=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])})(t,r)};function cr(t,r){function n(){this.constructor=t}ur(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var fr=function(){return(fr=Object.assign||function(t){for(var r,n=1,e=arguments.length;n<e;n++)for(var i in r=arguments[n])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}).apply(this,arguments)};function lr(t,r){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'+32*t+'px" height="'+32*t+'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate('+r+'deg);transform-origin: 16px 16px"></path></svg>'}var pr,hr=dt(),dr=-1<hr.os.name.indexOf("ios")||-1<hr.browser.name.indexOf("safari"),vr="moveable-",gr=(pr=vr,("\n{\n\tposition: fixed;\n\twidth: 0;\n\theight: 0;\n\tleft: 0;\n\ttop: 0;\n    z-index: 3000;\n    --zoom: 1;\n    --zoompx: 1px;\n}\n.control-box {\n    z-index: 0;\n}\n.line, .control {\n\tleft: 0;\n    top: 0;\n    will-change: transform;\n}\n.control {\n\tposition: absolute;\n\twidth: 14px;\n\theight: 14px;\n\tborder-radius: 50%;\n\tborder: 2px solid #fff;\n\tbox-sizing: border-box;\n\tbackground: #4af;\n\tmargin-top: -7px;\n    margin-left: -7px;\n    width: calc(14 * var(--zoompx));\n    height: calc(14 * var(--zoompx));\n    margin-top: calc(-7 * var(--zoompx));\n    margin-left: calc(-7 * var(--zoompx));\n    border: calc(2 * var(--zoompx)) solid #fff;\n    z-index: 10;\n}\n.line {\n\tposition: absolute;\n\twidth: 1px;\n    height: 1px;\n    width: var(--zoompx);\n    height: var(--zoompx);\n\tbackground: #4af;\n\ttransform-origin: 0px 50%;\n}\n.line.dashed {\n    box-sizing: border-box;\n    background: transparent;\n}\n.line.dashed.horizontal {\n    border-top: 1px dashed #4af;\n    border-top: var(--zoompx) dashed #4af;\n}\n.line.dashed.vertical {\n    border-left: 1px dashed #4af;\n    border-left: var(--zoompx) dashed #4af;\n}\n.line.dashed:before {\n    position: absolute;\n    content: attr(data-size);\n    color: #4af;\n    font-size: 12px;\n    font-weight: bold;\n}\n.line.dashed.horizontal:before, .line.gap.horizontal:before {\n    left: 50%;\n    transform: translateX(-50%);\n    bottom: 5px;\n}\n.line.dashed.vertical:before, .line.gap.vertical:before {\n    top: 50%;\n    transform: translateY(-50%);\n    left: 5px;\n}\n.line.rotation-line {\n\theight: 40px;\n    width: 1px;\n    transform-origin: 50% calc(100% - 0.5px);\n    top: -40px;\n    width: var(--zoompx);\n    height: calc(40 * var(--zoompx));\n    top: calc(-40 * var(--zoompx));\n    transform-origin: 50% calc(100% - 0.5 * var(--zoompx));\n}\n.line.rotation-line .control {\n\tborder-color: #4af;\n\tbackground:#fff;\n    cursor: alias;\n    left: 50%;\n}\n.line.vertical {\n    transform: translateX(-50%);\n}\n.line.horizontal {\n    transform: translateY(-50%);\n}\n.line.vertical.bold {\n    width: 2px;\n    width: calc(2 * var(--zoompx));\n}\n.line.horizontal.bold {\n    height: 2px;\n    height: calc(2 * var(--zoompx));\n}\n\n.line.gap {\n    background: #f55;\n}\n.line.gap:before {\n    position: absolute;\n    content: attr(data-size);\n    color: #f55;\n    font-size: 12px;\n    font-weight: bold;\n}\n.control.origin {\n\tborder-color: #f55;\n\tbackground: #fff;\n\twidth: 12px;\n\theight: 12px;\n\tmargin-top: -6px;\n    margin-left: -6px;\n    width: calc(12 * var(--zoompx));\n    height: calc(12 * var(--zoompx));\n    margin-top: calc(-6 * var(--zoompx));\n    margin-left: calc(-6 * var(--zoompx));\n\tpointer-events: none;\n}\n"+[0,15,30,45,60,75,90,105,120,135,150,165].map(function(t){return'\n.direction[data-rotation="'+t+'"] {\n\t'+function(t){var r=lr(1,t),n=lr(2,t),e=45*Math.round(t/45)%180,i=135==e?"nwse-resize":45==e?"nesw-resize":90==e?"ew-resize":"ns-resize";return"cursor:"+i+";cursor: url('"+r+"') 16 16, "+i+";cursor: -webkit-image-set(url('"+r+"') 1x, url('"+n+"') 2x) 16 16, "+i+";"}(t)+"\n}\n"}).join("\n")+"\n.group {\n    z-index: -1;\n}\n.area {\n    position: absolute;\n}\n.area-pieces {\n    position: absolute;\n    top: 0;\n    left: 0;\n    display: none;\n}\n.area.avoid {\n    pointer-events: none;\n}\n.area.avoid+.area-pieces {\n    display: block;\n}\n.area-piece {\n    position: absolute;\n}\n"+(dr?':global svg *:before {\n\tcontent:"";\n\ttransform-origin: inherit;\n}':"")+"\n").replace(/([^}{]*){/gm,function(t,r){return r.replace(/\.([^{,\s\d.]+)/g,"."+pr+"$1")+"{"})),mr=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],br=1e-7,yr=Math.pow(10,10),Er=-yr,xr={n:[0,1],s:[2,3],w:[2,0],e:[1,3],nw:[0],ne:[1],sw:[2],se:[3]},Sr={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135};function Mr(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return function(r){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.map(function(t){return t.split(" ").map(function(t){return t?""+r+t:""}).join(" ")}).join(" ")}.apply(void 0,[vr].concat(t))}function Dr(){return Tt(3)}function wr(t){return t&&"none"!==t?C(t)?t:function(t){var r=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(t);return!r||r.length<4?{}:{prefix:r[1],value:r[2],suffix:r[3]}}(t).value.split(/s*,\s*/g).map(function(t){return parseFloat(t)}):[1,0,0,1,0,0]}function Cr(t,r,n){return Dt(r,It(n,r),t,It(n.map(function(t){return-t}),r))}function Pr(o){return Or(en(o,":before")).map(function(t,r){var n=S(t),e=n.value,i=n.unit;return e*function(t,r,n){return"%"!==r?1:Gr(t.ownerSVGElement)[n?"width":"height"]/100}(o,i,0===r)})}function Or(t){var r=t.transformOrigin;return r?r.split(" "):["0","0"]}function zr(t,r,n){for(var e=document.body,i=!t||n?t:t.parentElement,o=!1,a="relative";i&&i!==e;){r===i&&(o=!0);var s=en(i),u=s.transform;if("static"!==(a=s.position)||u&&"none"!==u)break;i=i.parentElement,a="relative"}return{isStatic:"static"===a,isEnd:o||!i||i===e,offsetParent:i||e}}function Rr(t,r,n,e){var i,o=t.tagName.toLowerCase(),a=t.offsetLeft,s=t.offsetTop;if(e){var u=(r||document.documentElement).getBoundingClientRect();a-=u.left,s-=u.top}var c,f=k(a),l=!f;return l||"svg"===o?c=Or(n).map(function(t){return parseFloat(t)}):(c=dr?Pr(t):Or(n).map(function(t){return parseFloat(t)}),l=!0,"g"===o?s=a=0:(a=(i=function(t,r){if(!t.getBBox)return[0,0];var n=t.getBBox(),e=Gr(t.ownerSVGElement),i=n.x-e.x,o=n.y-e.y;return[i,o,r[0]-i,r[1]-o]}(t,c))[0],s=i[1],c[0]=i[2],c[1]=i[3])),{isSVG:f,hasOffset:l,offset:[a,s],origin:c}}function Br(t,r,n){var e,i,o,a=t,s=[],u=!1,c=!1,f=3,l=zr(r,r,!0).offsetParent;for(n&&(u=t===r,10<n.length&&(c=!0,f=4),r=t.parentElement);a&&!u;){var p=en(a),h=a.tagName.toLowerCase(),d=p.position,v="fixed"===d,g=p.transform,m=6===(o=wr(g)).length?[o[0],o[2],o[4],o[1],o[3],o[5],0,0,1]:Et(o),b=m.length;if(!c&&16===b){c=!0,f=4;for(var y=s.length,E=0;E<y;++E)s[E]=Mt(s[E],3,4)}c&&9===b&&(m=Mt(m,3,4));var x=Rr(a,r,p,v),S=x.hasOffset,M=x.isSVG,D=x.origin,w=x.offset,C=w[0],P=w[1];"svg"===h&&i&&s.push(Tr(a,f),Tt(f));var O=zr(a,r),z=O.offsetParent,R=O.isEnd,B=O.isStatic;dr&&S&&!M&&B&&"relative"===d&&(C-=z.offsetLeft,P-=z.offsetTop,u=u||R);var _=0,G=0;if(S&&l!==z&&(_=z.clientLeft,G=z.clientTop),s.push(Cr(m,f,D),It(S?[C-a.scrollLeft+_,P-a.scrollTop+G]:[a,D],f)),i=i||m,e=e||D,u||v)break;a=z,u=R}return{offsetContainer:l,matrixes:s,targetMatrix:i=i||Tt(f),transformOrigin:e=e||[0,0],is3d:c}}function _r(t,r,n,e,i,o){var a=Br(t,r,e),s=a.matrixes,u=a.is3d,c=a.targetMatrix,f=a.transformOrigin,l=Br(a.offsetContainer,n,i),p=l.matrixes,h=l.is3d,d=h||u?4:3,v="svg"!==t.tagName.toLowerCase()&&"ownerSVGElement"in t,g=r||document.body,m=e?Mt(e,o,d):Tt(d),b=c,y=i?Mt(i,o,d):Tt(d),E=e?Mt(e,o,d):Tt(d),x=Tt(d),S=s.length,M=zr(g,g,!0).offsetParent;p.reverse(),s.reverse(),!u&&h&&(b=Mt(b,3,4),s.forEach(function(t,r){s[r]=Mt(t,3,4)})),u&&!h&&p.forEach(function(t,r){p[r]=Mt(t,3,4)}),i||p.forEach(function(t){y=wt(y,t,d)}),s.forEach(function(t,r){var n;S-2===r&&(E=m.slice()),S-1===r&&(x=m.slice()),C(t[d-1])&&(n=function(t,r,n,e,i,o){var a,s=jr(t),u=s[0],c=s[1],f=r.getBoundingClientRect(),l=t.getBoundingClientRect(),p=l.left-f.left+r.scrollLeft,h=l.top-f.top+r.scrollTop,d=l.width,v=l.height,g=Dt(n,i,o),m=Xr(g,u,c,n),b=m.left,y=m.top,E=m.width,x=m.height,S=Ar(g,e,n),M=zt(S,[b,y]),D=[p+M[0]*d/E,h+M[1]*v/x],w=[0,0],C=0;for(;++C<10;){var P=yt(i,n);a=zt(Ar(P,D,n),Ar(P,S,n)),w[0]=a[0],w[1]=a[1];var O=Xr(Dt(n,i,It(w,n),o),u,c,n),z=O.left,R=O.top,B=z-p,_=R-h;if(Math.abs(B)<2&&Math.abs(_)<2)break;D[0]-=B,D[1]-=_}return w.map(function(t){return Math.round(t)})}(t[d-1],M,d,t[2*d-1],m,s[r+1]),t[d-1]=n[0],t[2*d-1]=n[1]),m=wt(m,t,d)});var D=!v&&u;b=b||Tt(D?4:3);var w=(D?"matrix3d":"matrix")+"("+_t(v&&16===b.length?Mt(b,4,3):b)+")";return[y=bt(y,d,d),E,x,m,b,w,f,u||h]}function Gr(t){var r=t.clientWidth,n=t.clientHeight,e=t.viewBox,i=e&&e.baseVal||{x:0,y:0,width:0,height:0};return{x:i.x,y:i.y,width:i.width||r,height:i.height||n}}function Tr(t,r){var n=t.clientWidth,e=t.clientHeight,i=Gr(t),o=i.width,a=i.height,s=n/o,u=e/a,c=t.preserveAspectRatio.baseVal,f=c.align,l=c.meetOrSlice,p=[0,0],h=[s,u],d=[0,0];if(1!==f){var v=(f-2)%3,g=Math.floor((f-2)/3);p[0]=o*v/2,p[1]=a*g/2;var m=2===l?Math.max(u,s):Math.min(s,u);h[0]=m,h[1]=m,d[0]=(n-o)/2*v,d[1]=(e-a)/2*g}var b=At(h,r);return b[r-1]=d[0],b[2*r-1]=d[1],Cr(b,r,p)}function Ar(t,r,n){return Rt(t,St(r,n),n)}function Ir(t,r,n,e){return[Ar(t,[0,0],e),Ar(t,[r,0],e),Ar(t,[0,n],e),Ar(t,[r,n],e)]}function Yr(t){var r=t.map(function(t){return t[0]}),n=t.map(function(t){return t[1]}),e=Math.min.apply(Math,r),i=Math.min.apply(Math,n),o=Math.max.apply(Math,r),a=Math.max.apply(Math,n);return{left:e,top:i,right:o,bottom:a,width:o-e,height:a-i}}function Xr(t,r,n,e){return Yr(Ir(t,r,n,e))}function Nr(t,r,n,e){var i=16===t.length?4:3,o=Ir(t,n,e,i),a=o[0],s=a[0],u=a[1],c=o[1],f=c[0],l=c[1],p=o[2],h=p[0],d=p[1],v=o[3],g=v[0],m=v[1],b=Ar(t,r,i),y=b[0],E=b[1],x=Math.min(s,f,h,g),S=Math.min(u,l,d,m),M=Math.max(s,f,h,g),D=Math.max(u,l,d,m);y=y-x||0,E=E-S||0;var w=[((s=s-x||0)+(f=f-x||0)+(h=h-x||0)+(g=g-x||0))/4,((u=u-S||0)+(l=l-S||0)+(d=d-S||0)+(m=m-S||0))/4],C=xt(w,[s,u]),P=xt(w,[f,l]);return[[x,S,M,D],[y,E],[s,u],[f,l],[h,d],[g,m],C<P&&P-C<Math.PI||P<C&&P-C<-Math.PI?1:-1]}function kr(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Wr(t,r,n){void 0===n&&(n=xt(t,r));var e=function(t,r){return kr([r[0]-t[0],r[1]-t[1]])}(t,r);return{transform:"translateY(-50%) translate("+t[0]+"px, "+t[1]+"px) rotate("+n+"rad)",width:e+"px"}}function Hr(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var e=r.length;return{transform:"translate("+r.reduce(function(t,r){return t+r[0]},0)/e+"px, "+r.reduce(function(t,r){return t+r[1]},0)/e+"px) rotate("+t+"rad)"}}function jr(t,r,n,e){void 0===r&&(r=window.getComputedStyle(t)),void 0===e&&(e=n||"border-box"===r.boxSizing);var i=t.offsetWidth,o=t.offsetHeight,a=!k(i);if((n||e)&&a)return[i,o];if(i=t.clientWidth,o=t.clientHeight,a||i||o)return n||e?[i+(parseFloat(r.borderLeftWidth)||0)+(parseFloat(r.borderRightWidth)||0),o+(parseFloat(r.borderTopWidth)||0)+(parseFloat(r.borderBottomWidth)||0)]:[i-(parseFloat(r.paddingLeft)||0)-(parseFloat(r.paddingRight)||0),o-(parseFloat(r.paddingTop)||0)-(parseFloat(r.paddingBottom)||0)];var s=t.getBBox();return[s.width,s.height]}function Lr(t,r){return xt(0<r?t[0]:t[1],0<r?t[1]:t[0])}function Fr(t,r,n,e,i){var o,a,s,u,c,f=0,l=0,p=0,h=0,d=[0,0],v=[0,0],g=[0,0],m=[0,0],b=[0,0],y=Dr(),E=Dr(),x=Dr(),S=Dr(),M=Dr(),D=0,w=0,C=[0,0],P=1,O=1,z=!1,R="",B=[0,0],_={left:0,right:0,top:0,bottom:0,width:0,height:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},G={left:0,right:0,top:0,bottom:0,width:0,height:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},T=0,A=i?i.beforeMatrix:void 0,I=i?i.rootMatrix:void 0,Y=i?i.is3d?4:3:void 0;if(t){if(i)D=i.width,w=i.height;else{var X=en(t);D=t.offsetWidth,w=t.offsetHeight,k(D)&&(D=(o=jr(t,X,!0))[0],w=o[1])}y=(a=_r(t,r,e,A,I,Y))[0],x=a[1],E=a[2],S=a[3],M=a[4],R=a[5],C=a[6],z=a[7],f=(u=(s=Nr(S,C,D,w))[0])[0],l=u[1],p=u[2],h=u[3],d=s[1],v=s[2],g=s[3],m=s[4],b=s[5],P=s[6];var N;N=(c=Nr(E,Ot(C,function(t,r){void 0===r&&(r=Math.sqrt(t.length));for(var n=[],e=0;e<r-1;++e)n[e]=t[(e+1)*r-1];return n[r-1]=0,n}(M,z?4:3)),D,w))[0],B=c[1],O=c[6],B=[B[0]+N[0]-f,B[1]+N[1]-l],_=qr(t),G=qr(zr(n,n,!0).offsetParent||document.body,!0),T=Lr([v,g],P)}return{rotation:T,targetClientRect:_,containerClientRect:G,beforeDirection:O,direction:P,target:t,left:f,top:l,right:p,bottom:h,pos1:v,pos2:g,pos3:m,pos4:b,width:D,height:w,rootMatrix:y,beforeMatrix:x,offsetMatrix:E,targetMatrix:M,matrix:S,targetTransform:R,is3d:z,beforeOrigin:B,origin:d,transformOrigin:C}}function qr(t,r){var n=t.getBoundingClientRect(),e=n.left,i=n.width,o=n.top,a=n.bottom,s={left:e,right:n.right,top:o,bottom:a,width:i,height:n.height};return r&&(s.clientLeft=t.clientLeft,s.clientTop=t.clientTop,s.clientWidth=t.clientWidth,s.clientHeight=t.clientHeight,s.scrollWidth=t.scrollWidth,s.scrollHeight=t.scrollHeight),s}function Vr(t){if(t){var r=t.getAttribute("data-direction");if(r){var n=[0,0];return-1<r.indexOf("w")&&(n[0]=-1),-1<r.indexOf("e")&&(n[0]=1),-1<r.indexOf("n")&&(n[1]=-1),-1<r.indexOf("s")&&(n[1]=1),n}}}function Ur(t,r){return[Ot(r,t[0]),Ot(r,t[1]),Ot(r,t[2]),Ot(r,t[3])]}function Kr(t){var r=t.left,n=t.top;return Ur([t.pos1,t.pos2,t.pos3,t.pos4],[r,n])}function $r(t){return Math.round(t%1==-.5?t-1:t)}function Jr(t,r){return r?Math.round(t/r)*r:t}function Zr(n,e){return n.forEach(function(t,r){n[r]=Jr(n[r],e)}),n}function Qr(t,r){t[r]&&(t[r].unset(),t[r]=null)}function tn(t,r,n){return(t[0]-r[0])*(n[1]-r[1])-(t[1]-r[1])*(n[0]-r[0])}function rn(t,r,n){var e=r.datas;return e.datas||(e.datas={}),fr({},n,{target:t.state.target,clientX:r.clientX,clientY:r.clientY,inputEvent:r.inputEvent,currentTarget:t,datas:e.datas})}function nn(t,r,n,e){return e&&En.prototype.triggerEvent.call(t,r,n),t.triggerEvent(r,n)}function en(t,r){return window.getComputedStyle(t,r)}function on(t,n,e){var i={},o={};return t.filter(function(r){var t=r.name;if(i[t]||!n.some(function(t){return r[t]}))return!1;if(!e&&r.ableGroup){if(o[r.ableGroup])return!1;o[r.ableGroup]=!0}return i[t]=!0})}function an(t,r,n){return t*(r?n:1/n)}function sn(t,r,n){return t*(r?1/n:n)}function un(t,r){return t===r||null==t&&null==r}function cn(o,a){var s=[],u=[];return o.forEach(function(t,r){var n=a(t,r,o),e=u.indexOf(n),i=s[e]||[];-1===e&&(u.push(n),s.push(i)),i.push(t)}),s}function fn(t){return t.reduce(function(t,r){return t.concat(r)},[])}function ln(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return t.sort(function(t,r){return Math.abs(r)-Math.abs(t)}),t[0]}function pn(t,r){var n,e=t.is3d?4:3;return n=Rt(yt(t.rootMatrix,e),St([r.distX,r.distY],e),e),r.distX=n[0],r.distY=n[1],r}function hn(i,t,r,n,e,o,a){var s="Start"===e;if(s&&-1<n.indexOf("Control")&&!o.isRequest&&i.areaElement===o.inputEvent.target)return!1;var u=""+r+n+e,c=""+r+n+"Condition",f="End"===e,l=-1<e.indexOf("After");s&&i.updateRect(e,!0,!1),""!==e||l||pn(i.state,o);var p=-1<n.indexOf("Group"),h=i[t].filter(function(t){return t[u]}),d=o.datas,v=d.render||(d.render={}),g=fr({},o,{datas:v,originalDatas:d}),m=h.filter(function(t){var r=s&&t[c],n=t.name,e=d[n]||(d[n]={});return!(r&&!r(o,i))&&t[u](i,fr({},o,{datas:e,originalDatas:d}))}),b=m.length;if(s){if(h.length&&!b)return i.state.dragger=null,i.moveables&&i.moveables.forEach(function(t){t.state.dragger=null}),!1;!function(t,r,n){var e=rn(t,n,{isPinch:!!n.isPinch}),i=r?"Group":"";r&&(e.targets=t.props.targets),nn(t,"onRender"+i+"Start",e)}(i,p,g)}else f?function(t,r,n){var e=rn(t,n,{isPinch:!!n.sPinch,isDrag:n.isDrag}),i=r?"Group":"";r&&(e.targets=t.props.targets),nn(t,"onRender"+i+"End",e)}(i,p,g):b&&function(t,r,n){var e=rn(t,n,{isPinch:!!n.isPinch}),i=r?"Group":"";r&&(e.targets=t.props.targets),nn(t,"onRender"+i,e)}(i,p,g);f&&(i.state.dragger=null),i.isUnmounted||(!s&&b&&(m.some(function(t){return t.updateRect})&&!p?i.updateRect(e,!1,!1):i.updateRect(e,!0,!1)),(!s&&b||f&&!b)&&!a&&i.forceUpdate(),s||f||l||!b||hn(i,t,r,n,e+"After",o))}function dn(n,t,r){var e=n.controlBox.getElement();return vn(n,e,t,r,{dragstart:function(t){var r=t.inputEvent.target;return r===n.areaElement||-1<r.className.indexOf("moveable-area")},pinchstart:function(t){var r=t.inputEvent.target;return r===n.areaElement||-1<r.className.indexOf("moveable-area")}})}function vn(i,t,o,a,s){void 0===s&&(s={});var u={container:window,pinchThreshold:i.props.pinchThreshold};return["drag","pinch"].forEach(function(e){["Start","","End"].forEach(function(r){var n=""+e+r.toLowerCase();u[n]=function(t){return!(s[n]&&!s[n](t))&&hn(i,o,e,a,r,t)}})}),new tr(t,u)}var gn,mn,bn=(gn="div",mn=kt(gr),function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return function(t,r){function n(){this.constructor=t}Wt(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}(r,t),r.prototype.render=function(){var t=this.props,r=t.className,n=void 0===r?"":r,e=function(t,r){var n={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&r.indexOf(e)<0&&(n[e]=t[e]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(e=Object.getOwnPropertySymbols(t);i<e.length;i++)r.indexOf(e[i])<0&&Object.prototype.propertyIsEnumerable.call(t,e[i])&&(n[e[i]]=t[e[i]])}return n}(t,["className"]);return I(gn,Ht({ref:tt(this,"element"),className:n+" "+mn.className},e))},r.prototype.componentDidMount=function(){this.injectResult=mn.inject(this.element)},r.prototype.componentWillUnmount=function(){this.injectResult.destroy(),this.injectResult=null},r.prototype.getElement=function(){return this.element},r}(q));function yn(t,r,n,e){var i=xt(r,n),o=t?Jr(i/Math.PI*180,15)%180:-1;return I("div",{key:"line"+e,className:Mr("line","direction",t),"data-rotation":o,"data-direction":t,style:Wr(r,n,i)})}var En=function(r){function t(){var t=null!==r&&r.apply(this,arguments)||this;return t.state={container:null,target:null,beforeMatrix:Dr(),matrix:Dr(),targetMatrix:Dr(),targetTransform:"",is3d:!1,left:0,top:0,width:0,height:0,transformOrigin:[0,0],direction:1,beforeDirection:1,beforeOrigin:[0,0],origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],targetClientRect:{left:0,right:0,top:0,bottom:0,width:0,height:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},containerClientRect:{left:0,right:0,top:0,bottom:0,width:0,height:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0},rotation:0},t.targetAbles=[],t.controlAbles=[],t.isUnmounted=!1,t}cr(t,r);var n=t.prototype;return n.render=function(){var t=this.props,r=this.props,n=r.edge,e=r.parentPosition,i=r.className,o=r.target,a=r.zoom;this.checkUpdate();var s=e||{left:0,top:0},u=s.left,c=s.top,f=this.state,l=f.left,p=f.top,h=f.pos1,d=f.pos2,v=f.pos3,g=f.pos4,m=f.target,b=f.direction,y=t.targets,E=(y&&y.length||o)&&m;return I(bn,{ref:tt(this,"controlBox"),className:Mr("control-box",-1===b?"reverse":"")+" "+i,style:{position:"absolute",display:E?"block":"none",transform:"translate("+(l-u)+"px, "+(p-c)+"px) translateZ(50px)","--zoom":a,"--zoompx":a+"px"}},this.renderAbles(),yn(n?"n":"",h,d,0),yn(n?"e":"",d,g,1),yn(n?"w":"",h,v,2),yn(n?"s":"",v,g,3))},n.componentDidMount=function(){this.controlBox.getElement();var t=this.props,r=t.parentMoveable,n=t.container;this.updateEvent(t),n||r||this.updateRect("End",!1,!0)},n.componentDidUpdate=function(t){this.updateEvent(t)},n.componentWillUnmount=function(){this.isUnmounted=!0,Qr(this,"targetDragger"),Qr(this,"controlDragger")},n.getContainer=function(){var t=this.props,r=t.parentMoveable;return t.container||r&&r.getContainer()||this.controlBox.getElement().parentElement},n.isMoveableElement=function(t){return t&&-1<(t.getAttribute("class")||"").indexOf(vr)},n.dragStart=function(t){this.targetDragger&&this.targetDragger.onDragStart(t)},n.isInside=function(t,r){var n=this.state,e=n.pos1,i=n.pos2,o=n.pos3,a=n.pos4,s=n.target,u=n.targetClientRect;return!!s&&function(t,r,n,e,i){var o=[tn(t,r,n),tn(t,n,i),tn(t,i,r)],a=[tn(t,n,i),tn(t,i,e),tn(t,e,n)];return!!(o.every(function(t){return 0<=t})||o.every(function(t){return t<=0})||a.every(function(t){return 0<=t})||a.every(function(t){return t<=0}))}([t-u.left,r-u.top],e,i,a,o)},n.updateRect=function(t,r,n){void 0===n&&(n=!0);var e=this.props,i=e.parentMoveable,o=this.state,a=o.target||this.props.target,s=this.getContainer(),u=i?i.props.rootContainer:e.rootContainer;this.updateState(Fr(a,s,s,u||s,r?o:void 0),!i&&n)},n.updateEvent=function(t){var r=this.controlBox.getElement(),n=this.targetAbles.length,e=this.controlAbles.length,i=this.props.target,o=t.target,a=this.props.dragArea,s=t.dragArea,u=!a&&o!==i,c=!n&&this.targetDragger||u||s!==a;c&&(Qr(this,"targetDragger"),this.updateState({dragger:null})),e||Qr(this,"controlDragger"),i&&n&&!this.targetDragger&&(this.targetDragger=a?dn(this,"targetAbles",""):vn(this,i,"targetAbles","")),!this.controlDragger&&e&&(this.controlDragger=vn(this,r,"controlAbles","Control")),c&&this.unsetAbles()},n.isDragging=function(){return!!this.targetDragger&&this.targetDragger.isFlag()||!!this.controlDragger&&this.controlDragger.isFlag()},n.updateTarget=function(t){this.updateRect(t,!0)},n.getRect=function(){var t=this.state,r=Kr(this.state),n=r[0],e=r[1],i=r[2],o=r[3],a=Yr(r),s=t.width,u=t.height,c=a.width,f=a.height,l=a.left,p=a.top,h=[t.left,t.top],d=Ot(h,t.origin);return{width:c,height:f,left:l,top:p,pos1:n,pos2:e,pos3:i,pos4:o,offsetWidth:s,offsetHeight:u,beforeOrigin:Ot(h,t.beforeOrigin),origin:d}},n.request=function(r,t,n){void 0===t&&(t={});var e=this.props,i=e.ables,o=e.groupable,a=i.filter(function(t){return t.name===r})[0];if(this.isDragging()||!a||!a.request)return{request:function(){return this},requestEnd:function(){return this}};var s=this,u=a.request(this),c=u.isControl?"controlAbles":"targetAbles",f=(o?"Group":"")+(u.isControl?"Control":""),l={request:function(t){return hn(s,c,"drag",f,"",fr({},u.request(t),{isRequest:!0}),n),this},requestEnd:function(){return hn(s,c,"drag",f,"End",fr({},u.requestEnd(),{isRequest:!0})),this}};return hn(s,c,"drag",f,"Start",fr({},u.requestStart(t),{isRequest:!0}),n),t.isInstant?l.request(t).requestEnd():l},n.checkUpdate=function(){var t=this.props,r=t.target,n=t.container,e=t.parentMoveable,i=this.state,o=i.target,a=i.container;(o||r)&&(this.updateAbles(),un(o,r)&&un(a,n)||(this.updateState({target:r,container:n}),e||!n&&!this.controlBox||this.updateRect("End",!1,!1)))},n.triggerEvent=function(t,r){var n=this.props[t];return n&&n(r)},n.unsetAbles=function(){var r=this;this.targetAbles.filter(function(t){return!!t.unset&&(t.unset(r),!0)}).length&&this.forceUpdate()},n.updateAbles=function(t,r){void 0===t&&(t=this.props.ables),void 0===r&&(r="");var n=this.props,e=n.triggerAblesSimultaneously,i=t.filter(function(t){return t&&n[t.name]}),o="drag"+r+"ControlStart",a=on(i,["drag"+r+"Start","pinch"+r+"Start"],e),s=on(i,[o],e);this.targetAbles=a,this.controlAbles=s},n.updateState=function(t,r){if(r)this.setState(t);else{var n=this.state;for(var e in t)n[e]=t[e]}},n.renderAbles=function(){var r=this,n=this.props,t=n.ables,e=n.triggerAblesSimultaneously,i=t.filter(function(t){return t&&n[t.name]}),o={createElement:I};return function(i,o){var a=[],s={};return i.forEach(function(t,r){var n=o(t,r,i),e=s[n];e||(e=[],s[n]=e,a.push(e)),e.push(t)}),a}(fn(on(i,["render"],e).map(function(t){return(0,t.render)(r,o)||[]})).filter(function(t){return t}),function(t){return t.key}).map(function(t){return t[0]})},t.defaultProps={target:null,container:null,rootContainer:null,origin:!0,edge:!1,parentMoveable:null,parentPosition:null,ables:[],pinchThreshold:20,dragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1},t}(V);function xn(t){return xt([t[0].clientX,t[0].clientY],[t[1].clientX,t[1].clientY])/Math.PI*180}var Sn={name:"pinchable",updateRect:!0,props:{pinchable:Boolean,pinchThreshold:Number},pinchStart:function(n,e){var i=e.datas,t=e.touches,r=e.targets,o=n.props,a=o.pinchable,s=o.ables;if(!a)return!1;var u="onPinch"+(r?"Group":"")+"Start",c="drag"+(r?"Group":"")+"ControlStart",f=(!0===a?n.controlAbles:s.filter(function(t){return-1<a.indexOf(t.name)})).filter(function(t){return t.canPinch&&t[c]}),l=rn(n,e,{});r&&(l.targets=r);var p=nn(n,u,l);i.isPinch=!1!==p,i.ables=f;var h=i.isPinch;if(!h)return!1;var d=xn(t);return f.forEach(function(t){if(i[t.name+"Datas"]={},t[c]){var r=fr({},e,{datas:i[t.name+"Datas"],parentRotate:d,isPinch:!0});t[c](n,r)}}),n.state.snapRenderInfo={direction:[0,0]},h},pinch:function(r,n){var e=n.datas,t=n.scale,i=n.distance,o=n.touches,a=n.inputEvent,s=n.targets;if(e.isPinch){var u=xn(o),c=i*(1-1/t),f=rn(r,n,{});s&&(f.targets=s),nn(r,"onPinch"+(s?"Group":""),f);var l=e.ables,p="drag"+(s?"Group":"")+"Control";return l.forEach(function(t){t[p]&&t[p](r,fr({},n,{datas:e[t.name+"Datas"],inputEvent:a,parentDistance:c,parentRotate:u,isPinch:!0}))}),f}},pinchEnd:function(r,n){var e=n.datas,i=n.isPinch,o=n.inputEvent,t=n.targets;if(e.isPinch){var a="onPinch"+(t?"Group":"")+"End",s=rn(r,n,{isDrag:i});t&&(s.targets=t),nn(r,a,s);var u=e.ables,c="drag"+(t?"Group":"")+"ControlEnd";return u.forEach(function(t){t[c]&&t[c](r,fr({},n,{isDrag:i,datas:e[t.name+"Datas"],inputEvent:o,isPinch:!0}))}),i}},pinchGroupStart:function(t,r){return this.pinchStart(t,fr({},r,{targets:t.props.targets}))},pinchGroup:function(t,r){return this.pinch(t,fr({},r,{targets:t.props.targets}))},pinchGroupEnd:function(t,r){return this.pinchEnd(t,fr({},r,{targets:t.props.targets}))}};function Mn(t,r,n,e,i){var o=t.dragger.move(r,n),a=o.originalDatas||o.datas,s=a.draggable||(a.draggable={});return fr({},i?pn(t,o):o,{isDrag:!0,isPinch:!!e,parentEvent:!0,datas:s})}var Dn=function(){function t(){this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}}}var r=t.prototype;return r.dragStart=function(t,r){return this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.move(t,r)},r.drag=function(t,r){return this.move([t[0]-this.prevX,t[1]-this.prevY],r)},r.move=function(t,r){var n,e;return this.isFlag?(n=this.prevX+t[0],e=this.prevY+t[1],this.isDrag=!0):(this.prevX=t[0],this.prevY=t[1],this.startX=t[0],this.startY=t[1],n=t[0],e=t[1],this.isFlag=!0),{clientX:this.prevX=n,clientY:this.prevY=e,inputEvent:r,isDrag:this.isDrag,distX:n-this.startX,distY:e-this.startY,deltaX:t[0],deltaY:t[1],datas:this.datas.draggable,originalDatas:this.datas,parentEvent:!0,parentDragger:this}},t}();function wn(t,i,o,a,r,s){var u=!!o.match(/Start$/g),c=!!o.match(/End$/g),f=r.inputEvent,l=r.isPinch,p=r.datas,n=t.moveables.map(function(t,r){var n={};n=u?(new Dn).dragStart(a,f):(t.state.dragger||(t.state.dragger=p.childDraggers[r]),Mn(t.state,a,f,l,s));var e=i[o](t,fr({},n,{parentFlag:!0}));return c&&(t.state.dragger=null),e});return u&&(p.childDraggers=t.moveables.map(function(t){return t.state.dragger})),n}function Cn(t,o,a,r,s,u){var n=o.name,c=r[n]||(r[n]=[]),f=!!a.match(/End$/g);return t.moveables.map(function(t,r){var n=c[r]||(c[r]={}),e=function(t){return typeof t===l}(s)?s(t,n):s,i=o[a](t,fr({},e,{datas:n,parentFlag:!0}));return i&&u&&u(t,n,i,r),f&&(t.state.dragger=null),i})}function Pn(t,r){var n=r.datas,e=t.state,i=e.matrix,o=e.beforeMatrix,a=e.is3d,s=e.left,u=e.top,c=e.origin,f=e.offsetMatrix,l=e.targetMatrix,p=e.transformOrigin,h=a?4:3;n.is3d=a,n.matrix=i,n.targetMatrix=l,n.beforeMatrix=o,n.offsetMatrix=f,n.transformOrigin=p,n.inverseMatrix=yt(i,h),n.inverseBeforeMatrix=yt(o,h),n.absoluteOrigin=St(Ot([s,u],c),h),n.startDragBeforeDist=Rt(n.inverseBeforeMatrix,n.absoluteOrigin,h),n.startDragDist=Rt(n.inverseMatrix,n.absoluteOrigin,h)}function On(t,r){var n=t.datas,e=t.distX,i=t.distY,o=n.inverseBeforeMatrix,a=n.inverseMatrix,s=n.is3d,u=n.startDragBeforeDist,c=n.startDragDist,f=s?4:3;return zt(Rt(r?o:a,Ot(n.absoluteOrigin,[e,i]),f),r?u:c)}function zn(t){var r=[];return 0<=t[1]&&(0<=t[0]&&r.push(3),t[0]<=0&&r.push(2)),t[1]<=0&&(0<=t[0]&&r.push(1),t[0]<=0&&r.push(0)),r}function Rn(r,t){return zn(t).map(function(t){return r[t]})}function Bn(t,r){var n=Rn(t,r);return[Pt.apply(void 0,n.map(function(t){return t[0]})),Pt.apply(void 0,n.map(function(t){return t[1]}))]}function _n(t,r){var n=t[0],e=t[1],i=t[2];return Bn([t[3],i,e,n],r)}function Gn(t,r,n,e,i,o){var a=_n(Ir(r,n,e,i),o);return[t[0]-a[0],t[1]-a[1]]}function Tn(t,r,n,e){return wt(t,Cr(r,e,n),e)}function An(t,r){var n=t.transformOrigin,e=t.offsetMatrix,i=t.is3d?4:3;return Tn(e,wt(t.targetMatrix,At(r,i),i),n,i)}function In(t,r,n,e,i,o){var a=t.props.groupable,s=t.state,u=s.transformOrigin,c=s.targetMatrix,f=s.offsetMatrix,l=s.is3d,p=s.width,h=s.height,d=s.left,v=s.top,g=l?4:3,m=a?d:0,b=a?v:0;return zt(Gn(i,Tn(f,c,function(t,s,u,c,f,l){return void 0===c&&(c=s),void 0===f&&(f=u),void 0===l&&(l=[0,0]),t?t.map(function(t,r){var n=S(t),e=n.value,i=n.unit,o=r?f:c,a=r?u:s;return"%"===t||isNaN(e)?a*(o?l[r]/o:0):"%"!==i?e:a*e/100}):l}(o,r,n,p,h,u),g),r,n,g,e),[m,b])}function Yn(t,r){return function(t,r){return _n([t[0],t[1],t[2],t[3]],r)}(Kr(t.state),r)}function Xn(t){return t.isRequest?t.parentDirection:g(t.inputEvent.target,Mr("direction"))}function Nn(t,r,p,h,n,e){var d=n[0],v=n[1],i=e[0],o=e[1],g=[],a=h?0:1,m="vertical"===r?"horizontal":"vertical",b=cn(t.filter(function(t){return t.type===r}),function(t){return t.element}).map(function(t){return t[0]}).filter(function(t){var r=t.pos,n=t.sizes;return r[a]<=o&&i<=r[a]+n[a]});return b.forEach(function(t){var f=t.pos[h],l=f+t.sizes[h];b.forEach(function(t){var r=t.pos,n=t.sizes,e=t.element,i=r[h],o=i+n[h],a=0,s=0,u=!0;if(l<=i)d<(a=o-(s=l-i))-p&&(u=!1);else{if(!(o<=f))return;(a=i-(s=f-o))+p<v&&(u=!1)}if(u&&g.push({pos:"vertical"==m?[a,r[1]]:[r[0],a],element:e,sizes:n,size:0,type:m,gap:s,gapGuidelines:b}),l<=d&&v<=i){var c=(i+l-(v-d))/2;0<=Jr(d-(c-p),.1)&&g.push({pos:"vertical"==m?[c,r[1]]:[r[0],c],element:e,sizes:n,size:0,type:m,gap:l-d,gapGuidelines:b})}})}),g}function kn(t,r,n,e,i){var o=function(t){var r=t.state,n=r.guidelines,e=r.containerClientRect,i=e.scrollHeight,o=e.scrollWidth,a=t.props,s=a.snapHorizontal,u=void 0===s||s,c=a.snapVertical,f=void 0===c||c,l=a.snapGap,p=void 0===l||l,h=a.verticalGuidelines,d=a.horizontalGuidelines,v=a.snapThreshold,g=void 0===v?5:v,m=n.slice();if(p){var b=Yr(Kr(t.state)),y=b.top,E=b.left,x=b.bottom,S=b.right,M=n.filter(function(t){return t.element});m.push.apply(m,Nn(M,"horizontal",g,0,[E,S],[y,x]).concat(Nn(M,"vertical",g,1,[y,x],[E,S])))}return u&&d&&d.forEach(function(t){m.push({type:"horizontal",pos:[0,Jr(t,.1)],size:o})}),f&&h&&h.forEach(function(t){m.push({type:"vertical",pos:[Jr(t,.1),0],size:i})}),m}(t),a=t.props,s=a.snapElement,u=void 0===s||s,c=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var n=t.length-1,e=0;e<n;++e){var i=t[e];if(!k(i))return i}return t[n]}(i,a.snapThreshold,5);return{vertical:Hn(o,"vertical",r,c,e,u),horizontal:Hn(o,"horizontal",n,c,e,u)}}function Wn(t){var r=t.isSnap;if(!r)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var n=t.posInfos[0],e=n.guidelineInfos[0],i=e.offset,o=e.dist,a=e.guideline;return{isSnap:r,offset:i,dist:o,pos:n.pos,guideline:a}}function Hn(r,a,t,s,u,c){if(!r||!r.length)return{isSnap:!1,posInfos:[]};var i="vertical"===a?0:1,n=t.map(function(e){var t=r.map(function(t){var r=t.pos,n=e-r[i];return{offset:n,dist:Math.abs(n),guideline:t}}).filter(function(t){var r=t.guideline,n=t.dist,e=r.type,i=r.center,o=r.element;return!(!c&&o||!u&&i||e!==a||s<n)}).sort(function(t,r){return t.dist-r.dist});return{pos:e,guidelineInfos:t}}).filter(function(t){return 0<t.guidelineInfos.length}).sort(function(t,r){return t.guidelineInfos[0].dist-r.guidelineInfos[0].dist});return{isSnap:0<n.length,posInfos:n}}function jn(t,u){return t.slice().sort(function(t,r){var n=t.sign[u],e=r.sign[u],i=t.offset[u],o=r.offset[u],a=Math.abs(i),s=Math.abs(o);return n?e?t.isBound&&r.isBound?s-a:t.isBound?-1:r.isBound?1:t.isSnap&&r.isSnap?a-s:t.isSnap?-1:r.isSnap?1:a<br?1:s<br?-1:a-s:-1:1})[0]}function Ln(t,r){var n=Pt(r[0][0],r[1][0]),e=Pt(r[0][1],r[1][1]);return{vertical:n<=t[0],horizontal:e<=t[1]}}function Fn(t,r){var n,e,i=r[0],o=r[1],a=o[0]-i[0],s=o[1]-i[1];if(a)if(s){n=s/a*(t[0]-i[0])+i[1],e=t[1]}else n=i[1],e=t[1];else n=i[0],e=t[0];return n-e}function qn(t,n,e){void 0===e&&(e=br);var i=Fn(t[0],n)<=0;return t.slice(1).every(function(t){var r=Fn(t,n);return r<=0==i||Math.abs(r)<=e})}function Vn(t,r,n,e,i){return void 0===i&&(i=0),e&&r-i<=t||!e&&t<=n+i?{isBound:!0,offset:e?r-t:n-t}:{isBound:!1,offset:0}}function Un(t,r,n,e){var i=t[0],o=t[1],a=r[0],s=r[1],u=o[1]-i[1],c=o[0]-i[0],f=s[1]-a[1];if(s[0]-a[0]){if(!f&&u){var l=u/c;return Vn(c?(a[1]-i[1])/l+i[0]:i[0],a[0],s[0],n,e)}}else if(c)return Vn(u?u/c*(a[0]-i[0])+i[1]:i[1],a[1],s[1],n,e);return{isBound:!1,offset:0}}function Kn(f,t,l,p){return t.map(function(t){var n=t[0],r=t[1],e=t[2],i=function(t,r,n){var e=t.props.innerBounds;if(!e)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var i=e.left,o=e.top,a=e.width,s=e.height,u=[[i,o],[i,o+s]],c=[[i,o],[i+a,o]],f=[[i+a,o],[i+a,o+s]],l=[[i,o+s],[i+a,o+s]],p=Ln(n,r),h=p.horizontal,d=p.vertical;if(qn([n,[i,o],[i+a,o],[i,o+s],[i+a,o+s]],r))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var v=Un(r,c,d),g=Un(r,l,d),m=Un(r,u,h),b=Un(r,f,h),y=v.isBound&&g.isBound,E=v.isBound||g.isBound,x=m.isBound&&b.isBound,S=m.isBound||b.isBound,M=ln(v.offset,g.offset),D=ln(m.offset,b.offset),w=[0,0],C=!1;return{isAllBound:Math.abs(D)<Math.abs(M)?(w=[M,0],C=E,y):(w=[0,D],C=S,x),isVerticalBound:E,isHorizontalBound:S,isBound:C,offset:w}}(f,[r,e],l),o=i.isBound,a=i.offset,s=i.isVerticalBound,u=i.isHorizontalBound,c=On({datas:p,distX:a[0],distY:a[1]}).map(function(t,r){return t*(n[r]?2/n[r]:0)});return{sign:n,isBound:o,isVerticalBound:s,isHorizontalBound:u,isSnap:!1,offset:c}})}function $n(t,r,n){var e,i=Kn(t,Jn(r,[0,0],!1).map(function(t){var r=t[0],n=t[1],e=t[2];return[r.map(function(t){return 2*Math.abs(t)}),n,e]}),Bn(r,[0,0]),n),o=jn(i,0),a=jn(i,1),s=0,u=0,c=o.isVerticalBound||a.isVerticalBound,f=o.isHorizontalBound||a.isHorizontalBound;return(c||f)&&(s=(e=function(t,r){var n=t.datas,e=t.distX,i=t.distY,o=n.beforeMatrix,a=n.matrix,s=n.is3d,u=n.startDragBeforeDist,c=n.startDragDist,f=n.absoluteOrigin,l=s?4:3;return zt(Rt(r?o:a,Ot(r?u:c,[e,i]),l),f)}({datas:n,distX:-o.offset[0],distY:-a.offset[1]}))[0],u=e[1]),{vertical:{isBound:c,offset:s},horizontal:{isBound:f,offset:u}}}function Jn(i,t,r){return function(t,r){var n=[],e=t[0],i=t[1];return e&&i?n.push([[0,2*i],t,[-e,i]],[[2*e,0],t,[e,-i]]):e?(n.push([[2*e,0],[e,1],[e,-1]]),r&&n.push([[0,-1],[e,-1],[-e,-1]],[[0,1],[e,1],[-e,1]])):i?(n.push([[0,2*i],[1,i],[-1,i]]),r&&n.push([[-1,0],[-1,i],[-1,-i]],[[1,0],[1,i],[1,-i]])):n.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),n}(t,r).map(function(t){var r=t[0],n=t[1],e=t[2];return[r,Bn(i,n),Bn(i,e)]})}function Zn(t,r,n,e){var i=e?t.map(function(t){return Bt(t,e)}):t,o=[n].concat(r);return[[i[0],i[1]],[i[1],i[3]],[i[3],i[2]],[i[2],i[0]]].some(function(t,r){return!qn(o,t)})}function Qn(t,r,n,e,i){var o=t.props.innerBounds,a=i*Math.PI/180;if(!o)return[];var s=o.left,u=o.top,c=o.width,f=o.height,l=s-e[0],p=s+c-e[0],h=u-e[1],d=u+f-e[1],v=[[l,h],[p,h],[l,d],[p,d]],g=Bn(n,[0,0]);if(!Zn(n,v,g,0))return[];var m=[],b=v.map(function(t){return[kr(t),xt([0,0],t)]});return[[n[0],n[1]],[n[1],n[3]],[n[3],n[2]],[n[2],n[0]]].forEach(function(t){var i=xt([0,0],function(t){var r=t[0],n=t[1],e=n[0]-r[0],i=n[1]-r[1];if(!e)return[r[0],0];if(!i)return[0,r[1]];var o=i/e,a=-o*r[0]+r[1];return[-a/(o+1/o),a/(o*o+1)]}(t)),o=function(t){var r=t[0],n=t[1],e=n[0]-r[0],i=n[1]-r[1];if(!e)return Math.abs(r[0]);if(!i)return Math.abs(r[1]);var o=i/e;return Math.abs((-o*r[0]+r[1])/Math.sqrt(Math.pow(o,2)+1))}(t);m.push.apply(m,b.filter(function(t){var r=t[0];return r&&o<=r}).map(function(t){var r=t[0],n=t[1],e=Math.acos(r?o/r:0);return[a+(n+e)-i,a+(n-e)-i]}).reduce(function(t,r){return t.push.apply(t,r),t},[]).filter(function(t){return!Zn(r,v,g,t)}).map(function(t){return Jr(180*t/Math.PI,br)}))}),m}function te(t,r,n){var e=t.props.bounds||{},i=e.left,o=void 0===i?-1/0:i,a=e.top,s=void 0===a?-1/0:a,u=e.right,c=void 0===u?1/0:u,f=e.bottom,l={left:o,top:s,right:c,bottom:void 0===f?1/0:f};return{vertical:re(l,r,!0),horizontal:re(l,n,!1)}}function re(t,r,n){var e=t[n?"left":"top"],i=t[n?"right":"bottom"],o=Math.min.apply(Math,r),a=Math.max.apply(Math,r);return o<e+1?{isBound:!0,offset:o-e,pos:e}:i-1<a?{isBound:!0,offset:a-i,pos:i}:{isBound:!1,offset:0,pos:0}}function ne(t,r,n){return(n?t.map(function(t){return Bt(t,n)}):t).some(function(t){return t[0]<r.left&&.1<Math.abs(t[0]-r.left)||t[0]>r.right&&.1<Math.abs(t[0]-r.right)||t[1]<r.top&&.1<Math.abs(t[1]-r.top)||t[1]>r.bottom&&.1<Math.abs(t[1]-r.bottom)})}function ee(t,i,o,r,n){var e=t.props.bounds,a=n*Math.PI/180;if(!e)return[];var s=e.left,u=void 0===s?-1/0:s,c=e.top,f=void 0===c?-1/0:c,l=e.right,p=void 0===l?1/0:l,h=e.bottom,d=void 0===h?1/0:h,v=u-r[0],g=p-r[0],m=f-r[1],b=d-r[1],y={left:v,top:m,right:g,bottom:b};if(!ne(o,y,0))return[];var E=[];return[[v,0],[g,0],[m,1],[b,1]].forEach(function(t,r){var n=t[0],e=t[1];o.forEach(function(t){var r=xt([0,0],t);E.push.apply(E,function(n,r,e){var t=kr(n),i=Math.sqrt(t*t-r*r)||0;return[i,-i].sort(function(t,r){return Math.abs(t-n[e?0:1])-Math.abs(r-n[e?0:1])}).map(function(t){return xt([0,0],e?[t,r]:[r,t])})}(t,n,e).map(function(t){return a+t-r}).filter(function(t){return!ne(i,y,t)}).map(function(t){return Jr(180*t/Math.PI,br)}))})}),E}function ie(t){var r=t.state;if(!r.guidelines||!r.guidelines.length){var n=t.props,e=n.horizontalGuidelines,i=void 0===e?[]:e,o=n.verticalGuidelines,a=void 0===o?[]:o,s=n.elementGuidelines,u=void 0===s?[]:s,c=n.bounds,l=n.snapCenter;if(c||i.length||a.length||u.length){var f=r.containerClientRect,p=r.targetClientRect,h=p.top,d=p.left,v=f.left+f.clientLeft,g=f.top+f.clientTop,m=Kr(r),b=Math.min.apply(Math,m.map(function(t){return t[0]})),y=Math.min.apply(Math,m.map(function(t){return t[1]})),E=$r(b-(d-v)),x=$r(y-(h-g)),S=[];u.forEach(function(t){var r=t.getBoundingClientRect(),n=r.top,e=r.left,i=r.width,o=r.height,a=n-g,s=a+o,u=e-v,c=u+i,f=[i,o];S.push({type:"vertical",element:t,pos:[Jr(u+E,.1),a],size:o,sizes:f}),S.push({type:"vertical",element:t,pos:[Jr(c+E,.1),a],size:o,sizes:f}),S.push({type:"horizontal",element:t,pos:[u,Jr(a+x,.1)],size:i,sizes:f}),S.push({type:"horizontal",element:t,pos:[u,Jr(s+x,.1)],size:i,sizes:f}),l&&(S.push({type:"vertical",element:t,pos:[Jr((u+c)/2+E,.1),a],size:o,sizes:f,center:!0}),S.push({type:"horizontal",element:t,pos:[u,Jr((a+s)/2+x,.1)],size:i,sizes:f,center:!0}))}),r.guidelines=S,r.enableSnap=!0}}}function oe(t,r){var n=t.props,e=n.snappable,i=n.bounds,o=n.verticalGuidelines,a=n.horizontalGuidelines,s=t.state,u=s.guidelines,c=s.enableSnap;return!(!e||!c||r&&!0!==e&&e.indexOf(r)<0)&&!!(i||u&&u.length||o&&o.length||a&&a.length)}function ae(t,r,n,e,i){var o=function(t,r,n,e){var i=r[0]-t[0],o=r[1]-t[1];Math.abs(i)<br&&(i=0);Math.abs(o)<br&&(o=0);if(!i)return e?[0,0]:[0,n];if(!o)return e?[n,0]:[0,0];var a=o/i,s=t[1]-a*t[0];{if(e){var u=a*(r[0]+n)+s;return[n,u-r[1]]}return[(r[1]+n-s)/a-r[0],n]}}(t,r,-n,e);if(!o)return[0,0];var a=On({datas:i,distX:o[0],distY:o[1]});return[a[0],a[1]]}function se(t,r,n,e,i,o){var a=Ir(t,r,n,o?4:3);return Ur(a,zt(e,_n(a,i)))}function ue(t,r){return t.isBound?t.offset:r.isSnap?r.offset:0}function ce(t,r){return t.isBound?t.offset:r.isSnap?Wn(r).offset:0}function fe(t,r,n){var e=function(t,r,n){var e=t.props.bounds||{},i=e.left,o=void 0===i?-1/0:i,a=e.top,s=void 0===a?-1/0:a,u=e.right,c=void 0===u?1/0:u,f=e.bottom,l=void 0===f?1/0:f,p=n[0],h=n[1],d=zt(n,r),v=d[0],g=d[1],m=0<g,b=0<v,y={isBound:!1,offset:0,pos:0},E={isBound:!1,offset:0,pos:0};if(0===v&&0===g)return{vertical:y,horizontal:E};if(0===v)m?l<h&&(E.pos=l,E.offset=h-l):h<s&&(E.pos=s,E.offset=h-s);else if(0===g)b?c<p&&(y.pos=c,y.offset=p-c):p<o&&(y.pos=o,y.offset=p-o);else{var x=g/v,S=n[1]-x*p,M=0,D=0,w=!1;b&&c<=p?(M=x*c+S,D=c,w=!0):!b&&p<=o?(M=x*o+S,D=o,w=!0):m&&l<=h?(D=((M=l)-S)/x,w=!0):!m&&h<=s&&(D=((M=s)-S)/x,w=!0),w&&(y.isBound=!0,y.pos=D,y.offset=p-D,E.isBound=!0,E.pos=M,E.offset=h-M)}return{vertical:y,horizontal:E}}(t,r,n),i=e.horizontal,o=e.vertical,a=function(t,r,n){var e=n[0],i=n[1],o=r[0],a=r[1],s=zt(n,r),u=s[0],c=s[1],f=0<c,l=0<u,p={isSnap:!1,offset:0,pos:0},h={isSnap:!1,offset:0,pos:0};if(0===u&&0===c)return{vertical:p,horizontal:h};var d=kn(t,u?[e]:[],c?[i]:[]),v=d.vertical,g=d.horizontal;v.posInfos.filter(function(t){var r=t.pos;return l?o<=r:r<=o}),g.posInfos.filter(function(t){var r=t.pos;return f?a<=r:r<=a}),v.isSnap=0<v.posInfos.length,g.isSnap=0<g.posInfos.length;var m=Wn(v),b=m.isSnap,y=m.guideline,E=Wn(g),x=E.isSnap,S=E.guideline,M=x?S.pos[1]:0,D=b?y.pos[0]:0;if(0===u)x&&(h.isSnap=!0,h.pos=S.pos[1],h.offset=i-h.pos);else if(0===c)b&&(p.isSnap=!0,p.pos=D,p.offset=e-D);else{var w=c/u,C=n[1]-w*e,P=0,O=0,z=!1;b?(P=w*(O=D)+C,z=!0):x&&(O=((P=M)-C)/w,z=!0),z&&(p.isSnap=!0,p.pos=O,p.offset=e-O,h.isSnap=!0,h.pos=P,h.offset=i-P)}return{vertical:p,horizontal:h}}(t,r,n),s=a.horizontal,u=a.vertical,c=ue(i,s),f=ue(o,u),l=Math.abs(c),p=Math.abs(f);return{horizontal:{isBound:i.isBound,isSnap:s.isSnap,offset:c,dist:l},vertical:{isBound:o.isBound,isSnap:u.isSnap,offset:f,dist:p}}}function le(t,r,n){void 0===n&&(n=r);var e=te(t,n.map(function(t){return t[0]}),n.map(function(t){return t[1]})),i=e.horizontal,o=e.vertical,a=kn(t,r.map(function(t){return t[0]}),r.map(function(t){return t[1]})),s=a.horizontal,u=a.vertical,c=ce(i,s),f=ce(o,u),l=Math.abs(c),p=Math.abs(f);return{horizontal:{isBound:i.isBound,isSnap:s.isSnap,offset:c,dist:l},vertical:{isBound:o.isBound,isSnap:u.isSnap,offset:f,dist:p}}}function pe(t,r,n,e,i){var o=function(t,r){var n=[],e=[-t[0],-t[1]];return t[0]&&t[1]?(n.push([e,[t[0],-t[1]]],[e,[-t[0],t[1]]]),r&&n.push([e,t])):t[0]?r?n.push([e,[e[0],-1]],[e,[e[0],1]],[e,[t[0],-1]],[e,t],[e,[t[0],1]]):n.push([[e[0],-1],[t[0],-1]],[[e[0],0],[t[0],0]],[[e[0],1],[t[0],1]]):t[1]?r?n.push([e,[-1,e[1]]],[e,[1,e[1]]],[e,[-1,t[1]]],[e,[1,t[1]]],[e,t]):n.push([[-1,e[1]],[-1,t[1]]],[[0,e[1]],[0,t[1]]],[[1,e[1]],[1,t[1]]]):n.push([e,[1,0]],[e,[-1,0]],[e,[0,-1]],[e,[0,1]],[[1,0],[1,-1]],[[1,0],[1,1]],[[0,1],[1,1]],[[0,1],[-1,1]],[[-1,0],[-1,-1]],[[-1,0],[-1,1]],[[0,-1],[1,-1]],[[0,-1],[-1,-1]]),n}(n,e),a=Jn(r,n,e),s=function(y,E,t,x,S){return t.map(function(t){var r=t[0],n=t[1],e=Bn(E,r),i=Bn(E,n),o=x?fe(y,e,i):le(y,[i]),a=o.horizontal,s=a.dist,u=a.offset,c=a.isBound,f=a.isSnap,l=o.vertical,p=l.dist,h=l.offset,d=l.isBound,v=l.isSnap,g=zt(n,r);if(!h&&!u)return{isBound:d||c,isSnap:v||f,sign:g,offset:[0,0]};var m=s<p,b=ae(e,i,m?h:u,m,S).map(function(t,r){return t*(g[r]?2/g[r]:0)});return{sign:g,isBound:m?d:c,isSnap:m?v:f,offset:b}})}(t,r,o,e,i).concat(Kn(t,a,Bn(r,[0,0]),i)),u=jn(s,0),c=jn(s,1);return{width:{isBound:u.isBound,offset:u.offset[0]},height:{isBound:c.isBound,offset:c.offset[1]}}}function he(t,r,n,e,i,o,a,s){for(var u=Kr(t.state),c=t.props.keepRatio,f=0,l=0,p=0;p<2;++p){var h=pe(t,r(f,l),i,c,s),d=h.width,v=h.height,g=d.isBound,m=v.isBound,b=d.offset,y=v.offset;if(1===p&&(g||(b=0),m||(y=0)),0===p&&a&&!g&&!m)return[0,0];if(c){var E=Math.abs(b)*(n?1/n:1),x=Math.abs(y)*(e?1/e:1);(g&&m?E<x:m||!g&&E<x)?b=n*y/e:y=e*b/n}f+=b,l+=y}if(i[0]&&i[1]){var S=function(t,a,s,u,r,c,f){var l=[-r[0],-r[1]],n=t.props.bounds,p=1/0,h=1/0;if(n){var e=[[r[0],-r[1]],[-r[0],r[1]]],i=n.left,d=void 0===i?-1/0:i,o=n.top,v=void 0===o?-1/0:o,g=n.right,m=void 0===g?1/0:g,b=n.bottom,y=void 0===b?1/0:b;e.forEach(function(t){var r=t[0]!==l[0],n=t[1]!==l[1],e=Bn(u,t);if(n){var i=ae(c,e,(c[1]<e[1]?y:v)-e[1],!1,f)[1];isNaN(i)||(h=s+i)}if(r){var o=ae(c,e,(c[0]<e[0]?m:d)-e[0],!0,f)[0];isNaN(o)||(p=a+o)}})}return{maxWidth:p,maxHeight:h}}(t,n,e,u,i,o,s),M=S.maxWidth,D=S.maxHeight,w=function(t,r,n,e,i,o,a,s){var u=le(t,[Bn(r,a)]),c=u.horizontal.offset,f=u.vertical.offset;if(f||c){var l=On({datas:s,distX:-f,distY:-c}),p=l[0],h=l[1];return[Math.min(i||1/0,n+a[0]*p)-n,Math.min(o||1/0,e+a[1]*h)-e]}return[0,0]}(t,r(f,l),n+f,e+l,M,D,i,s);f+=b=w[0],l+=y=w[1]}return[f,l]}function de(t,r,n,e){if(!oe(t,"rotatable"))return e;var i=r.pos1,o=r.pos2,a=r.pos3,s=r.pos4,u=e*Math.PI/180,c=[i,o,a,s].map(function(t){return zt(t,n)}),f=c.map(function(t){return Bt(t,u)}),l=ee(t,c,f,n,e).concat(Qn(t,c,f,n,e));return l.sort(function(t,r){return Math.abs(t-e)-Math.abs(r-e)}),l.length?l[0]:e}function ve(t,r,n,e,i){if(!oe(t,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var o=Ur(i.absolutePoses,[r,n]),a=Yr(o),s=a.left,u=a.right,c=a.top,f=a.bottom,l=[[s,c],[u,c],[s,f],[u,f]];t.props.snapCenter&&l.push([(s+u)/2,(c+f)/2]);var p=le(t,l,o),h=p.vertical,d=p.horizontal,v=$n(t,o,i),g=v.vertical,m=v.horizontal,b=h.isSnap,y=d.isSnap,E=h.isBound||g.isBound,x=d.isBound||m.isBound,S=function(t,r,n,e,i){var o=r[0],a=r[1],s=n[0],u=n[1],c=e[0],f=e[1],l=i[0],p=i[1],h=-l,d=-p;if(t&&o&&a){d=h=0;var v=[];if(s&&u?v.push([0,p],[l,0]):s?v.push([l,0]):u?v.push([0,p]):c&&f?v.push([0,p],[l,0]):c?v.push([l,0]):f&&v.push([0,p]),v.length){v.sort(function(t,r){return kr(zt([o,a],t))-kr(zt([o,a],r))});var g=v[0];if(g[0]&&Math.abs(o)>br)h=-g[0],d=a*Math.abs(o+h)/Math.abs(o)-a;else if(g[1]&&Math.abs(a)>br){var m=a;d=-g[1],h=o*Math.abs(a+d)/Math.abs(m)-o}if(t&&u&&s)if(Math.abs(h)>br&&Math.abs(h)<Math.abs(l))h*=b=Math.abs(l)/Math.abs(h),d*=b;else if(Math.abs(d)>br&&Math.abs(d)<Math.abs(p)){var b;h*=b=Math.abs(p)/Math.abs(d),d*=b}else h=ln(-l,h),d=ln(-p,d)}}else h=o||s?-l:0,d=a||u?-p:0;return[h,d]}(e,[r,n],[E,x],[b,y],[ln(h.offset,g.offset),ln(d.offset,m.offset)]);return[{isBound:E,isSnap:b,offset:S[0]},{isBound:x,isSnap:y,offset:S[1]}]}function ge(t){var n=[];return t.forEach(function(t){t.guidelineInfos.forEach(function(t){var r=t.guideline;-1<n.indexOf(r)||n.push(r)})}),n}function me(t,r,n,e){var i=t-n,o=i<0?i+r:e;return{size:(i<0?0:i)-o,pos:o}}function be(t,a,n,s){var u=[],r=cn(t.filter(function(t){var r=t.element,n=t.gap;return r&&!n}),function(t){var e=t.element,r=t.pos,i=r[s],n=(Math.min(0,i-a)<0?-1:1)+"_"+r[s?0:1],o=function(t,r,n){var e=v(t,r);return-1<e?t[e]:n}(u,function(t){var r=t[0],n=t[1];return e===r&&i===n});return o?o[2]:(u.push([e,i,n]),n)});return r.forEach(function(t){t.sort(function(t,r){return me(t.pos[s],t.size,a,n).size-me(r.pos[s],t.size,a,n).size||t.pos[s?0:1]-r.pos[s?0:1]})}),r}function ye(t,r,p,h,d,v,g,m,b,y,E){var x=r[0],S=r[1],M=r[2],D=r[3];return fn(t.map(function(t,f){var l=!0;return t.map(function(t,r){var n,e=t.pos,i=t.size,o=me(e[y],i,h,d),a=o.pos,s=o.size;if(s<g)return null;var u=l;l=!1;var c=m&&u?parseFloat(s.toFixed(b)):0;return E.createElement("div",{className:Mr("line",x,"guideline","dashed"),"data-size":0<c?c:"",key:x+"LinkGuidline"+f+"-"+r,style:(n={},n[S]=p+a+"px",n[M]=-v+e[y?0:1]+"px",n[D]=s+"px",n)})})}))}function Ee(t,r,e,i,o,a){var s=r[0],u=r[1],c=r[2],f=r[3];return t.map(function(t,r){var n;return a.createElement("div",{className:Mr("line",s,"guideline","target","bold"),key:s+"TargetGuidline"+r,style:(n={},n[u]=e+"px",n[c]=-i+t+"px",n[f]=o+"px",n)})})}function xe(t,r,a,s,u,c){var f=r[0],l=r[1],p=r[2],h=r[3];return t.map(function(t,r){var n,e=t.pos,i=t.size,o=t.element;return c.createElement("div",{className:Mr("line",f,"guideline",o?"bold":""),key:f+"Guidline"+r,style:(n={},n[l]=-a+e[u]+"px",n[p]=-s+e[u?0:1]+"px",n[h]=i+"px",n)})})}function Se(t,i,c,f){var r=t.filter(function(t){var r=t.element,n=t.gap,e=t.type;return r&&n&&e===i}),n="vertical"===i?[0,1]:[1,0],l=n[0],p=n[1];return fn(r.map(function(t,r){var n=t.pos,e=t.gap,i=t.gapGuidelines,o=t.sizes,a=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return t.sort(function(t,r){return Math.abs(t)-Math.abs(r)}),t[0]}(n[p]+o[p]-c[p],n[p]-c[p]-f[p]),s=Math.min(o[p],f[p]);0<a&&s<a?a=2*(a-s/2):a<0&&a<-s&&(a=2*(a+s/2));var u=(0<a?0:f[p])+a/2;return function(t,i,n,r,e,o,a){var s=Math.abs(o),u=e[i]+(0<o?r[0]:0);return t.filter(function(t){return t.pos[i]<=n[i]}).sort(function(t,r){var n=t.pos;return r.pos[i]-n[i]}).filter(function(t){var r=t.pos,n=t.sizes,e=r[i];return Jr(e+n[i],1e-4)===Jr(u-s,1e-4)&&(u=e,!0)}).map(function(t){var r=-n[i]+t.pos[i]+t.sizes[i];return fr({},t,{gap:o,renderPos:i?[a,r]:[r,a]})})}(i,l,c,f,n,e,u).concat(function(t,i,n,r,e,o,a){var s=Math.abs(o),u=e[i]+(o<0?r[i]:0);return t.filter(function(t){return t.pos[i]>n[i]}).sort(function(t,r){var n=t.pos,e=r.pos;return n[i]-e[i]}).filter(function(t){var r=t.pos,n=t.sizes,e=r[i];return Jr(e,1e-4)===Jr(u+s,1e-4)&&(u=e+n[i],!0)}).map(function(t){var r=-n[i]+t.pos[i]-s;return fr({},t,{gap:o,renderPos:i?[a,r]:[r,a]})})}(i,l,c,f,n,e,u))}))}function Me(t,r,n,e,s){var u=e[0],c=e[1],f=e[2],l=e[3],i=t.props,o=i.snapDigit,p=void 0===o?0:o,a=i.isDisplaySnapDigit,h=void 0===a||a,d="vertical"===n?"horizontal":"vertical",v="vertical"===n?[0,1]:[1,0],g=v[0],m=v[1];return r.map(function(t,r){var n,e=t.renderPos,i=t.gap,o=Math.abs(i),a=h?parseFloat(o.toFixed(p)):0;return s.createElement("div",{className:Mr("line",u,"guideline","gap"),"data-size":0<a?a:"",key:d+"GapGuideline"+r,style:(n={},n[c]=e[g]+"px",n[f]=e[m]+"px",n[l]=o+"px",n)})})}function De(t,r,n,e,i){var o=te(t,r,n),a=o.vertical,s=a.isBound,u=a.pos,c=o.horizontal,f=c.isBound,l=c.pos;s&&e.indexOf(u)<0&&e.push(u),f&&i.indexOf(l)<0&&i.push(l);var p=function(t){var r=t.props.innerBounds;if(!r)return{vertical:[],horizontal:[]};var n=t.getRect(),e=n.pos1,i=n.pos2,o=n.pos3,a=n.pos4,u=Bn([e,i,o,a],[0,0]),c=r.left,f=r.top,l=r.width,p=r.height,h=[[c,f],[c,f+p]],d=[[c,f],[c+l,f]],v=[[c+l,f],[c+l,f+p]],g=[[c,f+p],[c+l,f+p]],m=[],b=[],y={top:!1,bottom:!1,left:!1,right:!1};return[[e,i],[i,a],[a,o],[o,e]].forEach(function(t){var r=Ln(u,t),n=r.horizontal,e=r.vertical,i=Un(t,d,e,1),o=Un(t,g,e,1),a=Un(t,h,n,1),s=Un(t,v,n,1);i.isBound&&!y.top&&(m.push(f),y.top=!0),o.isBound&&!y.bottom&&(m.push(f+p),y.bottom=!0),a.isBound&&!y.left&&(b.push(c),y.left=!0),s.isBound&&!y.right&&(b.push(c+l),y.right=!0)}),{horizontal:m,vertical:b}}(t),h=p.vertical,d=p.horizontal;e.push.apply(e,h.filter(function(t){return e.indexOf(t)<0})),i.push.apply(i,d.filter(function(t){return i.indexOf(t)<0}))}var we={name:"snappable",props:{snappable:[Boolean,Array],snapCenter:Boolean,snapHorizontal:Boolean,snapVertical:Boolean,snapElement:Boolean,snapGap:Boolean,isDisplaySnapDigit:Boolean,snapDigit:Number,snapThreshold:Number,horizontalGuidelines:Array,verticalGuidelines:Array,elementGuidelines:Array,bounds:Object,innerBounds:Object},render:function(t,r){var n=t.state,e=n.top,i=n.left,o=n.pos1,a=n.pos2,s=n.pos3,u=n.pos4,c=n.snapRenderInfo,f=n.targetClientRect,l=n.containerClientRect,p=f.left-l.left-l.clientLeft,h=f.top-l.top-l.clientTop,d=Math.min(o[0],a[0],s[0],u[0]),v=Math.min(o[1],a[1],s[1],u[1]);if(!c||!oe(t,""))return[];var g=t.props,m=g.snapThreshold,b=void 0===m?5:m,y=g.snapDigit,E=void 0===y?0:y,x=g.isDisplaySnapDigit,S=void 0===x||x,M=Kr(t.state),D=Yr(M),w=D.width,C=D.height,P=D.top,O=D.left,z=D.bottom,R=D.right,B=[],_=[],G=[],T=[],A=[];if(c.direction&&A.push(function(t,r,n){var e=[];if(n[0]&&n[1])e=[n,[-n[0],n[1]],[n[0],-n[1]]].map(function(t){return Bn(r,t)});else if(n[0]||n[1])t.props.keepRatio?e=[[-1,-1],[-1,1],[1,-1],[1,1],n].map(function(t){return Bn(r,t)}):1<(e=Rn(r,n)).length&&e.push([(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2]);else for(var i=[r[0],r[1],r[3],r[2],r[0]],o=0;o<4;++o)e.push(i[o]),e.push([(i[o][0]+i[o+1][0])/2,(i[o][1]+i[o+1][1])/2]);return kn(t,e.map(function(t){return t[0]}),e.map(function(t){return t[1]}),!0,1)}(t,M,c.direction)),c.snap){var I=Yr(M);c.center&&(I.middle=(I.top+I.bottom)/2,I.center=(I.left+I.right)/2),A.push(function(t,r,n,e){var i=t.props.snapCenter&&n,o=["left","right"],a=["top","bottom"];return i&&(o.push("center"),a.push("middle")),o=o.filter(function(t){return t in r}),a=a.filter(function(t){return t in r}),kn(t,o.map(function(t){return r[t]}),a.map(function(t){return r[t]}),i,e)}(t,I,!0,1))}A.forEach(function(t){var r=t.vertical.posInfos,n=t.horizontal.posInfos;B.push.apply(B,r.map(function(t){return t.pos})),_.push.apply(_,n.map(function(t){return t.pos})),G.push.apply(G,ge(r)),T.push.apply(T,ge(n))}),De(t,[O,R],[P,z],B,_);var Y=be(T,p,w,0),X=be(G,h,C,1),N=["horizontal","left","top","width"],k=["vertical","top","left","height"],W=Se(G,"vertical",[i,e],[w,C]),H=Se(T,"horizontal",[i,e],[w,C]),j=G.concat(T);return nn(t,"onSnap",{guidelines:j.filter(function(t){return!t.element}),elements:cn(j.filter(function(t){return t.element}),function(t){return t.element}),gaps:W.concat(H)},!0),Me(t,W,"vertical",N,r).concat(Me(t,H,"horizontal",k,r),ye(Y,N,d,p,w,e,b,S,E,0,r),ye(X,k,v,h,C,i,b,S,E,1,r),Ee(_,N,d,e,w,r),Ee(B,k,v,i,C,r),xe(T,N,i,e,0,r),xe(G,k,e,i,1,r))},dragStart:function(t,r){t.state.snapRenderInfo={snap:!0,center:!0},ie(t)},pinchStart:function(t){this.unset(t)},dragEnd:function(t){this.unset(t)},dragControlCondition:function(t){return Xn(t)||Be(t)},dragControlStart:function(t,r){t.state.snapRenderInfo=null,ie(t)},dragControlEnd:function(t){this.unset(t)},dragGroupStart:function(t,r){this.dragStart(t,r)},dragGroupEnd:function(t){this.unset(t)},dragGroupControlStart:function(t,r){t.state.snapRenderInfo=null,ie(t)},dragGroupControlEnd:function(t){this.unset(t)},unset:function(t){var r=t.state;r.enableSnap=!1,r.guidelines=[],r.snapRenderInfo=null}},Ce={name:"draggable",props:{draggable:Boolean,throttleDrag:Number,throttleDragRotate:Number},render:function(t,r){var n=t.props.throttleDragRotate,e=t.state,i=e.dragInfo,o=e.beforeOrigin;if(n&&i){var a=i.dist;if(a[0]||a[1]){var s=kr(a),u=xt(a,[0,0]);return r.createElement("div",{className:Mr("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:s+"px",transform:"translate("+o[0]+"px, "+o[1]+"px) rotate("+u+"rad)"}})}}},dragStart:function(t,r){var n=r.datas,e=r.parentEvent,i=r.parentDragger,o=t.state,a=o.targetTransform,s=o.target;if(o.dragger)return!1;o.dragger=i||t.targetDragger;var u=window.getComputedStyle(s);n.datas={},n.left=parseFloat(u.left||"")||0,n.top=parseFloat(u.top||"")||0,n.bottom=parseFloat(u.bottom||"")||0,n.right=parseFloat(u.right||"")||0,n.transform=a,n.startTranslate=[0,0],Pn(t,{datas:n}),n.prevDist=[0,0],n.prevBeforeDist=[0,0],n.isDrag=!1,function(t,r){r.absolutePoses=Kr(t.state)}(t,n);var c=rn(t,r,{set:function(t){n.startTranslate=t}});return!1!==(e||nn(t,"onDragStart",c))?(n.isDrag=!0,t.state.dragInfo={startRect:t.getRect(),dist:[0,0]}):(o.dragger=null,n.isPinch=!1),!!n.isDrag&&c},drag:function(t,r){var n=r.datas,e=r.parentEvent,i=r.parentFlag,o=r.isPinch,a=r.distX,s=r.distY,u=n.isDrag,c=n.prevDist,f=n.prevBeforeDist,l=n.transform,p=n.startTranslate;if(u){var h=t.props,d=h.parentMoveable,v=e?0:h.throttleDrag||0,g=e?0:h.throttleDragRotate||0,m=!1,b=0;if(0<g&&(a||s)){var y=Jr(180*xt([0,0],[a,s])/Math.PI,g),E=kr([a,s]);b=y*Math.PI/180,a=E*Math.cos(b),s=E*Math.sin(b)}if(!o&&!e&&!i&&(a||s)){var x=ve(t,a,s,g,n),S=x[0],M=x[1],D=S.isSnap,w=S.isBound,C=S.offset,P=M.isSnap,O=M.isBound;m=D||P||w||O,a+=C,s+=M.offset}n.passDeltaX=a-(n.passDistX||0),n.passDeltaY=s-(n.passDistY||0),n.passDistX=a,n.passDistY=s;var z=Ot(On({datas:n,distX:a,distY:s},!0),p),R=Ot(On({datas:n,distX:a,distY:s},!1),p);g||m||(Zr(R,v),Zr(z,v));var B=zt(z,p),_=zt(R,p),G=zt(_,c),T=zt(B,f);n.prevDist=_,n.prevBeforeDist=B;var A=n.left+B[0],I=n.top+B[1],Y=n.right-B[0],X=n.bottom-B[1],N=l+" translate("+_[0]+"px, "+_[1]+"px)";if(t.state.dragInfo.dist=e?[0,0]:_,e||d||!G.every(function(t){return!t})||!T.some(function(t){return!t})){var k=rn(t,r,{transform:N,dist:_,delta:G,translate:R,beforeDist:B,beforeDelta:T,beforeTranslate:z,left:A,top:I,right:Y,bottom:X,isPinch:o});return e||nn(t,"onDrag",k),k}}},dragEnd:function(t,r){var n=r.parentEvent,e=r.datas,i=r.isDrag;if(t.state.dragger=null,t.state.dragInfo=null,e.isDrag)return e.isDrag=!1,n||nn(t,"onDragEnd",rn(t,r,{isDrag:i})),i},dragGroupStart:function(t,r){var n=r.datas,e=r.clientX,i=r.clientY,o=this.dragStart(t,r);if(!o)return!1;var a=wn(t,this,"dragStart",[e,i],r,!1),s=nn(t,"onDragGroupStart",fr({},o,{targets:t.props.targets,events:a}));return n.isDrag=!1!==s,!!n.isDrag&&o},dragGroup:function(t,r){if(r.datas.isDrag){var n=this.drag(t,r),e=r.datas,i=wn(t,this,"drag",[e.passDeltaX,e.passDeltaY],r,!1);if(n){var o=fr({targets:t.props.targets,events:i},n);return nn(t,"onDragGroup",o),o}}},dragGroupEnd:function(t,r){var n=r.isDrag,e=r.datas;if(e.isDrag)return this.dragEnd(t,r),e.childDraggers.forEach(function(){}),wn(t,this,"dragEnd",[0,0],r,!1),nn(t,"onDragGroupEnd",rn(t,r,{targets:t.props.targets,isDrag:n})),n},request:function(t){var r={},n=t.getRect(),e=0,i=0;return{isControl:!1,requestStart:function(t){return{datas:r}},request:function(t){return"x"in t?e=t.x-n.left:"deltaX"in t&&(e+=t.deltaX),"y"in t?i=t.y-n.top:"deltaY"in t&&(i+=t.deltaY),{datas:r,distX:e,distY:i}},requestEnd:function(){return{datas:r,isDrag:!0}}}},unset:function(t){t.state.dragInfo=null}};function Pe(t,r,n,e,i,o){var a=t.state.is3d?4:3,s=Ar(t.state.rootMatrix,i,a),u=Ot([o.left,o.top],s);r.startAbsoluteOrigin=u,r.prevDeg=xt(u,[n,e])/Math.PI*180,r.prevSnapDeg=r.prevDeg,r.startDeg=r.prevDeg,r.loop=0}function Oe(t,r,n,e,i,o){var a=n.prevDeg,s=o+e,u=de(t,r,n.origin,e);return[i*((n.prevDeg=u)-a),u,s]}function ze(t,r,n,e,i,o,a,s){var u=n.prevDeg,c=n.prevSnapDeg,f=n.startDeg,l=n.loop;e<u&&270<u&&e<90?++n.loop:u<e&&u<90&&270<e&&--n.loop;var p=n.loop,h=360*l+c-f+o,d=360*p+e-f+o;n.prevDeg=d-360*p+f-o;var v=i*((d=Jr(d,a))-o);return s&&(d=(v=de(t,r,n.origin,v))/i+o),n.prevSnapDeg=d-360*p+f-o,[i*(d-h),v,d]}function Re(t,r,n,e,i,o,a,s){return ze(t,r,n,xt(n.startAbsoluteOrigin,[i,o])/Math.PI*180,e,a,s,!0)}function Be(t){return!!t.isRequest||g(t.inputEvent.target,Mr("rotation"))}var _e={name:"rotatable",canPinch:!0,props:{rotatable:Boolean,rotationPosition:String,throttleRotate:Number},render:function(t,r){var n=t.props,e=n.rotatable,i=n.rotationPosition;if(!e)return null;var o=t.state,a=o.pos1,s=o.pos2,u=o.pos3,c=o.pos4,f=o.direction,l=function(t,r,n,e,i){return"left"===t?[e,r]:"right"===t?[n,i]:"bottom"===t?[i,e]:[r,n]}(i,a,s,u,c),p=Lr(l,f);return r.createElement("div",{key:"rotation",className:Mr("line rotation-line"),style:{transform:"translate(-50%) translate("+(l[0][0]+l[1][0])/2+"px, "+(l[0][1]+l[1][1])/2+"px) rotate("+p+"rad)"}},r.createElement("div",{className:Mr("control","rotation")}))},dragControlCondition:Be,dragControlStart:function(t,r){var n=r.datas,e=r.clientX,i=r.clientY,o=r.parentRotate,a=r.parentFlag,s=r.isPinch,u=r.isRequest,c=t.state,f=c.target,l=c.left,p=c.top,h=c.origin,d=c.beforeOrigin,v=c.direction,g=c.beforeDirection,m=c.targetTransform;if(!u&&!f)return!1;var b=t.getRect();if(n.rect=b,n.transform=m,n.left=l,n.top=p,u||s||a){var y=o||0;n.beforeInfo={origin:b.beforeOrigin,prevDeg:y,startDeg:y,prevSnapDeg:y,loop:0},n.afterInfo={origin:b.origin,prevDeg:y,startDeg:y,prevSnapDeg:y,loop:0}}else{n.beforeInfo={origin:b.beforeOrigin},n.afterInfo={origin:b.origin};var E=qr(t.controlBox.getElement());Pe(t,n.beforeInfo,e,i,d,E),Pe(t,n.afterInfo,e,i,h,E)}n.direction=v,n.beforeDirection=g,n.startRotate=0,n.datas={};var x=rn(t,r,{set:function(t){n.startRotate=t}}),S=nn(t,"onRotateStart",x);return n.isRotate=!1!==S,t.state.snapRenderInfo={},!!n.isRotate&&x},dragControl:function(t,r){var n,e,i,o,a,s,u=r.datas,c=r.clientX,f=r.clientY,l=r.parentRotate,p=r.parentFlag,h=r.isPinch,d=u.direction,v=u.beforeDirection,g=u.beforeInfo,m=u.afterInfo,b=u.isRotate,y=u.startRotate,E=u.rect;if(b){var x,S,M,D,w,C,P=t.props,O=P.throttleRotate,z=void 0===O?0:O,R=P.parentMoveable;if("parentDist"in r){var B=r.parentDist;x=(n=Oe(t,E,m,B,d,y))[0],S=n[1],M=n[2],D=(e=Oe(t,E,g,B,d,y))[0],w=e[1],C=e[2]}else C=h||p?(x=(i=ze(t,E,m,l,d,y,z))[0],S=i[1],M=i[2],D=(o=ze(t,E,g,l,d,y,z))[0],w=o[1],o[2]):(x=(a=Re(t,E,m,d,c,f,y,z))[0],S=a[1],M=a[2],D=(s=Re(t,E,g,v,c,f,y,z))[0],w=s[1],s[2]);if(x||D||R){var _=rn(t,r,{delta:x,dist:S,rotate:M,beforeDist:w,beforeDelta:D,beforeRotate:C,transform:u.transform+" rotate("+S+"deg)",isPinch:!!h});return nn(t,"onRotate",_),_}}},dragControlEnd:function(t,r){var n=r.datas,e=r.isDrag;return!!n.isRotate&&(n.isRotate=!1,nn(t,"onRotateEnd",rn(t,r,{isDrag:e})),e)},dragGroupControlCondition:Be,dragGroupControlStart:function(t,r){var n=r.datas,u=r.inputEvent,e=t.state,c=e.left,f=e.top,l=e.beforeOrigin,i=this.dragControlStart(t,r);if(!i)return!1;i.set(t.rotation);var o=Cn(t,this,"dragControlStart",n,fr({},r,{parentRotate:0}),function(t,r,n){var e=t.state,i=e.left,o=e.top,a=e.beforeOrigin,s=Ot(zt([i,o],[c,f]),zt(a,l));r.prevClient=s,n.dragStart=Ce.dragStart(t,(new Dn).dragStart(s,u))}),a=nn(t,"onRotateGroupStart",fr({},i,{targets:t.props.targets,events:o}));return n.isRotate=!1!==a,!!n.isRotate&&i},dragGroupControl:function(r,p){var h=p.inputEvent,t=p.datas;if(t.isRotate){var n=this.dragControl(r,p);if(n){var e=n.beforeDist,d=n.beforeDelta/180*Math.PI,i=Cn(r,this,"dragControl",t,fr({},p,{parentRotate:e}),function(t,r,n,e){var i=r.prevClient,o=i[0],a=i[1],s=Bt([o,a],d),u=s[0],c=s[1],f=[u-o,c-a];r.prevClient=[u,c];var l=Ce.drag(t,Mn(t.state,f,h,!!p.isPinch,!1));n.drag=l});r.rotation=n.beforeRotate;var o=fr({targets:r.props.targets,events:i,set:function(t){r.rotation=t}},n);return nn(r,"onRotateGroup",o),o}}},dragGroupControlEnd:function(t,r){var n=r.isDrag,e=r.datas;if(e.isRotate)return this.dragControlEnd(t,r),Cn(t,this,"dragControlEnd",e,r),nn(t,"onRotateGroupEnd",rn(t,r,{targets:t.props.targets,isDrag:n})),n},request:function(){var r={},n=0;return{isControl:!0,requestStart:function(t){return{datas:r}},request:function(t){return n+=t.deltaRotate,{datas:r,parentDist:n}},requestEnd:function(){return{datas:r,isDrag:!0}}}}};function Ge(t,r,e){var n=t.state,i=n.pos1,o=n.pos2,a=n.pos3,s=n.pos4,u=n.rotation,c=t.props.renderDirections,f=void 0===c?r:c,l=[i,o,a,s],p={};return f.forEach(function(t){p[t]=!0}),f.map(function(t){var r=xr[t];if(!r||!p[t])return null;var n=(Jr(u/Math.PI*180,15)+Sr[t])%180;return e.createElement("div",{className:Mr("control","direction",t),"data-rotation":n,"data-direction":t,key:"direction-"+t,style:Hr.apply(void 0,[u].concat(r.map(function(t){return l[t]})))})})}function Te(t,r){return Ge(t,["nw","ne","sw","se","n","w","s","e"],r)}function Ae(t,r){return Ge(t,["nw","ne","sw","se"],r)}var Ie={name:"resizable",ableGroup:"size",updateRect:!0,canPinch:!0,props:{resizable:Boolean,throttleResize:Number,renderDirections:Array,baseDirection:Array,keepRatio:Boolean},render:function(t,r){var n=t.props,e=n.resizable,i=n.edge;if(e)return i?Ae(t,r):Te(t,r)},dragControlCondition:Xn,dragControlStart:function(t,r){var n,e=r.inputEvent,i=r.isPinch,o=r.parentDirection,a=r.datas,s=o||(i?[0,0]:Vr(e.target)),u=t.state,c=u.target,f=u.width,l=u.height;if(!s||!c)return!1;i||Pn(t,{datas:a}),a.datas={},a.direction=s,a.startOffsetWidth=f,a.startOffsetHeight=l,a.prevWidth=0,a.prevHeight=0,n=function(t){var r=window.getComputedStyle(t);return[parseFloat(r.width),parseFloat(r.height)]}(c),a.startWidth=n[0],a.startHeight=n[1],a.transformOrigin=t.props.transformOrigin,a.startDirection=function(t,r){if(!r[0]&&!r[1])return[0,0];var n=t.props.baseDirection,e=void 0===n?[-1,-1]:n;return[r[0]?r[0]:-1*e[0],r[1]?r[1]:-1*e[1]]}(t,s),a.fixedPosition=Yn(t,a.startDirection),a.fixedOriginalPosition=Yn(t,s);var p=rn(t,r,{direction:s,set:function(t){var r=t[0],n=t[1];a.startWidth=r,a.startHeight=n},setOrigin:function(t){a.transformOrigin=t},dragStart:Ce.dragStart(t,(new Dn).dragStart([0,0],e))});return!1!==nn(t,"onResizeStart",p)&&(a.isResize=!0,t.state.snapRenderInfo={direction:s}),!!a.isResize&&p},dragControl:function(t,r){var n=r.datas,e=r.distX,i=r.distY,o=r.parentFlag,a=r.isPinch,s=r.parentDistance,u=r.parentScale,c=r.inputEvent,f=r.parentKeepRatio,l=r.dragClient,p=r.parentDist,h=n.direction,d=n.isResize,v=n.transformOrigin;if(d){var g=n.startWidth,m=n.startHeight,b=n.startOffsetWidth,y=n.startOffsetHeight,E=n.prevWidth,x=n.prevHeight,S=t.props,M=S.throttleResize,D=void 0===M?0:M,w=S.parentMoveable,C=h;h[0]||h[1]||(C=[1,1]);var P=t.props.keepRatio||f,O=C[0]||!C[1],z=O?y/b:b/y,R=P||o?h:n.startDirection,B=l,_=0,G=0;if(l||(B=!o&&a?Yn(t,[0,0]):P?n.fixedOriginalPosition:n.fixedPosition),p)_=p[0],G=p[1];else if(u)_=(u[0]-1)*b,G=(u[1]-1)*y;else if(a)s&&(G=(_=s)*y/b);else{var T=On({datas:n,distX:e,distY:i});if(_=C[0]*T[0],G=C[1]*T[1],P&&b&&y){var A=xt([0,0],T),I=xt([0,0],C),Y=xt([0,0],[b,y]),X=kr([_,G]),N=Math.cos(A-I)*X;C[0]?G=C[1]?(_=Math.cos(Y)*N,Math.sin(Y)*N):an(_=N,O,z):_=sn(G=N,O,z)}}var k=C[0]||P?Math.max(b+_,br):b,W=C[1]||P?Math.max(y+G,br):y;P&&b&&y&&(W=k*y/b);var H=[0,0];if(a||(H=function(t,n,e,i,o,r,a){if(!oe(t,"resizable"))return[0,0];var s=t.state,u=s.matrix,c=s.is3d;return he(t,function(t,r){return se(u,n+t,e+r,o,i,c)},n,e,i,o,r,a)}(t,k,W,h,n.fixedOriginalPosition,p,n)),p&&(p[0]||(H[0]=0),p[1]||(H[1]=0)),P){C[0]&&C[1]&&H[0]&&H[1]&&(Math.abs(H[0])>Math.abs(H[1])?H[1]=0:H[0]=0);var j=!H[0]&&!H[1];j&&(O?k=Jr(k,D):W=Jr(W,D)),C[0]&&!C[1]||H[0]&&!H[1]||j&&O?W=an(k+=H[0],O,z):(!C[0]&&C[1]||!H[0]&&H[1]||j&&!O)&&(k=sn(W+=H[1],O,z))}else k+=H[0],W+=H[1],H[0]||(k=Jr(k,D)),H[1]||(W=Jr(W,D));var L=[(_=(k=Math.round(k))-b)-E,(G=(W=Math.round(W))-y)-x];if(n.prevWidth=_,n.prevHeight=G,w||!L.every(function(t){return!t})){var F=In(t,k,W,R,B,v),q=rn(t,r,{width:g+_,height:m+G,offsetWidth:k,offsetHeight:W,direction:h,dist:[_,G],delta:L,isPinch:!!a,drag:Ce.drag(t,Mn(t.state,F,c,!!a,!1))});return nn(t,"onResize",q),q}}},dragControlAfter:function(t,r){var n=r.datas,e=n.isResize,i=n.startOffsetWidth,o=n.startOffsetHeight,a=n.prevWidth,s=n.prevHeight;if(e){var u=t.state,c=u.width-(i+a),f=u.height-(o+s),l=3<Math.abs(c),p=3<Math.abs(f);return l&&(n.startWidth+=c,n.startOffsetWidth+=c,n.prevWidth+=c),p&&(n.startHeight+=f,n.startOffsetHeight+=f,n.prevHeight+=f),l||p?(this.dragControl(t,r),!0):void 0}},dragControlEnd:function(t,r){var n=r.datas,e=r.isDrag;return!!n.isResize&&(n.isResize=!1,nn(t,"onResizeEnd",rn(t,r,{isDrag:e})),e)},dragGroupControlCondition:Xn,dragGroupControlStart:function(a,s){var t=s.datas,r=this.dragControlStart(a,s);if(!r)return!1;var u=r.direction,c=Yn(a,u),n=Cn(a,this,"dragControlStart",t,function(t,r){var n=Yn(t,u),e=Rt(Gt(-a.rotation/180*Math.PI,3),[n[0]-c[0],n[1]-c[1],1],3),i=e[0],o=e[1];return r.originalX=i,r.originalY=o,s}),e=fr({},r,{targets:a.props.targets,events:n}),i=nn(a,"onResizeGroupStart",e);return t.isResize=!1!==i,!!t.isResize&&r},dragGroupControl:function(o,a){var t=a.datas;if(t.isResize){var r=this.dragControl(o,a);if(r){var n=r.offsetWidth,e=r.offsetHeight,i=r.dist,s=o.props.keepRatio,u=[n/(n-i[0]),e/(e-i[1])],c=Yn(o,t.direction),f=Cn(o,this,"dragControl",t,function(t,r){var n=Rt(Gt(o.rotation/180*Math.PI,3),[r.originalX*u[0],r.originalY*u[1],1],3),e=n[0],i=n[1];return fr({},a,{parentScale:u,dragClient:Ot(c,[e,i]),parentKeepRatio:s})}),l=fr({targets:o.props.targets,events:f},r);return nn(o,"onResizeGroup",l),l}}},dragGroupControlEnd:function(t,r){var n=r.isDrag,e=r.datas;if(e.isResize)return this.dragControlEnd(t,r),Cn(t,this,"dragControlEnd",e,r),nn(t,"onResizeGroupEnd",rn(t,r,{targets:t.props.targets,isDrag:n})),n},request:function(t){var r={},n=0,e=0,i=t.getRect();return{isControl:!0,requestStart:function(t){return{datas:r,parentDirection:t.direction||[1,1]}},request:function(t){return"offsetWidth"in t?n=t.offsetWidth-i.offsetWidth:"deltaWidth"in t&&(n+=t.deltaWidth),"offsetHeight"in t?e=t.offsetHeight-i.offsetHeight:"deltaHeight"in t&&(e+=t.deltaHeight),{datas:r,parentDist:[n,e]}},requestEnd:function(){return{datas:r,isDrag:!0}}}}},Ye={name:"scalable",ableGroup:"size",canPinch:!0,props:{scalable:Boolean,throttleScale:Number,renderDirections:String,keepRatio:Boolean},render:function(t,r){var n=t.props,e=n.resizable,i=n.scalable,o=n.edge;if(!e&&i)return o?Ae(t,r):Te(t,r)},dragControlCondition:Xn,dragControlStart:function(t,r){var n=r.datas,e=r.isPinch,i=r.inputEvent,o=r.parentDirection||(e?[0,0]:Vr(i.target)),a=t.state,s=a.width,u=a.height,c=a.targetTransform,f=a.target;if(!o||!f)return!1;e||Pn(t,{datas:n}),n.datas={},n.transform=c,n.prevDist=[1,1],n.direction=o,n.width=s,n.height=u,n.startScale=[1,1],n.fixedPosition=Yn(t,o);var l=rn(t,r,{direction:o,set:function(t){n.startScale=t},dragStart:Ce.dragStart(t,(new Dn).dragStart([0,0],i))});return!1!==nn(t,"onScaleStart",l)&&(n.isScale=!0,t.state.snapRenderInfo={direction:o}),!!n.isScale&&l},dragControl:function(t,r){var n=r.datas,e=r.distX,i=r.distY,o=r.parentScale,a=r.parentDistance,s=r.parentKeepRatio,u=r.parentFlag,c=r.isPinch,f=r.inputEvent,l=r.dragClient,p=r.parentDist,h=n.prevDist,d=n.direction,v=n.width,g=n.height,m=n.transform,b=n.isScale,y=n.startScale;if(!b)return!1;var E=t.props,x=E.throttleScale,S=E.parentMoveable,M=d;d[0]||d[1]||(M=[1,1]);var D=t.props.keepRatio||s,w=t.state,C=M[0]||!M[1],P=v*y[0],O=g*y[1],z=C?O/P:P/O,R=1,B=1,_=l;if(l||(_=!u&&c?Yn(t,[0,0]):n.fixedPosition),o)R=o[0],B=o[1];else if(c)a&&(R=(v+a)/v,B=(g+a*g/v)/g);else{var G=On({datas:n,distX:e,distY:i}),T=M[0]*G[0],A=M[1]*G[1];if(D&&v&&g){var I=xt([0,0],G),Y=xt([0,0],M),X=xt([0,0],[P,O]),N=kr([T,A]),k=Math.cos(I-Y)*N;M[0]?A=M[1]?(T=Math.cos(X)*k,Math.sin(X)*k):an(T=k,C,z):T=sn(A=k,C,z)}R=(v+T)/v,B=(g+A)/g}R=M[0]||D?R*y[0]:y[0],B=M[1]||D?B*y[1]:y[1],0===R&&(R=1e-9*(0<h[0]?1:-1)),0===B&&(B=1e-9*(0<h[1]?1:-1));var W,H=[R/y[0],B/y[1]];if(!c&&t.props.groupable){var j=(w.snapRenderInfo||{}).direction;J(j)&&(j[0]||j[1])&&(w.snapRenderInfo={direction:d})}var L=[0,0];if(c||(L=function(t,n,e,i,r,o){var a=o.width,s=o.height;if(!oe(t,"scalable"))return[0,0];var u=o.is3d,c=he(t,function(t,r){return se(An(o,Ot(n,[t/a,r/s])),a,s,i,e,u)},a,s,e,i,r,o);return[c[0]/a,c[1]/s]}(t,H,d,n.fixedPosition,p,n)),D){M[0]&&M[1]&&L[0]&&L[1]&&(Math.abs(L[0])>Math.abs(L[1])?L[1]=0:L[0]=0);var F=!L[0]&&!L[1];if(F&&(C?H[0]=Jr(H[0]*y[0],x)/y[0]:H[1]=Jr(H[1]*y[1],x)/y[1]),M[0]&&!M[1]||L[0]&&!L[1]||F&&C){H[0]+=L[0];var q=an(v*H[0]*y[0],C,z);H[1]=q/g/y[1]}else if(!M[0]&&M[1]||!L[0]&&L[1]||F&&!C){H[1]+=L[1];var V=sn(g*H[1]*y[1],C,z);H[0]=V/v/y[0]}}else H[0]+=L[0],H[1]+=L[1],L[0]||(H[0]=Jr(H[0]*y[0],x)/y[0]),L[1]||(H[1]=Jr(H[1]*y[1],x)/y[1]);0===H[0]&&(H[0]=1e-9*(0<h[0]?1:-1)),0===H[1]&&(H[1]=1e-9*(0<h[1]?1:-1));var U=[H[0]/h[0],H[1]/h[1]];if(W=function(t,r){return[t[0]*r[0],t[1]*r[1]]}(H,y),n.prevDist=H,R===h[0]&&B===h[1]&&!S)return!1;var K=function(t,r,n,e){var i=t.state,o=i.is3d,a=i.left,s=i.top,u=i.width,c=i.height,f=o?4:3,l=t.props.groupable,p=l?a:0,h=l?s:0;return zt(Gn(e,An(t.state,r),u,c,f,n),[p,h])}(t,U,d,_),$=rn(t,r,{scale:W,direction:d,dist:H,delta:U,transform:m+" scale("+R+", "+B+")",isPinch:!!c,drag:Ce.drag(t,Mn(t.state,K,f,c,!1))});return nn(t,"onScale",$),$},dragControlEnd:function(t,r){var n=r.datas,e=r.isDrag;return!!n.isScale&&(n.isScale=!1,nn(t,"onScaleEnd",rn(t,r,{isDrag:e})),e)},dragGroupControlCondition:Xn,dragGroupControlStart:function(a,s){var t=s.datas,r=this.dragControlStart(a,s);if(!r)return!1;var u=r.direction,c=Yn(a,u),n=Cn(a,this,"dragControlStart",t,function(t,r){var n=Yn(t,u),e=Rt(Gt(-a.rotation/180*Math.PI,3),[n[0]-c[0],n[1]-c[1],1],3),i=e[0],o=e[1];return r.originalX=i,r.originalY=o,s}),e=fr({},r,{targets:a.props.targets,events:n}),i=nn(a,"onScaleGroupStart",e);return t.isScale=!1!==i,!!t.isScale&&e},dragGroupControl:function(o,a){var t=a.datas;if(t.isScale){var r=this.dragControl(o,a);if(r){var s=o.props.keepRatio,u=r.scale,c=Yn(o,t.direction),n=Cn(o,this,"dragControl",t,function(t,r){var n=Rt(Gt(o.rotation/180*Math.PI,3),[r.originalX*u[0],r.originalY*u[1],1],3),e=n[0],i=n[1];return fr({},a,{parentScale:u,parentKeepRatio:s,dragClient:Ot(c,[e,i])})}),e=fr({targets:o.props.targets,events:n},r);return nn(o,"onScaleGroup",e),e}}},dragGroupControlEnd:function(t,r){var n=r.isDrag,e=r.datas;if(e.isScale)return this.dragControlEnd(t,r),Cn(t,this,"dragControlEnd",e,r),nn(t,"onScaleGroupEnd",rn(t,r,{targets:t.props.targets,isDrag:n})),n},request:function(){var r={},n=0,e=0;return{isControl:!0,requestStart:function(t){return{datas:r,parentDirection:t.direction||[1,1]}},request:function(t){return n+=t.deltaWidth,e+=t.deltaHeight,{datas:r,parentDist:[n,e]}},requestEnd:function(){return{datas:r,isDrag:!0}}}}};function Xe(t,n){return t.map(function(t,r){return function(t,r,n,e){return(t*e+r*n)/(n+e)}(t,n[r],1,2)})}function Ne(t,r,n){var e=xt(t,r),i=xt(t,n)-e;return 0<=i?i:i+2*Math.PI}var ke={name:"warpable",ableGroup:"size",props:{warpable:Boolean,renderDirections:Array},render:function(t,r){var n=t.props,e=n.resizable,i=n.scalable,o=n.warpable;if(!e&&!i&&o){var a=t.state,s=a.pos1,u=a.pos2,c=a.pos3,f=a.pos4,l=Xe(s,u),p=Xe(u,s),h=Xe(s,c),d=Xe(c,s),v=Xe(c,f),g=Xe(f,c),m=Xe(u,f),b=Xe(f,u);return[r.createElement("div",{className:Mr("line"),key:"middeLine1",style:Wr(l,v)}),r.createElement("div",{className:Mr("line"),key:"middeLine2",style:Wr(p,g)}),r.createElement("div",{className:Mr("line"),key:"middeLine3",style:Wr(h,m)}),r.createElement("div",{className:Mr("line"),key:"middeLine4",style:Wr(d,b)})].concat(Te(t,r))}},dragControlCondition:function(t){return!t.isRequest&&g(t.inputEvent.target,Mr("direction"))},dragControlStart:function(t,r){var e=r.datas,n=r.inputEvent,i=t.props.target,o=Vr(n.target);if(!o||!i)return!1;var a=t.state,s=a.transformOrigin,u=a.is3d,c=a.targetTransform,f=a.targetMatrix,l=a.width,p=a.height,h=a.left,d=a.top;return e.datas={},e.targetTransform=c,e.warpTargetMatrix=u?f:Mt(f,3,4),e.targetInverseMatrix=bt(yt(e.warpTargetMatrix,4),3,4),e.direction=o,e.left=h,e.top=d,Pn(t,{datas:e}),e.poses=[[0,0],[l,0],[0,p],[l,p]].map(function(t,r){return zt(t,s)}),e.nextPoses=e.poses.map(function(t){var r=t[0],n=t[1];return Rt(e.warpTargetMatrix,[r,n,0,1],4)}),e.startMatrix=Tt(4),e.prevMatrix=Tt(4),e.absolutePoses=Kr(a),e.posIndexes=zn(o),!(a.snapRenderInfo={direction:o})!==nn(t,"onWarpStart",rn(t,r,{set:function(t){e.startMatrix=t}}))&&(e.isWarp=!0),e.isWarp},dragControl:function(t,r){var n=r.datas,e=r.distX,i=r.distY,o=n.targetInverseMatrix,a=n.prevMatrix,s=n.isWarp,u=n.startMatrix,c=n.poses,f=n.posIndexes,l=n.absolutePoses;if(!s)return!1;if(oe(t,"warpable")){var p=f.map(function(t){return l[t]});1<p.length&&p.push([(p[0][0]+p[1][0])/2,(p[0][1]+p[1][1])/2]);var h=le(t,p.map(function(t){return[t[0]+e,t[1]+i]})),d=h.horizontal,v=h.vertical;i-=d.offset,e-=v.offset}var g=On({datas:n,distX:e,distY:i},!0),m=n.nextPoses.slice();if(f.forEach(function(t){m[t]=Ot(m[t],g)}),!mr.every(function(t){return function(t,r){var n=Ne(t[0],t[1],t[2]),e=Ne(r[0],r[1],r[2]),i=Math.PI;return!(i<=n&&e<=i||n<=i&&i<=e)}(t.map(function(t){return c[t]}),t.map(function(t){return m[t]}))}))return!1;var b=Yt(c[0],c[1],c[2],c[3],m[0],m[1],m[2],m[3]);if(!b.length)return!1;var y=_t(wt(o,b,4)),E=n.targetTransform+" matrix3d("+y.join(",")+")";return nn(t,"onWarp",rn(t,r,{delta:Ct(yt(a,4),y,4),matrix:Ct(u,n.prevMatrix=y,4),multiply:Ct,dist:y,transform:E})),!0},dragControlEnd:function(t,r){var n=r.datas,e=r.isDrag;return!!n.isWarp&&(n.isWarp=!1,nn(t,"onWarpEnd",rn(t,r,{isDrag:e})),e)}},We=Mr("area"),He=Mr("area-pieces"),je=Mr("area-piece"),Le=Mr("avoid");function Fe(t){var r=t.areaElement,n=t.state,e=n.width,i=n.height;!function(t,r){if(t.classList)t.classList.remove(r);else{var n=new RegExp("(\\s|^)"+r+"(\\s|$)");t.className=t.className.replace(n," ")}}(r,Le),r.style.cssText+="left: 0px; top: 0px; width: "+e+"px; height: "+i+"px"}function qe(t){return t.createElement("div",{key:"area_pieces",className:He},t.createElement("div",{className:je}),t.createElement("div",{className:je}),t.createElement("div",{className:je}),t.createElement("div",{className:je}))}var Ve={name:"dragArea",props:{dragArea:Boolean},render:function(t,r){var n=t.props,e=n.target,i=n.dragArea,o=n.groupable,a=t.state,s=a.width,u=a.height,c=a.pos1,f=a.pos2,l=a.pos3,p=a.pos4;if(o)return[r.createElement("div",{key:"area",ref:tt(t,"areaElement"),className:We}),qe(r)];if(!e||!i)return[];var h=Yt([0,0],[s,0],[0,u],[s,u],c,f,l,p),d=h.length?"matrix3d("+_t(h).join(",")+")":"none";return[r.createElement("div",{key:"area",ref:tt(t,"areaElement"),className:We,style:{top:"0px",left:"0px",width:s+"px",height:u+"px",transformOrigin:"0 0",transform:d}}),qe(r)]},dragStart:function(t,r){var n=r.datas,e=r.clientX,i=r.clientY,o=r.inputEvent;if(!o)return!1;n.isDragArea=!1,n.inputTarget=o.target;var a=t.areaElement,s=t.state,u=s.targetClientRect,c=s.pos1,f=s.pos2,l=s.pos3,p=s.pos4,h=s.width,d=s.height,v=s.rootMatrix,g=s.is3d,m=u.left,b=u.top,y=Yr([c,f,l,p]),E=y.left,x=y.top,S=g?4:3,M=Ir(v,h,d,S),D=Yr(M),w=zt([e,i],Ot([m-D.left,b-D.top],M[0])),C=Rt(yt(v,S),St(w,S),S),P=C[0],O=C[1],z=[{left:E,top:x,width:h,height:O-10},{left:E,top:x,width:P-10,height:d},{left:E,top:x+O+10,width:h,height:d-O-10},{left:E+P+10,top:x,width:h-P-10,height:d}],R=[].slice.call(a.nextElementSibling.children);z.forEach(function(t,r){R[r].style.cssText="left: "+t.left+"px;top: "+t.top+"px; width: "+t.width+"px; height: "+t.height+"px;"}),function(t,r){t.classList?t.classList.add(r):t.className+=" "+r}(a,Le)},drag:function(t,r){var n=r.datas;if(!r.inputEvent)return!1;n.isDragArea||(n.isDragArea=!0,Fe(t))},dragEnd:function(t,r){if(!r.inputEvent)return!1;var n=r.inputEvent,e=r.isDragArea;r.datas.isDragArea||Fe(t);var i=t.state.target,o=n.target;if(!e&&!t.isMoveableElement(o)){var a=i.contains(o);nn(t,"onClick",rn(t,r,{inputTarget:o,isTarget:i===o,containsTarget:a}))}},dragGroupStart:function(t,r){return this.dragStart(t,r)},dragGroup:function(t,r){return this.drag(t,r)},dragGroupEnd:function(t,r){var n=r.inputEvent,e=r.isDragArea,i=r.datas;if(!n)return!1;e||Fe(t);var o=i.inputTarget,a=n.target;if(!e&&!t.isMoveableElement(a)&&o!==a){var s=t.props.targets,u=s.indexOf(a),c=-1<u,f=!1;-1===u&&(f=-1<(u=v(s,function(t){return t.contains(a)}))),nn(t,"onClickGroup",rn(t,r,{targets:s,inputTarget:a,targetIndex:u,isTarget:c,containsTarget:f}))}}},Ue={name:"origin",props:{origin:Boolean},render:function(t,r){if(!t.props.origin)return null;var n=t.state,e=n.beforeOrigin,i=n.rotation;return[r.createElement("div",{className:Mr("control","origin"),style:Hr(i,e),key:"beforeOrigin"})]}};function Ke(t){var r=t.scrollContainer;return[r.scrollLeft,r.scrollTop]}var $e={name:"scrollable",canPinch:!0,props:{scrollable:Boolean,scrollContainer:Object,scrollThreshold:Number},dragStart:function(o,a){var t=o.props.scrollContainer,r=void 0===t?o.getContainer():t,n=new er;a.datas.dragScroll=n;var e=a.isControl?"controlDragger":"targetDragger",s=a.targets;n.on("scroll",function(t){var r=t.container,n=t.direction,e=rn(o,a,{scrollContainer:r,direction:n}),i=s?"onScrollGroup":"onScroll";s&&(e.targets=s),nn(o,i,e)}).on("move",function(t){var r=t.offsetX,n=t.offsetY;o[e].scrollBy(r,n,a.inputEvent,!1)}),n.dragStart(a,{container:r})},checkScroll:function(t,r){var n=r.datas.dragScroll;if(n){var e=t.props,i=e.scrollContainer,o=void 0===i?t.getContainer():i,a=e.scrollThreshold,s=void 0===a?0:a,u=e.getScrollPosition,c=void 0===u?Ke:u;return n.drag(r,{container:o,threshold:s,getScrollPosition:function(t){return c({scrollContainer:t.container,direction:t.direction})}}),!0}},drag:function(t,r){return this.checkScroll(t,r)},dragEnd:function(t,r){r.datas.dragScroll.dragEnd(),r.datas.dragScroll=null},dragControlStart:function(t,r){return this.dragStart(t,fr({},r,{isControl:!0}))},dragControl:function(t,r){return this.drag(t,r)},dragControlEnd:function(t,r){return this.dragEnd(t,r)},dragGroupStart:function(t,r){return this.dragStart(t,fr({},r,{targets:t.props.targets}))},dragGroup:function(t,r){return this.drag(t,fr({},r,{targets:t.props.targets}))},dragGroupEnd:function(t,r){return this.dragEnd(t,fr({},r,{targets:t.props.targets}))},dragGroupControlStart:function(t,r){return this.dragStart(t,fr({},r,{targets:t.props.targets,isControl:!0}))},dragGroupContro:function(t,r){return this.drag(t,fr({},r,{targets:t.props.targets}))},dragGroupControEnd:function(t,r){return this.dragEnd(t,fr({},r,{targets:t.props.targets}))}},Je=[{name:"",props:{target:Object,container:Object,dragArea:Boolean,origin:Boolean,transformOrigin:Array,edge:Boolean,ables:Array,className:String,pinchThreshold:Number}},we,Sn,Ce,_e,Ie,Ye,ke,$e,Ve,Ue],Ze={name:"groupable",props:{defaultGroupRotate:Number,groupable:Boolean},render:function(n,e){var t=n.props.targets||[];n.moveables=[];var r=n.state,i={left:r.left,top:r.top};return t.map(function(t,r){return e.createElement(En,{key:"moveable"+r,ref:function(r,n,e){return function(t){t&&(r[n][e]=t)}}(n,"moveables",r),target:t,origin:!1,parentMoveable:n,parentPosition:i})})}};function Qe(t,o){return Math.max.apply(Math,t.map(function(t){var r=t[0],n=t[1],e=t[2],i=t[3];return Math.max(r[o],n[o],e[o],i[o])}))}function ti(t,o){return Math.min.apply(Math,t.map(function(t){var r=t[0],n=t[1],e=t[2],i=t[3];return Math.min(r[o],n[o],e[o],i[o])}))}var ri=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.differ=new sr,t.moveables=[],t.rotation=0,t}cr(t,n);var r=t.prototype;return r.updateEvent=function(t){var r=this.state,n=this.props;r.target||(r.target=this.areaElement,this.controlBox.getElement().style.display="block",this.targetDragger=dn(this,"targetAbles","Group"),this.controlDragger=vn(this,this.controlBox.getElement(),"controlAbles","GroupControl"));var e=!un(t.container,n.container);e&&(r.container=n.container);var i=this.differ.update(n.targets),o=i.added,a=i.changed,s=i.removed;(e||o.length||a.length||s.length)&&this.updateRect()},r.checkUpdate=function(){this.updateAbles()},r.updateRect=function(r,t,n){var e;if(void 0===n&&(n=!0),this.controlBox){this.moveables.forEach(function(t){t.updateRect(r,!1,!1)});var i=this.state,o=this.props,a=i.target||o.target;(!t||""!==r&&o.updateGroup)&&(this.rotation=o.defaultGroupRotate);var s=this.rotation,u=function(t,r){if(!t.length)return[0,0,0,0];var n=t.map(function(t){return Kr(t.state)}),i=yr,o=yr,e=0,a=0,s=Jr(r,br);if(s%90){var u=r/180*Math.PI,c=Math.tan(u),f=-1/c,l=[Er,yr],p=[Er,yr];n.forEach(function(t){t.forEach(function(t){var r=t[1]-c*t[0],n=t[1]-f*t[0];l[0]=Math.max(l[0],r),l[1]=Math.min(l[1],r),p[0]=Math.max(p[0],n),p[1]=Math.min(p[1],n)})}),l.forEach(function(e){p.forEach(function(t){var r=(t-e)/(c-f),n=c*r+e;i=Math.min(i,r),o=Math.min(o,n)})});var h=n.map(function(t){var r=t[0],n=t[1],e=t[2],i=t[3];return[Bt(r,-u),Bt(n,-u),Bt(e,-u),Bt(i,-u)]});e=Qe(h,0)-ti(h,0),a=Qe(h,1)-ti(h,1)}else if(i=ti(n,0),o=ti(n,1),e=Qe(n,0)-i,a=Qe(n,1)-o,s%180){var d=e;e=a,a=d}return[i,o,e,a]}(this.moveables,s),c=u[0],f=u[1],l=u[2],p=u[3];a.style.cssText+="left:0px;top:0px;width:"+l+"px; height:"+p+"px;transform:rotate("+s+"deg)",i.width=l,i.height=p;var h=this.getContainer(),d=Fr(a,this.controlBox.getElement(),this.getContainer(),this.props.rootContainer||h,i),v=[d.left,d.top];e=Kr(d),d.pos1=e[0],d.pos2=e[1],d.pos3=e[2],d.pos4=e[3],d.origin=Ot(v,d.origin),d.beforeOrigin=Ot(v,d.beforeOrigin);var g=d.targetClientRect;g.top+=f-d.top-i.top,g.left+=c-d.left-i.left,this.updateState(fr({},d,{left:c-d.left,top:f-d.top}),n)}},r.triggerEvent=function(t,r){if(-1<t.indexOf("Group"))return n.prototype.triggerEvent.call(this,t,r)},r.updateAbles=function(){n.prototype.updateAbles.call(this,this.props.ables.concat([Ze]),"Group")},t.defaultProps=fr({},En.defaultProps,{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0}),t}(En),ni=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}cr(r,t);var n=r.prototype;return n.render=function(){var t=this.props.ables||[],r=this.props.target||this.props.targets,n=J(r);if(n&&1<r.length){var e=fr({},this.props,{target:null,targets:r,ables:Je.concat([Ze],t)});return I(ri,fr({key:"group",ref:tt(this,"moveable")},e))}var i=n?r[0]:r;return I(En,fr({key:"single",ref:tt(this,"moveable")},fr({},this.props,{target:i,ables:Je.concat(t)})))},n.isMoveableElement=function(t){return this.moveable.isMoveableElement(t)},n.dragStart=function(t){this.moveable.dragStart(t)},n.isInside=function(t,r){return this.moveable.isInside(t,r)},n.updateRect=function(){this.moveable.updateRect()},n.updateTarget=function(){this.moveable.updateTarget()},n.isDragging=function(){return this.moveable.isDragging()},n.getRect=function(){return this.moveable.getRect()},n.request=function(t,r){return this.moveable.request(t,r)},n.destroy=function(){this.moveable.componentWillUnmount()},r}(V),ei=function(n){function t(t){var r=n.call(this,t)||this;return r.state={},r.state=r.props,r}return i(t,n),t.prototype.render=function(){return function(t,r){return I(U,{element:t,container:r})}(I(ni,s({ref:c(this,"moveable")},this.state)),this.state.parentElement)},t}(q),ii=["draggable","resizable","scalable","rotatable","warpable","pinchable","snappable","origin","target","edge","throttleDrag","throttleDragRotate","throttleResize","throttleScale","throttleRotate","keepRatio","dragArea","pinchThreshold","snapCenter","snapThreshold","horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","className","renderDirections","scrollable","getScrollPosition","scrollContainer","scrollThreshold","baseDirection","snapElement","snapVertical","snapHorizontal","snapGap","isDisplaySnapDigit","snapDigit","zoom","triggerAblesSimultaneously"],oi=["dragStart","drag","dragEnd","resizeStart","resize","resizeEnd","scaleStart","scale","scaleEnd","rotateStart","rotate","rotateEnd","warpStart","warp","warpEnd","pinchStart","pinch","pinchEnd","dragGroupStart","dragGroup","dragGroupEnd","resizeGroupStart","resizeGroup","resizeGroupEnd","scaleGroupStart","scaleGroup","scaleGroupEnd","rotateGroupStart","rotateGroup","rotateGroupEnd","pinchGroupStart","pinchGroup","pinchGroupEnd","clickGroup","scroll","scrollGroup","renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd","snap"],ai=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","setState","getRect","request","isDragging"],si=function(a){function t(t,r){void 0===r&&(r={});var n=a.call(this)||this;n.tempElement=document.createElement("div");var e=s({container:t},r),i={};oi.forEach(function(r){i[function(t){return t.replace(/[\s-_]([a-z])/g,function(t,r){return r.toUpperCase()})}("on "+r)]=function(t){return n.trigger(r,t)}}),Q(I(ei,s({ref:c(n,"innerMoveable"),parentElement:t},e,i)),n.tempElement);var o=e.target;return J(o)&&1<o.length&&n.updateRect(),n}i(t,a);var r=t.prototype;return r.setState=function(t,r){this.innerMoveable.setState(t,r)},r.destroy=function(){Q(null,this.tempElement),this.off(),this.tempElement=null,this.innerMoveable=null},r.getMoveable=function(){return this.innerMoveable.moveable},t=function(t,r,n,e){var i,o=arguments.length,a=o<3?r:null===e?e=Object.getOwnPropertyDescriptor(r,n):e;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,r,n,e);else for(var s=t.length-1;0<=s;s--)(i=t[s])&&(a=(o<3?i(a):3<o?i(r,n,a):i(r,n))||a);return 3<o&&a&&Object.defineProperty(r,n,a),a}([n(ai,function(t,e){t[e]||(t[e]=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=this.getMoveable();if(n&&n[e])return n[e].apply(n,t)})}),n(ii,function(t,n){Object.defineProperty(t,n,{get:function(){return this.getMoveable().props[n]},set:function(t){var r;this.setState(((r={})[n]=t,r))},enumerable:!0,configurable:!0})})],t)}(t),ui={__proto__:null,default:si,PROPERTIES:ii,EVENTS:oi,METHODS:ai};for(var ci in ui)si[ci]=ui[ci];return si});
//# sourceMappingURL=moveable.min.js.map
